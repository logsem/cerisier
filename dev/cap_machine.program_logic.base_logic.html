<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.program_logic.base_logic</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">machine_utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="machine_utils.solve_finz.html#"><span class="id" title="library">solve_finz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span> <span class="id" title="library">classes</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">gmap</span> <span class="id" title="library">excl</span> <span class="id" title="library">agree</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">excl_auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#"><span class="id" title="library">logical_mapsto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.utils.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.utils.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>
<span class="comment">(*&nbsp;From&nbsp;cap_machine&nbsp;Require&nbsp;Export&nbsp;cap_lang&nbsp;iris_extra&nbsp;stdpp_extra&nbsp;machine_parameters.&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="Cerisier_resources" class="idref" href="#Cerisier_resources"><span class="id" title="section">Cerisier_resources</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{ <a id="reservedaddresses:1" class="idref" href="#reservedaddresses:1"><span class="id" title="binder">reservedaddresses</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#ReservedAddresses"><span class="id" title="class">ReservedAddresses</span></a>}.<br/>
</div>

<div class="doc">
Instantiation of the program logic 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclaves_agreeUR" class="idref" href="#enclaves_agreeUR"><span class="id" title="definition">enclaves_agreeUR</span></a> := <span class="id" title="definition">authR</span> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> (<span class="id" title="definition">agreeR</span> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>)).<br/>
<span class="id" title="keyword">Definition</span> <a id="c0302a7f27629cbbaafd58b2490e300d" class="idref" href="#c0302a7f27629cbbaafd58b2490e300d"><span class="id" title="definition">EnclavesAgreePreΣ</span></a> := <span class="id" title="notation">#[</span> <span class="id" title="constructor">GFunctor</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_agreeUR"><span class="id" title="definition">enclaves_agreeUR</span></a><span class="id" title="notation">]</span>.<br/>
<span class="id" title="keyword">Class</span> <a id="EnclavesAgreePreG" class="idref" href="#EnclavesAgreePreG"><span class="id" title="record">EnclavesAgreePreG</span></a> <a id="ebf069dbc779b42a15c441a6d39d5f83" class="idref" href="#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="binder">Σ</span></a> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="EnclavesAgreePre" class="idref" href="#EnclavesAgreePre"><span class="id" title="projection">EnclavesAgreePre</span></a> ::  <span class="id" title="class">inG</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#ebf069dbc779b42a15c441a6d39d5f83"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_agreeUR"><span class="id" title="definition">enclaves_agreeUR</span></a>;<br/>
}.<br/>
<span class="id" title="keyword">Global Instance</span> <a id="34f991d6a64a289ea0a22846f8e4ad8d" class="idref" href="#34f991d6a64a289ea0a22846f8e4ad8d"><span class="id" title="instance">subG_EnclavesAgreePreΣ</span></a> {<a id="48bbc240c70629f9166b6605559525f0" class="idref" href="#48bbc240c70629f9166b6605559525f0"><span class="id" title="binder">Σ</span></a>}:<br/>
&nbsp;&nbsp;<span class="id" title="class">subG</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c0302a7f27629cbbaafd58b2490e300d"><span class="id" title="definition">EnclavesAgreePreΣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#48bbc240c70629f9166b6605559525f0"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesAgreePreG"><span class="id" title="class">EnclavesAgreePreG</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#48bbc240c70629f9166b6605559525f0"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">solve_inG</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclaves_exclUR" class="idref" href="#enclaves_exclUR"><span class="id" title="definition">enclaves_exclUR</span></a> := <span class="id" title="definition">authUR</span> (<span class="id" title="definition">gmapUR</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> (<span class="id" title="definition">exclR</span> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>)).<br/>
<span class="id" title="keyword">Definition</span> <a id="c817b91ba63f1f2964048a6ead67ec3b" class="idref" href="#c817b91ba63f1f2964048a6ead67ec3b"><span class="id" title="definition">EnclavesExclPreΣ</span></a> := <span class="id" title="notation">#[</span> <span class="id" title="constructor">GFunctor</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_exclUR"><span class="id" title="definition">enclaves_exclUR</span></a><span class="id" title="notation">]</span>.<br/>
<span class="id" title="keyword">Class</span> <a id="EnclavesExclPreG" class="idref" href="#EnclavesExclPreG"><span class="id" title="record">EnclavesExclPreG</span></a> <a id="f525610baade8c1419220d275a93fff0" class="idref" href="#f525610baade8c1419220d275a93fff0"><span class="id" title="binder">Σ</span></a> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="EnclavesExclPre" class="idref" href="#EnclavesExclPre"><span class="id" title="projection">EnclavesExclPre</span></a> ::  <span class="id" title="class">inG</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#f525610baade8c1419220d275a93fff0"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_exclUR"><span class="id" title="definition">enclaves_exclUR</span></a>;<br/>
}.<br/>
<span class="id" title="keyword">Global Instance</span> <a id="aa01d8f84cd862aeca97cf42b6ca833d" class="idref" href="#aa01d8f84cd862aeca97cf42b6ca833d"><span class="id" title="instance">subG_EnclavesExclPreΣ</span></a> {<a id="2ff76d4cddec082cd899c55bae9fabf3" class="idref" href="#2ff76d4cddec082cd899c55bae9fabf3"><span class="id" title="binder">Σ</span></a>}:<br/>
&nbsp;&nbsp;<span class="id" title="class">subG</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c817b91ba63f1f2964048a6ead67ec3b"><span class="id" title="definition">EnclavesExclPreΣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2ff76d4cddec082cd899c55bae9fabf3"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesExclPreG"><span class="id" title="class">EnclavesExclPreG</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2ff76d4cddec082cd899c55bae9fabf3"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">solve_inG</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="ECUR" class="idref" href="#ECUR"><span class="id" title="definition">ECUR</span></a> := <span class="id" title="definition">excl_authUR</span> <a class="idref" href="cap_machine.opsem.machine_base.html#ENum"><span class="id" title="definition">ENum</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a id="80aa3c97c2dee6d89b8e72aa42f3aa3b" class="idref" href="#80aa3c97c2dee6d89b8e72aa42f3aa3b"><span class="id" title="definition">ECPreΣ</span></a> := <span class="id" title="notation">#[</span> <span class="id" title="constructor">GFunctor</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#ECUR"><span class="id" title="definition">ECUR</span></a><span class="id" title="notation">]</span>.<br/>
<span class="id" title="keyword">Class</span> <a id="ECPreG" class="idref" href="#ECPreG"><span class="id" title="record">ECPreG</span></a> <a id="2ab75602e9b8af2ca6fd6dbdb1e68a19" class="idref" href="#2ab75602e9b8af2ca6fd6dbdb1e68a19"><span class="id" title="binder">Σ</span></a> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="ECPre" class="idref" href="#ECPre"><span class="id" title="projection">ECPre</span></a> ::  <span class="id" title="class">inG</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2ab75602e9b8af2ca6fd6dbdb1e68a19"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#ECUR"><span class="id" title="definition">ECUR</span></a>;<br/>
}.<br/>
<span class="id" title="keyword">Global Instance</span> <a id="150ab08623d27fac2ea2b7cff507c380" class="idref" href="#150ab08623d27fac2ea2b7cff507c380"><span class="id" title="instance">subG_ECPreΣ</span></a> {<a id="475f6c17bae93ed6b0d4829862030679" class="idref" href="#475f6c17bae93ed6b0d4829862030679"><span class="id" title="binder">Σ</span></a>}:<br/>
&nbsp;&nbsp;<span class="id" title="class">subG</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#80aa3c97c2dee6d89b8e72aa42f3aa3b"><span class="id" title="definition">ECPreΣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#475f6c17bae93ed6b0d4829862030679"><span class="id" title="variable">Σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#ECPreG"><span class="id" title="class">ECPreG</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#475f6c17bae93ed6b0d4829862030679"><span class="id" title="variable">Σ</span></a>.<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="var">solve_inG</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="comment">(*&nbsp;CMRΑ&nbsp;for&nbsp;Cerise&nbsp;*)</span><br/>
<span class="id" title="keyword">Class</span> <a id="ceriseG" class="idref" href="#ceriseG"><span class="id" title="record">ceriseG</span></a> <a id="08441172cd4c14450ee9e66c55932a87" class="idref" href="#08441172cd4c14450ee9e66c55932a87"><span class="id" title="binder">Σ</span></a> := <span class="id" title="var">CeriseG</span> {<br/>
&nbsp;&nbsp;<a id="cerise_invG" class="idref" href="#cerise_invG"><span class="id" title="projection">cerise_invG</span></a> : <span class="id" title="abbreviation">invGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Heap&nbsp;for&nbsp;memory&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="mem_gen_memG" class="idref" href="#mem_gen_memG"><span class="id" title="projection">mem_gen_memG</span></a> :: <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Heap&nbsp;for&nbsp;registers&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="reg_gen_regG" class="idref" href="#reg_gen_regG"><span class="id" title="projection">reg_gen_regG</span></a> :: <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="enclaves_agree" class="idref" href="#enclaves_agree"><span class="id" title="projection">enclaves_agree</span></a> :: <a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesAgreePreG"><span class="id" title="class">EnclavesAgreePreG</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="enclaves_excl" class="idref" href="#enclaves_excl"><span class="id" title="projection">enclaves_excl</span></a> :: <a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesExclPreG"><span class="id" title="class">EnclavesExclPreG</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;ghost&nbsp;resource&nbsp;of&nbsp;deinitialised&nbsp;enclaves&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="enclaves_name_prev" class="idref" href="#enclaves_name_prev"><span class="id" title="projection">enclaves_name_prev</span></a> : <span class="id" title="definition">gname</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;The&nbsp;ghost&nbsp;resource&nbsp;of&nbsp;all&nbsp;enclaves&nbsp;that&nbsp;have&nbsp;ever&nbsp;existed&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="enclaves_name_all" class="idref" href="#enclaves_name_all"><span class="id" title="projection">enclaves_name_all</span></a> : <span class="id" title="definition">gname</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;ghost&nbsp;names&nbsp;for&nbsp;the&nbsp;resources&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="enclaves_name_cur" class="idref" href="#enclaves_name_cur"><span class="id" title="projection">enclaves_name_cur</span></a> : <span class="id" title="definition">gname</span>;<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Heap&nbsp;for&nbsp;EC&nbsp;register&nbsp;*)</span><br/>
&nbsp;&nbsp;<a id="EC_G" class="idref" href="#EC_G"><span class="id" title="projection">EC_G</span></a> :: <a class="idref" href="cap_machine.program_logic.base_logic.html#ECPreG"><span class="id" title="class">ECPreG</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#08441172cd4c14450ee9e66c55932a87"><span class="id" title="variable">Σ</span></a>;<br/>
&nbsp;&nbsp;<a id="EC_name" class="idref" href="#EC_name"><span class="id" title="projection">EC_name</span></a> : <span class="id" title="definition">gname</span>;<br/>
}.<br/>

<br/>
&nbsp;<span class="comment">(*&nbsp;Assertions&nbsp;over&nbsp;enclaves&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclaves_cur" class="idref" href="#enclaves_cur"><span class="id" title="definition">enclaves_cur</span></a> (<a id="tbl:26" class="idref" href="#tbl:26"><span class="id" title="binder">tbl</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) `{<a id="H:28" class="idref" href="#H:28"><span class="id" title="binder">ceriseG</span></a> <a id="2ce23d418d95c371330ae00e4301f160" class="idref" href="#2ce23d418d95c371330ae00e4301f160"><span class="id" title="binder"><span id="H:28" class="id">Σ</span></span></a>} :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := (@<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesExclPre"><span class="id" title="method">EnclavesExclPre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2ce23d418d95c371330ae00e4301f160"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_excl"><span class="id" title="method">enclaves_excl</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_name_cur"><span class="id" title="method">enclaves_name_cur</span></a> (<span class="id" title="notation">●</span> <span class="id" title="notation">(</span><span class="id" title="constructor">Excl</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tbl:26"><span class="id" title="variable">tbl</span></a><span class="id" title="notation">)</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclaves_prev" class="idref" href="#enclaves_prev"><span class="id" title="definition">enclaves_prev</span></a> (<a id="tbl:29" class="idref" href="#tbl:29"><span class="id" title="binder">tbl</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) `{<a id="H:31" class="idref" href="#H:31"><span class="id" title="binder">ceriseG</span></a> <a id="837da4610b9e0a7574f49c54d2569297" class="idref" href="#837da4610b9e0a7574f49c54d2569297"><span class="id" title="binder"><span id="H:31" class="id">Σ</span></span></a>} :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := (@<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesAgreePre"><span class="id" title="method">EnclavesAgreePre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#837da4610b9e0a7574f49c54d2569297"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_agree"><span class="id" title="method">enclaves_agree</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_name_prev"><span class="id" title="method">enclaves_name_prev</span></a> (<span class="id" title="notation">●</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tbl:29"><span class="id" title="variable">tbl</span></a><span class="id" title="notation">)</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclaves_all" class="idref" href="#enclaves_all"><span class="id" title="definition">enclaves_all</span></a> (<a id="tbl:32" class="idref" href="#tbl:32"><span class="id" title="binder">tbl</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) `{<a id="H:34" class="idref" href="#H:34"><span class="id" title="binder">ceriseG</span></a> <a id="4a3db5069015eacb9ec70510dc094686" class="idref" href="#4a3db5069015eacb9ec70510dc094686"><span class="id" title="binder"><span id="H:34" class="id">Σ</span></span></a>} :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := (@<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesAgreePre"><span class="id" title="method">EnclavesAgreePre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#4a3db5069015eacb9ec70510dc094686"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_agree"><span class="id" title="method">enclaves_agree</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_name_all"><span class="id" title="method">enclaves_name_all</span></a> (<span class="id" title="notation">●</span> <span class="id" title="notation">(</span><span class="id" title="definition">to_agree</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tbl:32"><span class="id" title="variable">tbl</span></a><span class="id" title="notation">)</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="EC_auth" class="idref" href="#EC_auth"><span class="id" title="definition">EC_auth</span></a> `{<a id="H:36" class="idref" href="#H:36"><span class="id" title="binder">ceriseG</span></a> <a id="9ea391fdfca2d92fa2d39490b0221e9c" class="idref" href="#9ea391fdfca2d92fa2d39490b0221e9c"><span class="id" title="binder"><span id="H:36" class="id">Σ</span></span></a>} (<a id="n:37" class="idref" href="#n:37"><span class="id" title="binder">n</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#ENum"><span class="id" title="definition">ENum</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := @<a class="idref" href="cap_machine.program_logic.base_logic.html#ECPre"><span class="id" title="method">ECPre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#9ea391fdfca2d92fa2d39490b0221e9c"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#EC_G"><span class="id" title="method">EC_G</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#EC_name"><span class="id" title="method">EC_name</span></a> (<span class="id" title="notation">●</span><span class="id" title="notation">E</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#n:37"><span class="id" title="variable">n</span></a>).<br/>

<br/>
<span class="comment">(*&nbsp;Fragmental&nbsp;resources&nbsp;*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclave_cur" class="idref" href="#enclave_cur"><span class="id" title="definition">enclave_cur</span></a> (<a id="eid:38" class="idref" href="#eid:38"><span class="id" title="binder">eid</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>) (<a id="identity:39" class="idref" href="#identity:39"><span class="id" title="binder">identity</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) `{<a id="H:41" class="idref" href="#H:41"><span class="id" title="binder">ceriseG</span></a> <a id="a5fa9249bdc19684169f7ebb302b006b" class="idref" href="#a5fa9249bdc19684169f7ebb302b006b"><span class="id" title="binder"><span id="H:41" class="id">Σ</span></span></a>} :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := (@<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesExclPre"><span class="id" title="method">EnclavesExclPre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a5fa9249bdc19684169f7ebb302b006b"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_excl"><span class="id" title="method">enclaves_excl</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_name_cur"><span class="id" title="method">enclaves_name_cur</span></a> (<span class="id" title="definition">auth_frag</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#eid:38"><span class="id" title="variable">eid</span></a> <span class="id" title="notation">:=</span> <span class="id" title="constructor">Excl</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#identity:39"><span class="id" title="variable">identity</span></a><span class="id" title="notation">]}</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclave_prev" class="idref" href="#enclave_prev"><span class="id" title="definition">enclave_prev</span></a> (<a id="eid:42" class="idref" href="#eid:42"><span class="id" title="binder">eid</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>) `{<a id="H:44" class="idref" href="#H:44"><span class="id" title="binder">ceriseG</span></a> <a id="ea478fd00cb4a06cc640b1b27bf65159" class="idref" href="#ea478fd00cb4a06cc640b1b27bf65159"><span class="id" title="binder"><span id="H:44" class="id">Σ</span></span></a>} : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#ea478fd00cb4a06cc640b1b27bf65159"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="id:45" class="idref" href="#id:45"><span class="id" title="binder">id</span></a> <span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := (@<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesAgreePre"><span class="id" title="method">EnclavesAgreePre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#ea478fd00cb4a06cc640b1b27bf65159"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_agree"><span class="id" title="method">enclaves_agree</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_name_prev"><span class="id" title="method">enclaves_name_prev</span></a> (<span class="id" title="definition">auth_frag</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#eid:42"><span class="id" title="variable">eid</span></a> <span class="id" title="notation">:=</span> <span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#id:45"><span class="id" title="variable">id</span></a><span class="id" title="notation">]}</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="enclave_all" class="idref" href="#enclave_all"><span class="id" title="definition">enclave_all</span></a> (<a id="eid:46" class="idref" href="#eid:46"><span class="id" title="binder">eid</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>) (<a id="id:47" class="idref" href="#id:47"><span class="id" title="binder">id</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) `{<a id="H:49" class="idref" href="#H:49"><span class="id" title="binder">ceriseG</span></a> <a id="1599156b531db08541b0ea734472e882" class="idref" href="#1599156b531db08541b0ea734472e882"><span class="id" title="binder"><span id="H:49" class="id">Σ</span></span></a>} : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#1599156b531db08541b0ea734472e882"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := (@<a class="idref" href="cap_machine.program_logic.base_logic.html#EnclavesAgreePre"><span class="id" title="method">EnclavesAgreePre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1599156b531db08541b0ea734472e882"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_agree"><span class="id" title="method">enclaves_agree</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_name_all"><span class="id" title="method">enclaves_name_all</span></a> (<span class="id" title="definition">auth_frag</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#eid:46"><span class="id" title="variable">eid</span></a> <span class="id" title="notation">:=</span> <span class="id" title="definition">to_agree</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#id:47"><span class="id" title="variable">id</span></a><span class="id" title="notation">]}</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="enclave_all_agree" class="idref" href="#enclave_all_agree"><span class="id" title="lemma">enclave_all_agree</span></a> (<a id="tidx:50" class="idref" href="#tidx:50"><span class="id" title="binder">tidx</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>) (<a id="id1:51" class="idref" href="#id1:51"><span class="id" title="binder">id1</span></a> <a id="id2:52" class="idref" href="#id2:52"><span class="id" title="binder">id2</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) `{<a id="H:54" class="idref" href="#H:54"><span class="id" title="binder">ceriseG</span></a> <a id="20d7c0ecc86fe88fa924e57d0c585b54" class="idref" href="#20d7c0ecc86fe88fa924e57d0c585b54"><span class="id" title="binder"><span id="H:54" class="id">Σ</span></span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_all"><span class="id" title="definition">enclave_all</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:50"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#id1:51"><span class="id" title="variable">id1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_all"><span class="id" title="definition">enclave_all</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:50"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#id2:52"><span class="id" title="variable">id2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#id1:51"><span class="id" title="variable">id1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#id2:52"><span class="id" title="variable">id2</span></a> <span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "[E1 E2]".<br/>
&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "E1 E2" <span class="id" title="keyword">as</span> "E".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">own_valid</span> <span class="id" title="lemma">auth_frag_validI</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "E" <span class="id" title="keyword">as</span> "%E".<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">singleton_valid</span> <span class="id" title="var">tidx</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">to_agree_op_inv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">E</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="enclave_prev_timeless" class="idref" href="#enclave_prev_timeless"><span class="id" title="instance">enclave_prev_timeless</span></a> `{<a id="H:56" class="idref" href="#H:56"><span class="id" title="binder">ceriseG</span></a> <a id="f1e8fd5f016d0a22b08224b45bb8ae16" class="idref" href="#f1e8fd5f016d0a22b08224b45bb8ae16"><span class="id" title="binder"><span id="H:56" class="id">Σ</span></span></a>} (<a id="tidx:57" class="idref" href="#tidx:57"><span class="id" title="binder">tidx</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>)  : <span class="id" title="class">Timeless</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_prev"><span class="id" title="definition">enclave_prev</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:57"><span class="id" title="variable">tidx</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="enclave_cur_timeless" class="idref" href="#enclave_cur_timeless"><span class="id" title="instance">enclave_cur_timeless</span></a> `{<a id="H:59" class="idref" href="#H:59"><span class="id" title="binder">ceriseG</span></a> <a id="fe1b904099dfeab72f9743c2bf233c57" class="idref" href="#fe1b904099dfeab72f9743c2bf233c57"><span class="id" title="binder"><span id="H:59" class="id">Σ</span></span></a>} (<a id="tidx:60" class="idref" href="#tidx:60"><span class="id" title="binder">tidx</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>) (<a id="eid:61" class="idref" href="#eid:61"><span class="id" title="binder">eid</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) : <span class="id" title="class">Timeless</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_cur"><span class="id" title="definition">enclave_cur</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:60"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#eid:61"><span class="id" title="variable">eid</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="enclave_all_timeless" class="idref" href="#enclave_all_timeless"><span class="id" title="instance">enclave_all_timeless</span></a> `{<a id="H:63" class="idref" href="#H:63"><span class="id" title="binder">ceriseG</span></a> <a id="e4cd9633ec2d0ee09ebe5d497f8dd196" class="idref" href="#e4cd9633ec2d0ee09ebe5d497f8dd196"><span class="id" title="binder"><span id="H:63" class="id">Σ</span></span></a>} (<a id="tidx:64" class="idref" href="#tidx:64"><span class="id" title="binder">tidx</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a>) (<a id="eid:65" class="idref" href="#eid:65"><span class="id" title="binder">eid</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) : <span class="id" title="class">Timeless</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_all"><span class="id" title="definition">enclave_all</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:64"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#eid:65"><span class="id" title="variable">eid</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="EC_frag" class="idref" href="#EC_frag"><span class="id" title="definition">EC_frag</span></a> `{<a id="H:67" class="idref" href="#H:67"><span class="id" title="binder">ceriseG</span></a> <a id="2c4bc88cf29784b11cf0422588c29192" class="idref" href="#2c4bc88cf29784b11cf0422588c29192"><span class="id" title="binder"><span id="H:67" class="id">Σ</span></span></a>} (<a id="n:68" class="idref" href="#n:68"><span class="id" title="binder">n</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#ENum"><span class="id" title="definition">ENum</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2c4bc88cf29784b11cf0422588c29192"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="definition">own</span> (<span class="id" title="var">inG0</span> := @<a class="idref" href="cap_machine.program_logic.base_logic.html#ECPre"><span class="id" title="method">ECPre</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2c4bc88cf29784b11cf0422588c29192"><span class="id" title="variable">Σ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#EC_G"><span class="id" title="method">EC_G</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#EC_name"><span class="id" title="method">EC_name</span></a> (<span class="id" title="definition">excl_auth_frag</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#n:68"><span class="id" title="variable">n</span></a>).<br/>

<br/>
#[<span class="id" title="var">global</span>] <span class="id" title="keyword">Instance</span> <a id="EC_timeless" class="idref" href="#EC_timeless"><span class="id" title="instance">EC_timeless</span></a> `{<a id="H:70" class="idref" href="#H:70"><span class="id" title="binder">ceriseG</span></a> <a id="4490fc2114c8436ece16d296ed53d878" class="idref" href="#4490fc2114c8436ece16d296ed53d878"><span class="id" title="binder"><span id="H:70" class="id">Σ</span></span></a>} (<a id="n:71" class="idref" href="#n:71"><span class="id" title="binder">n</span></a> : <a class="idref" href="cap_machine.opsem.machine_base.html#ENum"><span class="id" title="definition">ENum</span></a>) : <span class="id" title="class">Timeless</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#EC_frag"><span class="id" title="definition">EC_frag</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#n:71"><span class="id" title="variable">n</span></a>).<br/>
<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">_</span>. <span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#Cerisier_resources"><span class="id" title="section">Cerisier_resources</span></a>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="enclave_cur_compat" class="idref" href="#enclave_cur_compat"><span class="id" title="lemma">enclave_cur_compat</span></a> `{<a id="H:73" class="idref" href="#H:73"><span class="id" title="binder">ceriseG</span></a> <a id="5f7f8a3a36b9c7b682466610e664c174" class="idref" href="#5f7f8a3a36b9c7b682466610e664c174"><span class="id" title="binder"><span id="H:73" class="id">Σ</span></span></a>} {<a id="tidx:74" class="idref" href="#tidx:74"><span class="id" title="binder">tidx</span></a> <a id="eid:75" class="idref" href="#eid:75"><span class="id" title="binder">eid</span></a> <a id="cur_tb:76" class="idref" href="#cur_tb:76"><span class="id" title="binder">cur_tb</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_cur"><span class="id" title="definition">enclave_cur</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:74"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#eid:75"><span class="id" title="variable">eid</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_cur"><span class="id" title="definition">enclaves_cur</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:76"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:76"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:74"><span class="id" title="variable">tidx</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#eid:75"><span class="id" title="variable">eid</span></a> <span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hcur Hcur_tb".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hcur_tb Hcur"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hvalid".<br/>
&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">auth_both_valid_discrete</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvalid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hvalid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hincl</span> &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">singleton_included_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hincl</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">I'</span> &amp; <span class="id" title="var">HeqI'</span> &amp; <span class="id" title="var">HII'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqI'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">I'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">last</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">destruct</span> (<span class="id" title="var">cur_tb</span> <span class="id" title="notation">!!</span> <span class="id" title="var">tidx</span>); <span class="id" title="tactic">apply</span> <span class="id" title="definition">leibniz_equiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqI'</span>; <span class="id" title="tactic">inversion</span> <span class="id" title="var">HeqI'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Excl_included</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HII'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="definition">leibniz_equiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HII'</span>; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="definition">leibniz_equiv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqI'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">cur_tb</span> <span class="id" title="notation">!!</span> <span class="id" title="var">tidx</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HeqI'</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="enclave_prev_compat" class="idref" href="#enclave_prev_compat"><span class="id" title="lemma">enclave_prev_compat</span></a> `{<a id="H:78" class="idref" href="#H:78"><span class="id" title="binder">ceriseG</span></a> <a id="15bb1c35edab98229a8cfae9c0763c1a" class="idref" href="#15bb1c35edab98229a8cfae9c0763c1a"><span class="id" title="binder"><span id="H:78" class="id">Σ</span></span></a>} {<a id="tidx:79" class="idref" href="#tidx:79"><span class="id" title="binder">tidx</span></a> <a id="prev_tb:80" class="idref" href="#prev_tb:80"><span class="id" title="binder">prev_tb</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_prev"><span class="id" title="definition">enclave_prev</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:79"><span class="id" title="variable">tidx</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_prev"><span class="id" title="definition">enclaves_prev</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:80"><span class="id" title="variable">prev_tb</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:79"><span class="id" title="variable">tidx</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:80"><span class="id" title="variable">prev_tb</span></a> <span class="id" title="notation">⌝</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(%eid &amp; Hprev) Hprev_tb".<br/>
&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_valid_2</span> <span class="id" title="notation">with</span> "Hprev_tb Hprev"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hvalid".<br/>
&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">auth_both_valid_discrete</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hvalid</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hvalid</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">Hincl</span> &amp; <span class="id" title="var">_</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">singleton_included_l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hincl</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">I'</span> &amp; <span class="id" title="var">HeqI'</span> &amp; <span class="id" title="var">HII'</span>).<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqI'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">prev_tb</span> <span class="id" title="notation">!!</span> <span class="id" title="var">tidx</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Hptbtidx</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">HeqI'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="lemma">elem_of_dom_2</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hptbtidx</span>).<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="enclave_update_deinit" class="idref" href="#enclave_update_deinit"><span class="id" title="lemma">enclave_update_deinit</span></a> `{<a id="H:82" class="idref" href="#H:82"><span class="id" title="binder">ceriseG</span></a> <a id="213a0dec94e9cf112034b0b076aaefbc" class="idref" href="#213a0dec94e9cf112034b0b076aaefbc"><span class="id" title="binder"><span id="H:82" class="id">Σ</span></span></a>} {<a id="cur_tb:83" class="idref" href="#cur_tb:83"><span class="id" title="binder">cur_tb</span></a> <a id="prev_tb:84" class="idref" href="#prev_tb:84"><span class="id" title="binder">prev_tb</span></a> <a id="tidx:85" class="idref" href="#tidx:85"><span class="id" title="binder">tidx</span></a> <a id="I:86" class="idref" href="#I:86"><span class="id" title="binder">I</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:83"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">##ₘ</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:84"><span class="id" title="variable">prev_tb</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_cur"><span class="id" title="definition">enclaves_cur</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:83"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_prev"><span class="id" title="definition">enclaves_prev</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:84"><span class="id" title="variable">prev_tb</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_cur"><span class="id" title="definition">enclave_cur</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:85"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#I:86"><span class="id" title="variable">I</span></a> <span class="id" title="notation">==∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_prev"><span class="id" title="definition">enclave_prev</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:85"><span class="id" title="variable">tidx</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_cur"><span class="id" title="definition">enclaves_cur</span></a> (<span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:85"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:83"><span class="id" title="variable">cur_tb</span></a>) <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_prev"><span class="id" title="definition">enclaves_prev</span></a> (<span class="id" title="definition">insert</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#tidx:85"><span class="id" title="variable">tidx</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#I:86"><span class="id" title="variable">I</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:84"><span class="id" title="variable">prev_tb</span></a>).<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdisj</span>) "Hcur_tb Hprev_tb Hcur".<br/>
&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#enclave_cur_compat"><span class="id" title="axiom">enclave_cur_compat</span></a> <span class="id" title="notation">with</span> "Hcur Hcur_tb"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcurtbtidx".<br/>
&nbsp;&nbsp;<span class="id" title="var">iCombine</span> "Hcur_tb Hcur" <span class="id" title="keyword">as</span> "Hcurm".<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update</span> <span class="id" title="notation">with</span> "Hcurm"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hcurm".<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">auth_update_dealloc</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="constructor">excl.Excl</span> <span class="id" title="notation">&lt;$&gt;</span> <span class="id" title="notation">(</span><span class="id" title="definition">delete</span> <span class="id" title="var">tidx</span> <span class="id" title="var">cur_tb</span><span class="id" title="notation">)</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_delete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (@<span class="id" title="lemma">delete_singleton_local_update</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="inductive">excl</span> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a>) (<span class="id" title="constructor">Excl</span> <span class="id" title="notation">&lt;$&gt;</span> <span class="id" title="var">cur_tb</span>)).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">own_update</span> <span class="id" title="notation">with</span> "Hprev_tb"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hprev_tb &amp; Hprev)".<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">auth_update_alloc</span> <span class="id" title="var">_</span> (<span class="id" title="definition">to_agree</span> <span class="id" title="notation">&lt;$&gt;</span> <span class="id" title="notation">(</span><span class="id" title="definition">insert</span> <span class="id" title="var">tidx</span> <span class="id" title="var">I</span> <span class="id" title="var">prev_tb</span><span class="id" title="notation">)</span>) <span class="id" title="notation">{[</span> <span class="id" title="var">tidx</span> <span class="id" title="notation">:=</span> <span class="id" title="definition">to_agree</span> <span class="id" title="var">I</span><span class="id" title="notation">]}</span> ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">fmap_insert</span> -<span class="id" title="lemma">insert_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">alloc_singleton_local_update</span>; <span class="id" title="var">last</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">enough</span> (<span class="id" title="var">prev_tb</span> <span class="id" title="notation">!!</span> <span class="id" title="var">tidx</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hprev_tbNone</span> <span class="id" title="tactic">by</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hprev_tbNone</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<span class="id" title="lemma">map_disjoint_Some_l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hdisj</span> <span class="id" title="var">Hcurtbtidx</span>).<br/>
&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hprev".<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iExists</span> <span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="state_interp_logical" class="idref" href="#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a id="53420228d41523f32b06a1b783e5db98" class="idref" href="#53420228d41523f32b06a1b783e5db98"><span class="id" title="binder">σ</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) `{<a id="H:88" class="idref" href="#H:88"><span class="id" title="binder">ReservedAddresses</span></a>} `{<a id="ceriseG0:90" class="idref" href="#ceriseG0:90"><span class="id" title="binder">!</span></a><a id="ceriseG0:90" class="idref" href="#ceriseG0:90"><span class="id" title="binder">ceriseG</span></a> <a id="c51b7ec861f7c17647e5cb8afff8d01c" class="idref" href="#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="binder"><span id="ceriseG0:90" class="id">Σ</span></span></a>} : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c51b7ec861f7c17647e5cb8afff8d01c"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="lr:91" class="idref" href="#lr:91"><span class="id" title="binder">lr</span></a> <a id="lm:92" class="idref" href="#lm:92"><span class="id" title="binder">lm</span></a> <a id="vmap:93" class="idref" href="#vmap:93"><span class="id" title="binder">vmap</span></a> (<a id="cur_tb:94" class="idref" href="#cur_tb:94"><span class="id" title="binder">cur_tb</span></a> <a id="prev_tb:95" class="idref" href="#prev_tb:95"><span class="id" title="binder">prev_tb</span></a> <a id="all_tb:96" class="idref" href="#all_tb:96"><span class="id" title="binder">all_tb</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.opsem.machine_base.html#TIndex"><span class="id" title="definition">TIndex</span></a> <a class="idref" href="cap_machine.opsem.machine_base.html#EIdentity"><span class="id" title="definition">EIdentity</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lr:91"><span class="id" title="variable">lr</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:92"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:94"><span class="id" title="variable">cur_tb</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#53420228d41523f32b06a1b783e5db98"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a>)<span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_cur"><span class="id" title="definition">enclaves_cur</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:94"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_prev"><span class="id" title="definition">enclaves_prev</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:95"><span class="id" title="variable">prev_tb</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#enclaves_all"><span class="id" title="definition">enclaves_all</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#all_tb:96"><span class="id" title="variable">all_tb</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#EC_auth"><span class="id" title="definition">EC_auth</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#53420228d41523f32b06a1b783e5db98"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a>) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:94"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">##</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:95"><span class="id" title="variable">prev_tb</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">dom</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:94"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:95"><span class="id" title="variable">prev_tb</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="definition">list_to_set</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#seq"><span class="id" title="definition">seq</span></a> 0 <a class="idref" href="cap_machine.program_logic.base_logic.html#53420228d41523f32b06a1b783e5db98"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a>))<span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <span class="comment">(**)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:94"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">##ₘ</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:95"><span class="id" title="variable">prev_tb</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#cur_tb:94"><span class="id" title="variable">cur_tb</span></a> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#prev_tb:95"><span class="id" title="variable">prev_tb</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#all_tb:96"><span class="id" title="variable">all_tb</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#53420228d41523f32b06a1b783e5db98"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#53420228d41523f32b06a1b783e5db98"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#lr:91"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:92"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#vmap:93"><span class="id" title="variable">vmap</span></a><span class="id" title="notation">⌝</span>.<br/>

<br/>
<span class="comment">(*&nbsp;invariants&nbsp;for&nbsp;memory,&nbsp;and&nbsp;a&nbsp;state&nbsp;interpretation&nbsp;for&nbsp;(mem,reg)&nbsp;*)</span><br/>
<span class="id" title="keyword">Global Instance</span> <a id="memG_irisG" class="idref" href="#memG_irisG"><span class="id" title="instance">memG_irisG</span></a> `{<a id="H:97" class="idref" href="#H:97"><span class="id" title="binder">MachineParameters</span></a>} `{<a id="H0:98" class="idref" href="#H0:98"><span class="id" title="binder">ReservedAddresses</span></a>} `{<a id="ceriseg:100" class="idref" href="#ceriseg:100"><span class="id" title="binder">ceriseg</span></a>: !<a class="idref" href="cap_machine.program_logic.base_logic.html#ceriseG"><span class="id" title="class">ceriseG</span></a> <a id="c9e15f4e4a066e426552b369ba33da08" class="idref" href="#c9e15f4e4a066e426552b369ba33da08"><span class="id" title="binder">Σ</span></a>} : <span class="id" title="abbreviation">irisGS</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_lang"><span class="id" title="definition">cap_lang</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#c9e15f4e4a066e426552b369ba33da08"><span class="id" title="variable">Σ</span></a> := {<br/>
&nbsp;&nbsp;<span class="id" title="method">iris_invGS</span> := <a class="idref" href="cap_machine.program_logic.base_logic.html#cerise_invG"><span class="id" title="method">cerise_invG</span></a>;<br/>
&nbsp;&nbsp;<span class="id" title="method">state_interp</span> <a id="0068bba064954ff1d2256a45ce198696" class="idref" href="#0068bba064954ff1d2256a45ce198696"><span class="id" title="binder">σ</span></a> <span class="id" title="var">_</span> <a id="358b4f2de2eb5cf0d919c4fcb2b9446e" class="idref" href="#358b4f2de2eb5cf0d919c4fcb2b9446e"><span class="id" title="binder">κs</span></a> <span class="id" title="var">_</span> := <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#0068bba064954ff1d2256a45ce198696"><span class="id" title="variable">σ</span></a>;<br/>
&nbsp;&nbsp;<span class="id" title="method">fork_post</span> <span class="id" title="var">_</span> := <span class="id" title="notation">True</span>%<span class="id" title="var">I</span>;<br/>
&nbsp;&nbsp;<span class="id" title="method">num_laters_per_step</span> <span class="id" title="var">_</span> := 0;<br/>
&nbsp;&nbsp;<span class="id" title="method">state_interp_mono</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> := <span class="id" title="lemma">fupd_intro</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>}.<br/>

<br/>
<span class="comment">(*&nbsp;Notations&nbsp;for&nbsp;fragmental&nbsp;resources&nbsp;*)</span><br/>
<span class="id" title="keyword">Notation</span> <a id="d699e1eac025f99265fa61d377dbfa74" class="idref" href="#d699e1eac025f99265fa61d377dbfa74"><span class="id" title="notation">&quot;</span></a>EC⤇ n" := (<a class="idref" href="cap_machine.program_logic.base_logic.html#EC_frag"><span class="id" title="definition">EC_frag</span></a> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">n</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="var">format</span> "EC⤇ n") : <span class="id" title="var">bi_scope</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Points&nbsp;to&nbsp;predicates&nbsp;for&nbsp;logical&nbsp;registers&nbsp;*)</span><br/>
<span class="id" title="keyword">Notation</span> <a id="b4e695cd58dba538326a0ae97922fc83" class="idref" href="#b4e695cd58dba538326a0ae97922fc83"><span class="id" title="notation">&quot;</span></a>r ↦ᵣ{ q } lw" := (<span class="id" title="definition">mapsto</span> (<span class="id" title="var">L</span>:=<a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<span class="id" title="var">V</span>:=<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <span class="id" title="var">r</span> <span class="id" title="var">q</span> <span class="id" title="var">lw</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">q</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="var">format</span> "r  ↦ᵣ{ q } lw") : <span class="id" title="var">bi_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="db884c99aed36a9ddaddcd7edc424755" class="idref" href="#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">&quot;</span></a>r ↦ᵣ lw" := (<span class="id" title="definition">mapsto</span> (<span class="id" title="var">L</span>:=<a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<span class="id" title="var">V</span>:=<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <span class="id" title="var">r</span> (<span class="id" title="constructor">DfracOwn</span> 1) <span class="id" title="var">lw</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20) : <span class="id" title="var">bi_scope</span>.<br/>

<br/>
<span class="comment">(*&nbsp;Points-to&nbsp;predicates&nbsp;for&nbsp;logical&nbsp;memory&nbsp;*)</span><br/>
<span class="id" title="keyword">Notation</span> <a id="1f356528680e66e063184d2852c70086" class="idref" href="#1f356528680e66e063184d2852c70086"><span class="id" title="notation">&quot;</span></a>la ↦ₐ{ q } lw" := (<span class="id" title="definition">mapsto</span> (<span class="id" title="var">L</span>:=<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<span class="id" title="var">V</span>:=<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <span class="id" title="var">la</span> <span class="id" title="var">q</span> <span class="id" title="var">lw</span>)<br/>
&nbsp;&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20, <span class="id" title="var">q</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 50, <span class="id" title="var">format</span> "la  ↦ₐ{ q }  lw") : <span class="id" title="var">bi_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a id="e389c97555835874498bb08a394266c6" class="idref" href="#e389c97555835874498bb08a394266c6"><span class="id" title="notation">&quot;</span></a>la ↦ₐ lw" := (<span class="id" title="definition">mapsto</span> (<span class="id" title="var">L</span>:=<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<span class="id" title="var">V</span>:=<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <span class="id" title="var">la</span> (<span class="id" title="constructor">DfracOwn</span> 1) <span class="id" title="var">lw</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 20) : <span class="id" title="var">bi_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Declare Scope</span> <span class="id" title="var">LAddr_scope</span>.<br/>
<span class="id" title="keyword">Delimit</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">LAddr_scope</span> <span class="id" title="keyword">with</span> <span class="id" title="var">la</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a id="eqb_laddr" class="idref" href="#eqb_laddr"><span class="id" title="abbreviation">eqb_laddr</span></a> := (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><a id="a1:103" class="idref" href="#a1:103"><span class="id" title="binder">a1</span></a> <a id="a2:104" class="idref" href="#a2:104"><span class="id" title="binder">a2</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#a1:103"><span class="id" title="variable">a1</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#78f5fa8e2bcce93d56bc8dcc902b0827"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a2:104"><span class="id" title="variable">a2</span></a><span class="id" title="notation">.1</span>)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">&amp;&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#a1:103"><span class="id" title="variable">a1</span></a><span class="id" title="notation">.2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Arith.PeanoNat.html#ad2ec4e405f68c46c0a176e3e94ae2e3"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a2:104"><span class="id" title="variable">a2</span></a><span class="id" title="notation">.2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::bool_scope:x_'&amp;&amp;'_x"><span class="id" title="notation">)</span></a>).<br/>
<span class="id" title="keyword">Notation</span> <a id="2075081701d58abc4fd86ad4dce27d74" class="idref" href="#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">&quot;</span></a>a1 =? a2" := (<a class="idref" href="cap_machine.program_logic.base_logic.html#eqb_laddr"><span class="id" title="abbreviation">eqb_laddr</span></a> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span>) : <span class="id" title="var">LAddr_scope</span>.<br/>

<br/>
<span class="comment">(*&nbsp;---------------------------&nbsp;LTAC&nbsp;DEFINITIONS&nbsp;-----------------------------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*&nbsp;Ltac&nbsp;destruct_cons_hook&nbsp;::=&nbsp;destruct_cons_hook2.&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_head_step</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">progress</span> <span class="id" title="var">simplify_map_eq</span>/= <span class="comment">(*&nbsp;simplify&nbsp;memory&nbsp;stuff&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.opsem.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#of_to_val"><span class="id" title="axiom">of_to_val</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#of_val"><span class="id" title="definition">of_val</span></a> ?<span class="id" title="var">v</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">is_var</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">destruct</span> <span class="id" title="var">v</span>; <span class="id" title="tactic">first</span>[<span class="id" title="tactic">discriminate</span> <span class="id" title="var">H</span>|<span class="id" title="tactic">injection</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">H</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.opsem.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> ?<span class="id" title="var">e</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">is_var</span> <span class="id" title="var">e</span>; <span class="id" title="tactic">fail</span> 1); <span class="comment">(*&nbsp;inversion&nbsp;yields&nbsp;many&nbsp;goals&nbsp;if&nbsp;<span class="inlinecode"><span class="id" title="var">e</span></span>&nbsp;is&nbsp;a&nbsp;variable&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;can&nbsp;thus&nbsp;better&nbsp;be&nbsp;avoided.&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> φ := <span class="id" title="tactic">fresh</span> "φ" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> [| φ]; <span class="id" title="tactic">subst</span> φ; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules" class="idref" href="#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="ceriseg:106" class="idref" href="#ceriseg:106"><span class="id" title="binder">ceriseg</span></a>: <a class="idref" href="cap_machine.program_logic.base_logic.html#ceriseG"><span class="id" title="class">ceriseG</span></a> <a id="1ff6ac9c7b5724ab259a0ddfc84e9a1e" class="idref" href="#1ff6ac9c7b5724ab259a0ddfc84e9a1e"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{ <a id="reservedaddresses:107" class="idref" href="#reservedaddresses:107"><span class="id" title="binder">reservedaddresses</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#ReservedAddresses"><span class="id" title="class">ReservedAddresses</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="MP:108" class="idref" href="#MP:108"><span class="id" title="binder">MP</span></a>: <a class="idref" href="cap_machine.opsem.machine_parameters.html#MachineParameters"><span class="id" title="class">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.opsem.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.opsem.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Conditionally&nbsp;unify&nbsp;on&nbsp;the&nbsp;read&nbsp;register&nbsp;value&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="read_reg_inr" class="idref" href="#read_reg_inr"><span class="id" title="definition">read_reg_inr</span></a> (<a id="lregs:109" class="idref" href="#lregs:109"><span class="id" title="binder">lregs</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="r:110" class="idref" href="#r:110"><span class="id" title="binder">r</span></a> : <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) <a id="p:111" class="idref" href="#p:111"><span class="id" title="binder">p</span></a> <a id="b:112" class="idref" href="#b:112"><span class="id" title="binder">b</span></a> <a id="e:113" class="idref" href="#e:113"><span class="id" title="binder">e</span></a> <a id="a:114" class="idref" href="#a:114"><span class="id" title="binder">a</span></a> <a id="v:115" class="idref" href="#v:115"><span class="id" title="binder">v</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:109"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:110"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span>) =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p'</span> <span class="id" title="var">b'</span> <span class="id" title="var">e'</span> <span class="id" title="var">a'</span> <span class="id" title="var">v'</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:111"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:112"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:113"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:114"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:115"><span class="id" title="variable">v</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">True</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <span class="id" title="notation">False</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;registers&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_dupl_false" class="idref" href="#regname_dupl_false"><span class="id" title="lemma">regname_dupl_false</span></a> <a id="r:116" class="idref" href="#r:116"><span class="id" title="binder">r</span></a> <a id="lw1:117" class="idref" href="#lw1:117"><span class="id" title="binder">lw1</span></a> <a id="lw2:118" class="idref" href="#lw2:118"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r:116"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:117"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:116"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:118"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hr1 Hr2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Hr1 Hr2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regname_neq" class="idref" href="#regname_neq"><span class="id" title="lemma">regname_neq</span></a> <a id="r1:119" class="idref" href="#r1:119"><span class="id" title="binder">r1</span></a> <a id="r2:120" class="idref" href="#r2:120"><span class="id" title="binder">r2</span></a> <a id="lw1:121" class="idref" href="#lw1:121"><span class="id" title="binder">lw1</span></a> <a id="lw2:122" class="idref" href="#lw2:122"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:119"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:121"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:120"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:122"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:119"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:120"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2" (?). <span class="id" title="tactic">subst</span> <span class="id" title="var">r1</span>. <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_dupl_false"><span class="id" title="axiom">regname_dupl_false</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_1" class="idref" href="#map_of_regs_1"><span class="id" title="lemma">map_of_regs_1</span></a> (<a id="r1:123" class="idref" href="#r1:123"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:124" class="idref" href="#lw1:124"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:123"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:124"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:125" class="idref" href="#k:125"><span class="id" title="binder"><span id="k:126" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:127" class="idref" href="#y:127"><span class="id" title="binder"><span id="y:128" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:123"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:124"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:125"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:127"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_1" class="idref" href="#regs_of_map_1"><span class="id" title="lemma">regs_of_map_1</span></a> (<a id="r1:129" class="idref" href="#r1:129"><span class="id" title="binder">r1</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:130" class="idref" href="#lw1:130"><span class="id" title="binder">lw1</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:131" class="idref" href="#k:131"><span class="id" title="binder"><span id="k:132" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:133" class="idref" href="#y:133"><span class="id" title="binder"><span id="y:134" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">{[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:129"><span class="id" title="variable">r1</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:130"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]}</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:131"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:133"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:129"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:130"><span class="id" title="variable">lw1</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_singleton</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_2" class="idref" href="#map_of_regs_2"><span class="id" title="lemma">map_of_regs_2</span></a> (<a id="r1:135" class="idref" href="#r1:135"><span class="id" title="binder">r1</span></a> <a id="r2:136" class="idref" href="#r2:136"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:137" class="idref" href="#lw1:137"><span class="id" title="binder">lw1</span></a> <a id="lw2:138" class="idref" href="#lw2:138"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:135"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:137"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:136"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:138"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:139" class="idref" href="#k:139"><span class="id" title="binder"><span id="k:140" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:141" class="idref" href="#y:141"><span class="id" title="binder"><span id="y:142" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:135"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:137"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:139"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:141"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:135"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:136"><span class="id" title="variable">r2</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2". <span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_2" class="idref" href="#regs_of_map_2"><span class="id" title="lemma">regs_of_map_2</span></a> (<a id="r1:143" class="idref" href="#r1:143"><span class="id" title="binder">r1</span></a> <a id="r2:144" class="idref" href="#r2:144"><span class="id" title="binder">r2</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="lw1:145" class="idref" href="#lw1:145"><span class="id" title="binder">lw1</span></a> <a id="lw2:146" class="idref" href="#lw2:146"><span class="id" title="binder">lw2</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:143"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:144"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:147" class="idref" href="#k:147"><span class="id" title="binder"><span id="k:148" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:149" class="idref" href="#y:149"><span class="id" title="binder"><span id="y:150" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:143"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:145"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:147"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:149"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:143"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:145"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:144"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:146"><span class="id" title="variable">lw2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert_None</span>; <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_3" class="idref" href="#map_of_regs_3"><span class="id" title="lemma">map_of_regs_3</span></a> (<a id="r1:151" class="idref" href="#r1:151"><span class="id" title="binder">r1</span></a> <a id="r2:152" class="idref" href="#r2:152"><span class="id" title="binder">r2</span></a> <a id="r3:153" class="idref" href="#r3:153"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:154" class="idref" href="#w1:154"><span class="id" title="binder">w1</span></a> <a id="w2:155" class="idref" href="#w2:155"><span class="id" title="binder">w2</span></a> <a id="w3:156" class="idref" href="#w3:156"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:151"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w1:154"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:152"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w2:155"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:153"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w3:156"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:157" class="idref" href="#k:157"><span class="id" title="binder"><span id="k:158" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:159" class="idref" href="#y:159"><span class="id" title="binder"><span id="y:160" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:151"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w1:154"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:157"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:159"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:151"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:152"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:151"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:153"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:152"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:153"><span class="id" title="variable">r3</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_3" class="idref" href="#regs_of_map_3"><span class="id" title="lemma">regs_of_map_3</span></a> (<a id="r1:161" class="idref" href="#r1:161"><span class="id" title="binder">r1</span></a> <a id="r2:162" class="idref" href="#r2:162"><span class="id" title="binder">r2</span></a> <a id="r3:163" class="idref" href="#r3:163"><span class="id" title="binder">r3</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:164" class="idref" href="#w1:164"><span class="id" title="binder">w1</span></a> <a id="w2:165" class="idref" href="#w2:165"><span class="id" title="binder">w2</span></a> <a id="w3:166" class="idref" href="#w3:166"><span class="id" title="binder">w3</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:161"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:162"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:161"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:163"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:162"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:163"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:167" class="idref" href="#k:167"><span class="id" title="binder"><span id="k:168" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:169" class="idref" href="#y:169"><span class="id" title="binder"><span id="y:170" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:161"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w1:164"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:167"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:169"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:161"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w1:164"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:162"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w2:165"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:163"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w3:166"><span class="id" title="variable">w3</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? ? ?) "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_of_regs_4" class="idref" href="#map_of_regs_4"><span class="id" title="lemma">map_of_regs_4</span></a> (<a id="r1:171" class="idref" href="#r1:171"><span class="id" title="binder">r1</span></a> <a id="r2:172" class="idref" href="#r2:172"><span class="id" title="binder">r2</span></a> <a id="r3:173" class="idref" href="#r3:173"><span class="id" title="binder">r3</span></a> <a id="r4:174" class="idref" href="#r4:174"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:175" class="idref" href="#w1:175"><span class="id" title="binder">w1</span></a> <a id="w2:176" class="idref" href="#w2:176"><span class="id" title="binder">w2</span></a> <a id="w3:177" class="idref" href="#w3:177"><span class="id" title="binder">w3</span></a> <a id="w4:178" class="idref" href="#w4:178"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:171"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w1:175"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:172"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w2:176"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:173"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w3:177"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:174"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w4:178"><span class="id" title="variable">w4</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:179" class="idref" href="#k:179"><span class="id" title="binder"><span id="k:180" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:181" class="idref" href="#y:181"><span class="id" title="binder"><span id="y:182" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:171"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w1:175"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:179"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:181"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:171"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:172"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:171"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:173"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:171"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:174"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:172"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:173"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:172"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:174"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:173"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:174"><span class="id" title="variable">r4</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H1 H2 H3 H4".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H1 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H3"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H2 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#regname_neq"><span class="id" title="axiom">regname_neq</span></a> <span class="id" title="notation">with</span> "H3 H4"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="regs_of_map_4" class="idref" href="#regs_of_map_4"><span class="id" title="lemma">regs_of_map_4</span></a> (<a id="r1:183" class="idref" href="#r1:183"><span class="id" title="binder">r1</span></a> <a id="r2:184" class="idref" href="#r2:184"><span class="id" title="binder">r2</span></a> <a id="r3:185" class="idref" href="#r3:185"><span class="id" title="binder">r3</span></a> <a id="r4:186" class="idref" href="#r4:186"><span class="id" title="binder">r4</span></a>: <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>) (<a id="w1:187" class="idref" href="#w1:187"><span class="id" title="binder">w1</span></a> <a id="w2:188" class="idref" href="#w2:188"><span class="id" title="binder">w2</span></a> <a id="w3:189" class="idref" href="#w3:189"><span class="id" title="binder">w3</span></a> <a id="w4:190" class="idref" href="#w4:190"><span class="id" title="binder">w4</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:183"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:184"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:183"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:185"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:183"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:186"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:184"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:185"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:184"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:186"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:185"><span class="id" title="variable">r3</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:186"><span class="id" title="variable">r4</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:191" class="idref" href="#k:191"><span class="id" title="binder"><span id="k:192" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:193" class="idref" href="#y:193"><span class="id" title="binder"><span id="y:194" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#r1:183"><span class="id" title="variable">r1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w1:187"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r3</span><span class="id" title="notation">:=</span><span class="id" title="notation">w3</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">r4</span><span class="id" title="notation">:=</span><span class="id" title="notation">w4</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)))</span><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:191"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:193"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#r1:183"><span class="id" title="variable">r1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w1:187"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:184"><span class="id" title="variable">r2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w2:188"><span class="id" title="variable">w2</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r3:185"><span class="id" title="variable">r3</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w3:189"><span class="id" title="variable">w3</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r4:186"><span class="id" title="variable">r4</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w4:190"><span class="id" title="variable">w4</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hmap". <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">big_sepM_insert</span> ?<span class="id" title="lemma">big_sepM_empty</span>; <span class="id" title="var">simplify_map_eq</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "(? &amp; ? &amp; ? &amp; ? &amp; _)"; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-------------------------&nbsp;memory&nbsp;points-to&nbsp;---------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_dupl_false" class="idref" href="#addr_dupl_false"><span class="id" title="lemma">addr_dupl_false</span></a> <a id="la:195" class="idref" href="#la:195"><span class="id" title="binder">la</span></a> <a id="lw1:196" class="idref" href="#lw1:196"><span class="id" title="binder">lw1</span></a> <a id="lw2:197" class="idref" href="#lw2:197"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#la:195"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:196"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:195"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:197"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">False</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">mapsto_valid_2</span> <span class="id" title="notation">with</span> "Ha1 Ha2"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">dfrac_full_exclusive</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;semantic&nbsp;heap&nbsp;+&nbsp;a&nbsp;map&nbsp;of&nbsp;pointsto&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM_general" class="idref" href="#gen_heap_valid_inSepM_general"><span class="id" title="lemma">gen_heap_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:198" class="idref" href="#L:198"><span class="id" title="binder">L</span></a> <a id="V:199" class="idref" href="#V:199"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:200" class="idref" href="#EqDecision0:200"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:198"><span class="id" title="variable">L</span></a>) (<a id="H:201" class="idref" href="#H:201"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:198"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="eb108301922c3577e58b724777773441" class="idref" href="#eb108301922c3577e58b724777773441"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:203" class="idref" href="#gen_heapG0:203"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:199"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#eb108301922c3577e58b724777773441"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="5ee560e9707aa476b4dbc5dff872c545" class="idref" href="#5ee560e9707aa476b4dbc5dff872c545"><span class="id" title="binder">d</span></a><a id="5ee560e9707aa476b4dbc5dff872c545" class="idref" href="#5ee560e9707aa476b4dbc5dff872c545"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:198"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:199"><span class="id" title="variable">V</span></a>)) (<a id="0b61b54e044009e37fbbedc4d00cfb3b" class="idref" href="#0b61b54e044009e37fbbedc4d00cfb3b"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:198"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:199"><span class="id" title="variable">V</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="l:206" class="idref" href="#l:206"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#L:198"><span class="id" title="variable">L</span></a>) (<a id="dq:207" class="idref" href="#dq:207"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:208" class="idref" href="#v:208"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#V:199"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#5ee560e9707aa476b4dbc5dff872c545"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#5ee560e9707aa476b4dbc5dff872c545"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:206"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#dq:207"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:208"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#0b61b54e044009e37fbbedc4d00cfb3b"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:209" class="idref" href="#k:209"><span class="id" title="binder"><span id="k:210" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:211" class="idref" href="#dqw:211"><span class="id" title="binder"><span id="dqw:212" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#5ee560e9707aa476b4dbc5dff872c545"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#5ee560e9707aa476b4dbc5dff872c545"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:209"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:211"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:211"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#0b61b54e044009e37fbbedc4d00cfb3b"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:206"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:208"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM" class="idref" href="#gen_heap_valid_inSepM"><span class="id" title="lemma">gen_heap_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:213" class="idref" href="#L:213"><span class="id" title="binder">L</span></a> <a id="V:214" class="idref" href="#V:214"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:215" class="idref" href="#EqDecision0:215"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:213"><span class="id" title="variable">L</span></a>) (<a id="H:216" class="idref" href="#H:216"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:213"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="2eb8ca153ddce4681334c967ec6319eb" class="idref" href="#2eb8ca153ddce4681334c967ec6319eb"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:218" class="idref" href="#gen_heapG0:218"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:213"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:214"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2eb8ca153ddce4681334c967ec6319eb"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b8dcf1340be889687d882c19440505f6" class="idref" href="#b8dcf1340be889687d882c19440505f6"><span class="id" title="binder">σ</span></a> <a id="3a5c5de7277453970bb3eda40c4d0e86" class="idref" href="#3a5c5de7277453970bb3eda40c4d0e86"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:213"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:214"><span class="id" title="variable">V</span></a>) (<a id="l:221" class="idref" href="#l:221"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#L:213"><span class="id" title="variable">L</span></a>) (<a id="q:222" class="idref" href="#q:222"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span>) (<a id="v:223" class="idref" href="#v:223"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#V:214"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#3a5c5de7277453970bb3eda40c4d0e86"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:221"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:223"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#b8dcf1340be889687d882c19440505f6"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:224" class="idref" href="#k:224"><span class="id" title="binder"><span id="k:225" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:226" class="idref" href="#y:226"><span class="id" title="binder"><span id="y:227" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#3a5c5de7277453970bb3eda40c4d0e86"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:224"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#q:222"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:226"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#b8dcf1340be889687d882c19440505f6"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:221"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:223"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "? [? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'" class="idref" href="#gen_heap_valid_inSepM'"><span class="id" title="lemma">gen_heap_valid_inSepM'</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:228" class="idref" href="#L:228"><span class="id" title="binder">L</span></a> <a id="V:229" class="idref" href="#V:229"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:230" class="idref" href="#EqDecision0:230"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:228"><span class="id" title="variable">L</span></a>) (<a id="H:231" class="idref" href="#H:231"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:228"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="25d4a4e1ff9e4bc0ce3937ee94e865bf" class="idref" href="#25d4a4e1ff9e4bc0ce3937ee94e865bf"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:233" class="idref" href="#gen_heapG0:233"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:228"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:229"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#25d4a4e1ff9e4bc0ce3937ee94e865bf"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="6ae2b894f7fa75afb52ff0971b3ee983" class="idref" href="#6ae2b894f7fa75afb52ff0971b3ee983"><span class="id" title="binder">σ</span></a> <a id="2ce57b3b11a05fc73814d372163d9923" class="idref" href="#2ce57b3b11a05fc73814d372163d9923"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:228"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:229"><span class="id" title="variable">V</span></a>) (<a id="q:236" class="idref" href="#q:236"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#6ae2b894f7fa75afb52ff0971b3ee983"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:237" class="idref" href="#k:237"><span class="id" title="binder"><span id="k:238" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:239" class="idref" href="#y:239"><span class="id" title="binder"><span id="y:240" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2ce57b3b11a05fc73814d372163d9923"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:237"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#q:236"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:239"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:241" class="idref" href="#l:241"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.program_logic.base_logic.html#L:228"><span class="id" title="variable">L</span></a>) (<a id="v:242" class="idref" href="#v:242"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.program_logic.base_logic.html#V:229"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2ce57b3b11a05fc73814d372163d9923"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:241"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:242"><span class="id" title="variable">v</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#6ae2b894f7fa75afb52ff0971b3ee983"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:241"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:242"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ').<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inSepM'_general" class="idref" href="#gen_heap_valid_inSepM'_general"><span class="id" title="lemma">gen_heap_valid_inSepM'_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:243" class="idref" href="#L:243"><span class="id" title="binder">L</span></a> <a id="V:244" class="idref" href="#V:244"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:245" class="idref" href="#EqDecision0:245"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:243"><span class="id" title="variable">L</span></a>) (<a id="H:246" class="idref" href="#H:246"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:243"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="45ad452e18d5a81c71fd6fb580d7a22c" class="idref" href="#45ad452e18d5a81c71fd6fb580d7a22c"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:248" class="idref" href="#gen_heapG0:248"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:243"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:244"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#45ad452e18d5a81c71fd6fb580d7a22c"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="07b41a83042bd0b3d16a886b58a4fbe7" class="idref" href="#07b41a83042bd0b3d16a886b58a4fbe7"><span class="id" title="binder">d</span></a><a id="07b41a83042bd0b3d16a886b58a4fbe7" class="idref" href="#07b41a83042bd0b3d16a886b58a4fbe7"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:243"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:244"><span class="id" title="variable">V</span></a>)) (<a id="1f82389f51406c0b98813302596bfb5d" class="idref" href="#1f82389f51406c0b98813302596bfb5d"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:243"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:244"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f82389f51406c0b98813302596bfb5d"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:251" class="idref" href="#k:251"><span class="id" title="binder"><span id="k:252" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:253" class="idref" href="#dqw:253"><span class="id" title="binder"><span id="dqw:254" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#07b41a83042bd0b3d16a886b58a4fbe7"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#07b41a83042bd0b3d16a886b58a4fbe7"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:251"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:253"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:253"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:255" class="idref" href="#l:255"><span class="id" title="binder">l</span></a>: <a class="idref" href="cap_machine.program_logic.base_logic.html#L:243"><span class="id" title="variable">L</span></a>) (<a id="d:256" class="idref" href="#d:256"><span class="id" title="binder">d</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="v:257" class="idref" href="#v:257"><span class="id" title="binder">v</span></a>: <a class="idref" href="cap_machine.program_logic.base_logic.html#V:244"><span class="id" title="variable">V</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#07b41a83042bd0b3d16a886b58a4fbe7"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#07b41a83042bd0b3d16a886b58a4fbe7"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:255"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#d:256"><span class="id" title="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:257"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f82389f51406c0b98813302596bfb5d"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:255"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:257"><span class="id" title="variable">v</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "? Hmap" (<span class="id" title="var">l</span> <span class="id" title="var">d</span> <span class="id" title="var">v</span> <span class="id" title="var">H</span>σ).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span>σ <span class="id" title="var">l</span>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hmap" <span class="id" title="keyword">as</span> "[? ?]". <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM_general" class="idref" href="#gen_heap_valid_inclSepM_general"><span class="id" title="lemma">gen_heap_valid_inclSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:258" class="idref" href="#L:258"><span class="id" title="binder">L</span></a> <a id="V:259" class="idref" href="#V:259"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:260" class="idref" href="#EqDecision0:260"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:258"><span class="id" title="variable">L</span></a>) (<a id="H:261" class="idref" href="#H:261"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:258"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="48a43f736daee0cd5111b893d90ae5d3" class="idref" href="#48a43f736daee0cd5111b893d90ae5d3"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:263" class="idref" href="#gen_heapG0:263"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:258"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:259"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#48a43f736daee0cd5111b893d90ae5d3"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="8e921e983911d75f29dde4c07e896f3f" class="idref" href="#8e921e983911d75f29dde4c07e896f3f"><span class="id" title="binder">d</span></a><a id="8e921e983911d75f29dde4c07e896f3f" class="idref" href="#8e921e983911d75f29dde4c07e896f3f"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:258"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:259"><span class="id" title="variable">V</span></a>)) (<a id="e48bd5d3333be0867e53c6404df88c22" class="idref" href="#e48bd5d3333be0867e53c6404df88c22"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:258"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:259"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#e48bd5d3333be0867e53c6404df88c22"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:266" class="idref" href="#k:266"><span class="id" title="binder"><span id="k:267" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="dqw:268" class="idref" href="#dqw:268"><span class="id" title="binder"><span id="dqw:269" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#8e921e983911d75f29dde4c07e896f3f"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#8e921e983911d75f29dde4c07e896f3f"><span class="id" title="variable">σ</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:266"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:268"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:268"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><span class="id" title="notation">(</span><span class="id" title="definition">fmap</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#8e921e983911d75f29dde4c07e896f3f"><span class="id" title="variable">d</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#8e921e983911d75f29dde4c07e896f3f"><span class="id" title="variable">σ</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#e48bd5d3333be0867e53c6404df88c22"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inSepM'_general"><span class="id" title="axiom">gen_heap_valid_inSepM'_general</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H". <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">d</span>σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="var">HH'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> <span class="id" title="var">p</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">apply</span> <span class="id" title="var">Hincl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HH'</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;+&nbsp;cbn.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_inclSepM" class="idref" href="#gen_heap_valid_inclSepM"><span class="id" title="lemma">gen_heap_valid_inclSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:270" class="idref" href="#L:270"><span class="id" title="binder">L</span></a> <a id="V:271" class="idref" href="#V:271"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:272" class="idref" href="#EqDecision0:272"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:270"><span class="id" title="variable">L</span></a>) (<a id="H:273" class="idref" href="#H:273"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:270"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="cc664e2ebdb5001557a38eea9d90b077" class="idref" href="#cc664e2ebdb5001557a38eea9d90b077"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:275" class="idref" href="#gen_heapG0:275"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:270"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:271"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#cc664e2ebdb5001557a38eea9d90b077"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="79073c5aed27b0e3ae6cbf746f16fe40" class="idref" href="#79073c5aed27b0e3ae6cbf746f16fe40"><span class="id" title="binder">σ</span></a> <a id="971926898590233b59f929de087d4d95" class="idref" href="#971926898590233b59f929de087d4d95"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:270"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:271"><span class="id" title="variable">V</span></a>) (<a id="q:278" class="idref" href="#q:278"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#79073c5aed27b0e3ae6cbf746f16fe40"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:279" class="idref" href="#k:279"><span class="id" title="binder"><span id="k:280" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:281" class="idref" href="#y:281"><span class="id" title="binder"><span id="y:282" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#971926898590233b59f929de087d4d95"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:279"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#q:278"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:281"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#971926898590233b59f929de087d4d95"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#79073c5aed27b0e3ae6cbf746f16fe40"><span class="id" title="variable">σ</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> *. <span class="id" title="var">iIntros</span> "Hσ Hmap".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inSepM'"><span class="id" title="axiom">gen_heap_valid_inSepM'</span></a> <span class="id" title="notation">with</span> "Hσ Hmap"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "#H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hincl</span>. <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">option_relation</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (σ' <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH'</span>; <span class="id" title="tactic">destruct</span> (σ <span class="id" title="notation">!!</span> <span class="id" title="var">l</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HH</span>; <span class="id" title="var">naive_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_valid_allSepM" class="idref" href="#gen_heap_valid_allSepM"><span class="id" title="lemma">gen_heap_valid_allSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="L:283" class="idref" href="#L:283"><span class="id" title="binder">L</span></a> <a id="V:284" class="idref" href="#V:284"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>) (<a id="EqDecision0:285" class="idref" href="#EqDecision0:285"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:283"><span class="id" title="variable">L</span></a>) (<a id="H:286" class="idref" href="#H:286"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:283"><span class="id" title="variable">L</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="EV:287" class="idref" href="#EV:287"><span class="id" title="binder">EV</span></a>: <span class="id" title="class">Equiv</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:284"><span class="id" title="variable">V</span></a>) (<a id="REV:288" class="idref" href="#REV:288"><span class="id" title="binder">REV</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#EV:287"><span class="id" title="variable">EV</span></a>) (<a id="LEV:289" class="idref" href="#LEV:289"><span class="id" title="binder">LEV</span></a>: @<span class="id" title="class">LeibnizEquiv</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:284"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#EV:287"><span class="id" title="variable">EV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="bbd035773a529b63dc6323e3d43b3600" class="idref" href="#bbd035773a529b63dc6323e3d43b3600"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>) (<a id="gen_heapG0:291" class="idref" href="#gen_heapG0:291"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:283"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:284"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#bbd035773a529b63dc6323e3d43b3600"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="42b0bc8e64cab4e668fd5538f5b79064" class="idref" href="#42b0bc8e64cab4e668fd5538f5b79064"><span class="id" title="binder">σ</span></a> <a id="dfb709dfa80dbf6663ffdb94ab918c29" class="idref" href="#dfb709dfa80dbf6663ffdb94ab918c29"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:283"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:284"><span class="id" title="variable">V</span></a>) (<a id="q:294" class="idref" href="#q:294"><span class="id" title="binder">q</span></a> : <span class="id" title="record">Qp</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="l:295" class="idref" href="#l:295"><span class="id" title="binder">l</span></a>:<a class="idref" href="cap_machine.program_logic.base_logic.html#L:283"><span class="id" title="variable">L</span></a><span class="id" title="notation">),</span> <span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#dfb709dfa80dbf6663ffdb94ab918c29"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:295"><span class="id" title="variable">l</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#42b0bc8e64cab4e668fd5538f5b79064"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:296" class="idref" href="#k:296"><span class="id" title="binder"><span id="k:297" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:298" class="idref" href="#y:298"><span class="id" title="binder"><span id="y:299" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfb709dfa80dbf6663ffdb94ab918c29"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:296"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#q:294"><span class="id" title="variable">q</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:298"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#42b0bc8e64cab4e668fd5538f5b79064"><span class="id" title="variable">σ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfb709dfa80dbf6663ffdb94ab918c29"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * ? ? * <span class="id" title="var">H</span>σ'. <span class="id" title="var">iIntros</span> "A B".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iAssert</span> (<span class="id" title="notation">⌜</span> <span class="id" title="notation">forall</span> <a id="l:300" class="idref" href="#l:300"><span class="id" title="binder"><span id="l:301" class="id">l</span></span></a><span class="id" title="notation">,</span> σ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:300"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> σ' <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:300"><span class="id" title="variable">l</span></a> <span class="id" title="notation">⌝</span>)%<span class="id" title="var">I</span> <span class="id" title="keyword">with</span> "[A B]" <span class="id" title="keyword">as</span> %<span class="id" title="var">HH</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iIntros</span> (<span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">H</span>σ' <span class="id" title="var">l</span>). <span class="id" title="tactic">unfold</span> <span class="id" title="definition">is_Some</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ' <span class="id" title="keyword">as</span> [<span class="id" title="var">v</span> <span class="id" title="var">H</span>σ'].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inSepM"><span class="id" title="axiom">gen_heap_valid_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> σ σ') <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="var">H</span>σ' <span class="id" title="notation">with</span> "[$]"<span class="id" title="notation">)</span>. <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="instance">map_leibniz</span>. <span class="id" title="tactic">intro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">leibniz_equiv_iff</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <span class="id" title="definition">equiv</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Classes.RelationClasses.html#Reflexive"><span class="id" title="class">Reflexive</span></a>. <span class="id" title="tactic">intros</span> [ <span class="id" title="var">x</span> |].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">unfold</span> <span class="id" title="instance">option_equiv</span>. <span class="id" title="tactic">constructor</span>. <span class="id" title="tactic">apply</span> <span class="id" title="var">REV</span>. } <span class="id" title="tactic">constructor</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM_general" class="idref" href="#gen_heap_update_inSepM_general"><span class="id" title="lemma">gen_heap_update_inSepM_general</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:302" class="idref" href="#L:302"><span class="id" title="binder">L</span></a> <a id="V:303" class="idref" href="#V:303"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:304" class="idref" href="#EqDecision0:304"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:302"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:305" class="idref" href="#H:305"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:302"><span class="id" title="variable">L</span></a>} {<a id="38ec0d810825fad5197eff2fcbab7290" class="idref" href="#38ec0d810825fad5197eff2fcbab7290"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:307" class="idref" href="#gen_heapG0:307"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:302"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:303"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#38ec0d810825fad5197eff2fcbab7290"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="bf539eddcb1cb802410af5309cc464fa" class="idref" href="#bf539eddcb1cb802410af5309cc464fa"><span class="id" title="binder">σ</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:302"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:303"><span class="id" title="variable">V</span></a>) (<a id="bc0ee0d7fa504e4fe69fb6a563a64eb3" class="idref" href="#bc0ee0d7fa504e4fe69fb6a563a64eb3"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:302"><span class="id" title="variable">L</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:303"><span class="id" title="variable">V</span></a>)) (<a id="l:310" class="idref" href="#l:310"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#L:302"><span class="id" title="variable">L</span></a>) (<a id="v:311" class="idref" href="#v:311"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#V:303"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="w:312" class="idref" href="#w:312"><span class="id" title="binder">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#bc0ee0d7fa504e4fe69fb6a563a64eb3"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:310"><span class="id" title="variable">l</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:312"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#bf539eddcb1cb802410af5309cc464fa"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:313" class="idref" href="#k:313"><span class="id" title="binder"><span id="k:314" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:315" class="idref" href="#y:315"><span class="id" title="binder"><span id="y:316" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#bc0ee0d7fa504e4fe69fb6a563a64eb3"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:313"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:315"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:315"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#l:310"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#v:311"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:317" class="idref" href="#k:317"><span class="id" title="binder"><span id="k:318" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:319" class="idref" href="#y:319"><span class="id" title="binder"><span id="y:320" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#l:310"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:311"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:317"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:319"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:319"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hw</span>. <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_update_inSepM" class="idref" href="#gen_heap_update_inSepM"><span class="id" title="lemma">gen_heap_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="L:321" class="idref" href="#L:321"><span class="id" title="binder">L</span></a> <a id="V:322" class="idref" href="#V:322"><span class="id" title="binder">V</span></a> : <span class="id" title="keyword">Type</span>} {<a id="EqDecision0:323" class="idref" href="#EqDecision0:323"><span class="id" title="binder">EqDecision0</span></a> : <span class="id" title="abbreviation">EqDecision</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:321"><span class="id" title="variable">L</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="H:324" class="idref" href="#H:324"><span class="id" title="binder">H</span></a> : <span class="id" title="class">Countable</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:321"><span class="id" title="variable">L</span></a>} {<a id="254f4fe056e9633ec7276ff785e9e7df" class="idref" href="#254f4fe056e9633ec7276ff785e9e7df"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="gen_heapG0:326" class="idref" href="#gen_heapG0:326"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:321"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:322"><span class="id" title="variable">V</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#254f4fe056e9633ec7276ff785e9e7df"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b82d4293b07cd0a577e6aa100e996178" class="idref" href="#b82d4293b07cd0a577e6aa100e996178"><span class="id" title="binder">σ</span></a> <a id="3dfe2287758ca9365d1ab91d6fe3fe95" class="idref" href="#3dfe2287758ca9365d1ab91d6fe3fe95"><span class="id" title="binder">σ'</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#L:321"><span class="id" title="variable">L</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#V:322"><span class="id" title="variable">V</span></a>) (<a id="l:329" class="idref" href="#l:329"><span class="id" title="binder">l</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#L:321"><span class="id" title="variable">L</span></a>) (<a id="v:330" class="idref" href="#v:330"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.program_logic.base_logic.html#V:322"><span class="id" title="variable">V</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#3dfe2287758ca9365d1ab91d6fe3fe95"><span class="id" title="variable">σ'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#l:329"><span class="id" title="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#b82d4293b07cd0a577e6aa100e996178"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:331" class="idref" href="#k:331"><span class="id" title="binder"><span id="k:332" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:333" class="idref" href="#y:333"><span class="id" title="binder"><span id="y:334" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#3dfe2287758ca9365d1ab91d6fe3fe95"><span class="id" title="variable">σ'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:331"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:333"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#l:329"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#v:330"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:335" class="idref" href="#k:335"><span class="id" title="binder"><span id="k:336" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:337" class="idref" href="#y:337"><span class="id" title="binder"><span id="y:338" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#l:329"><span class="id" title="variable">l</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#v:330"><span class="id" title="variable">v</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span><span class="id" title="notation">),</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:335"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:337"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">H</span>σ'. <span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>σ'.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> σ' <span class="id" title="var">l</span>) //. <span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]". <span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">l</span><span class="id" title="notation">:=</span><span class="id" title="var">v</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">σ'</span>) <span class="id" title="var">l</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert_delete</span>. <span class="id" title="var">iFrame</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span> //.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;glm&nbsp;and&nbsp;lm&nbsp;should&nbsp;really&nbsp;be&nbsp;the&nbsp;same,&nbsp;but&nbsp;the&nbsp;generalization&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;inductive&nbsp;case.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_lmem_version_update_addr" class="idref" href="#gen_heap_lmem_version_update_addr"><span class="id" title="lemma">gen_heap_lmem_version_update_addr</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="lmem:339" class="idref" href="#lmem:339"><span class="id" title="binder">lmem</span></a> <a id="glm:340" class="idref" href="#glm:340"><span class="id" title="binder">glm</span></a> <a id="lm:341" class="idref" href="#lm:341"><span class="id" title="binder">lm</span></a> <a id="lmem':342" class="idref" href="#lmem':342"><span class="id" title="binder">lmem'</span></a> <a id="lm':343" class="idref" href="#lm':343"><span class="id" title="binder">lm'</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} {<a id="vmap:344" class="idref" href="#vmap:344"><span class="id" title="binder">vmap</span></a> <a id="vmap':345" class="idref" href="#vmap':345"><span class="id" title="binder">vmap'</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#VMap"><span class="id" title="definition">VMap</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="a:346" class="idref" href="#a:346"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.opsem.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>} {<a id="v:347" class="idref" href="#v:347"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:339"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:341"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':342"><span class="id" title="variable">lmem'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_addr"><span class="id" title="definition">update_version_addr</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#glm:340"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:346"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:347"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:339"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lm':343"><span class="id" title="variable">lm'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_addr"><span class="id" title="definition">update_version_addr</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#glm:340"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:346"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:347"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:341"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#vmap':345"><span class="id" title="variable">vmap'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_addr_vmap"><span class="id" title="definition">update_version_addr_vmap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:346"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:347"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#vmap:344"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lm:341"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#a:346"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:347"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#a:346"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#v:347"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#vmap:344"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:341"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:348" class="idref" href="#k:348"><span class="id" title="binder"><span id="k:349" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:350" class="idref" href="#y:350"><span class="id" title="binder"><span id="y:351" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:339"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:348"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:350"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm':343"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:352" class="idref" href="#k:352"><span class="id" title="binder"><span id="k:353" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:354" class="idref" href="#y:354"><span class="id" title="binder"><span id="y:355" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':342"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:352"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:354"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hlmem_incl</span> <span class="id" title="var">Hupdlmem</span> <span class="id" title="var">Hupdlm</span> <span class="id" title="var">Hupdvm</span> <span class="id" title="var">Hmaxvm_lm</span> <span class="id" title="var">Hcur_lm</span>) "Hgen Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_addr"><span class="id" title="definition">update_version_addr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupdlm</span>, <span class="id" title="var">Hupdlmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcur_lm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">glm</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">v</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">lw</span>|]<span class="id" title="var">eqn</span>:<span class="id" title="var">Hlmav</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iMod</span> (<span class="id" title="notation">((</span><span class="id" title="lemma">gen_heap_alloc</span> <span class="id" title="var">lm</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">a</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <span class="id" title="var">v</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hgen"<span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> "(Hgen &amp; Ha &amp; _)"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;local&nbsp;knowledge&nbsp;about&nbsp;(a,v)&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[Hmem Ha]"<span class="id" title="notation">)</span>; <span class="id" title="var">last</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken_None</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*shouldn't&nbsp;happen,&nbsp;but&nbsp;okay&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Note:&nbsp;glm&nbsp;and&nbsp;lm&nbsp;should&nbsp;really&nbsp;be&nbsp;the&nbsp;same,&nbsp;but&nbsp;the&nbsp;generalization&nbsp;is&nbsp;needed&nbsp;for&nbsp;the&nbsp;inductive&nbsp;case.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_heap_lmem_version_update" class="idref" href="#gen_heap_lmem_version_update"><span class="id" title="lemma">gen_heap_lmem_version_update</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="glm:356" class="idref" href="#glm:356"><span class="id" title="binder">glm</span></a> <a id="lmem:357" class="idref" href="#lmem:357"><span class="id" title="binder">lmem</span></a> <a id="lm:358" class="idref" href="#lm:358"><span class="id" title="binder">lm</span></a> <a id="lmem':359" class="idref" href="#lmem':359"><span class="id" title="binder">lmem'</span></a> <a id="lm':360" class="idref" href="#lm':360"><span class="id" title="binder">lm'</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="vmap:361" class="idref" href="#vmap:361"><span class="id" title="binder">vmap</span></a> <a id="vmap':362" class="idref" href="#vmap':362"><span class="id" title="binder">vmap'</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#VMap"><span class="id" title="definition">VMap</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:363" class="idref" href="#la:363"><span class="id" title="binder">la</span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a>) ( <a id="v:364" class="idref" href="#v:364"><span class="id" title="binder">v</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="inductive">NoDup</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:363"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:357"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:358"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':359"><span class="id" title="variable">lmem'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#glm:356"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:363"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:364"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:357"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lm':360"><span class="id" title="variable">lm'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#glm:356"><span class="id" title="variable">glm</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:363"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:364"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:358"><span class="id" title="variable">lm</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#vmap':362"><span class="id" title="variable">vmap'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_vmap"><span class="id" title="definition">update_version_region_vmap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:363"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:364"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#vmap:361"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:365" class="idref" href="#a:365"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.opsem.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:358"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#a:365"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:364"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Peano.html#0dacc1786c5ba797d47dd85006231633"><span class="id" title="notation">+</span></a>1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#la:363"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a:366" class="idref" href="#a:366"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.opsem.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#a:366"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#v:364"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#vmap:361"><span class="id" title="variable">vmap</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#la:363"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:358"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:367" class="idref" href="#k:367"><span class="id" title="binder"><span id="k:368" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:369" class="idref" href="#y:369"><span class="id" title="binder"><span id="y:370" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:357"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:367"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:369"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm':360"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:371" class="idref" href="#k:371"><span class="id" title="binder"><span id="k:372" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:373" class="idref" href="#y:373"><span class="id" title="binder"><span id="y:374" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':359"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">mapsto</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:371"><span class="id" title="variable">k</span></a> (<span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.base_logic.html#y:373"><span class="id" title="variable">y</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>=&gt; <span class="id" title="var">glm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">la</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">move</span>: <span class="id" title="var">glm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">la</span> <span class="id" title="keyword">as</span> [|<span class="id" title="var">a</span> <span class="id" title="var">la</span> <span class="id" title="var">IH</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">iIntros</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">glm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">lm'</span> <span class="id" title="var">vmap</span> <span class="id" title="var">vmap'</span> <span class="id" title="var">v</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">HNoDup_la</span> <span class="id" title="var">Hlmem_incl</span> <span class="id" title="var">Hupdlmem</span> <span class="id" title="var">Hupdlm</span> <span class="id" title="var">Hupdvmap</span> <span class="id" title="var">Hmaxv_lm</span> <span class="id" title="var">Hcur_lm</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Hgen Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="comment">(*&nbsp;no&nbsp;addresses&nbsp;updated&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupdlm</span>, <span class="id" title="var">Hupdvmap</span>, <span class="id" title="var">Hupdlmem</span>; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">destruct_cons</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="var">IH</span> <span class="id" title="var">glm</span> <span class="id" title="notation">with</span> "Hgen Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;[Hgen Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hupdlmem</span>, <span class="id" title="var">Hupdlm</span>, <span class="id" title="var">Hupdvmap</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lm''</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <span class="id" title="var">glm</span> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">lm'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lmem''</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <span class="id" title="var">glm</span> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">lmem'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_lmem_version_update_addr"><span class="id" title="axiom">gen_heap_lmem_version_update_addr</span></a> <span class="id" title="notation">with</span> "Hgen Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "&gt;[Hgen Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_mono"><span class="id" title="axiom">update_version_region_mono</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> &lt;-<span class="id" title="var">Hmaxv_lm_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_notin_preserves_lmem"><span class="id" title="axiom">update_version_region_notin_preserves_lmem</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_notin_preserves_cur"><span class="id" title="axiom">update_version_region_notin_preserves_cur</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#eq_refl"><span class="id" title="constructor">eq_refl</span></a> <span class="id" title="var">Ha_notin_la</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exact</span> <span class="id" title="var">Hcur_lm_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_kappa" class="idref" href="#prim_step_no_kappa"><span class="id" title="lemma">prim_step_no_kappa</span></a> {<a id="e1:375" class="idref" href="#e1:375"><span class="id" title="binder">e1</span></a> <a id="b43d145f29c6443aa035a2248351c621" class="idref" href="#b43d145f29c6443aa035a2248351c621"><span class="id" title="binder">σ1</span></a> <a id="625a30f9ece0845a8e26598413cba360" class="idref" href="#625a30f9ece0845a8e26598413cba360"><span class="id" title="binder">κ</span></a> <a id="e2:378" class="idref" href="#e2:378"><span class="id" title="binder">e2</span></a> <a id="4a229a9d667f7bccc6755a447f63266b" class="idref" href="#4a229a9d667f7bccc6755a447f63266b"><span class="id" title="binder">σ2</span></a> <a id="efs:380" class="idref" href="#efs:380"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e1:375"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b43d145f29c6443aa035a2248351c621"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#625a30f9ece0845a8e26598413cba360"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e2:378"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#4a229a9d667f7bccc6755a447f63266b"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#efs:380"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#625a30f9ece0845a8e26598413cba360"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="prim_step_no_efs" class="idref" href="#prim_step_no_efs"><span class="id" title="lemma">prim_step_no_efs</span></a> {<a id="e1:381" class="idref" href="#e1:381"><span class="id" title="binder">e1</span></a> <a id="9f63571ff14eb4428ed9170e47cee9b0" class="idref" href="#9f63571ff14eb4428ed9170e47cee9b0"><span class="id" title="binder">σ1</span></a> <a id="5b06ceda292e728b121e0320e905141d" class="idref" href="#5b06ceda292e728b121e0320e905141d"><span class="id" title="binder">κ</span></a> <a id="e2:384" class="idref" href="#e2:384"><span class="id" title="binder">e2</span></a> <a id="f5eca97d04f8028caa31bc4b50d84026" class="idref" href="#f5eca97d04f8028caa31bc4b50d84026"><span class="id" title="binder">σ2</span></a> <a id="efs:386" class="idref" href="#efs:386"><span class="id" title="binder">efs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e1:381"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#9f63571ff14eb4428ed9170e47cee9b0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#5b06ceda292e728b121e0320e905141d"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e2:384"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#f5eca97d04f8028caa31bc4b50d84026"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#efs:386"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#efs:386"><span class="id" title="variable">efs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">induction</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;--------------&nbsp;predicates&nbsp;on&nbsp;memory&nbsp;maps&nbsp;--------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="extract_sep_if_split" class="idref" href="#extract_sep_if_split"><span class="id" title="lemma">extract_sep_if_split</span></a> (<a id="a:387" class="idref" href="#a:387"><span class="id" title="binder">a</span></a> <a id="pc_a:388" class="idref" href="#pc_a:388"><span class="id" title="binder">pc_a</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) <a id="P:389" class="idref" href="#P:389"><span class="id" title="binder">P</span></a> <a id="Q:390" class="idref" href="#Q:390"><span class="id" title="binder">Q</span></a> <a id="R:391" class="idref" href="#R:391"><span class="id" title="binder">R</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#a:387"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#pc_a:388"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#P:389"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#Q:390"><span class="id" title="variable">Q</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#R:391"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">≡</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#a:387"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#pc_a:388"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#P:389"><span class="id" title="variable">P</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#Q:390"><span class="id" title="variable">Q</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#a:387"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#pc_a:388"><span class="id" title="variable">pc_a</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#R:391"><span class="id" title="variable">R</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">pc_a</span>)%<span class="id" title="var">la</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iIntros</span> "[H1 H2]"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_0" class="idref" href="#memMap_resource_0"><span class="id" title="lemma">memMap_resource_0</span></a>  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">True</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:392" class="idref" href="#la:392"><span class="id" title="binder"><span id="la:393" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:394" class="idref" href="#w:394"><span class="id" title="binder"><span id="w:395" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:392"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:394"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1" class="idref" href="#memMap_resource_1"><span class="id" title="lemma">memMap_resource_1</span></a> (<a id="a:396" class="idref" href="#a:396"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:397" class="idref" href="#w:397"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#a:396"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:397"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:398" class="idref" href="#la:398"><span class="id" title="binder"><span id="la:399" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:400" class="idref" href="#w:400"><span class="id" title="binder"><span id="w:401" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#a:396"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w:397"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:398"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:400"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.program_logic.base_logic.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_1_dq" class="idref" href="#memMap_resource_1_dq"><span class="id" title="lemma">memMap_resource_1_dq</span></a> (<a id="a:402" class="idref" href="#a:402"><span class="id" title="binder">a</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w:403" class="idref" href="#w:403"><span class="id" title="binder">w</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="dq:404" class="idref" href="#dq:404"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#a:402"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#dq:404"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:403"><span class="id" title="variable">w</span></a>  <span class="id" title="notation">⊣⊢</span> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:405" class="idref" href="#la:405"><span class="id" title="binder"><span id="la:406" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="w:407" class="idref" href="#w:407"><span class="id" title="binder"><span id="w:408" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#a:402"><span class="id" title="variable">a</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w:403"><span class="id" title="variable">w</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:405"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#dq:404"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:407"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[HH _]".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne" class="idref" href="#memMap_resource_2ne"><span class="id" title="lemma">memMap_resource_2ne</span></a> (<a id="a1:409" class="idref" href="#a1:409"><span class="id" title="binder">a1</span></a> <a id="a2:410" class="idref" href="#a2:410"><span class="id" title="binder">a2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="w1:411" class="idref" href="#w1:411"><span class="id" title="binder">w1</span></a> <a id="w2:412" class="idref" href="#w2:412"><span class="id" title="binder">w2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#a1:409"><span class="id" title="variable">a1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a2:410"><span class="id" title="variable">a2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> (<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:413" class="idref" href="#a:413"><span class="id" title="binder"><span id="a:414" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:415" class="idref" href="#w:415"><span class="id" title="binder"><span id="w:416" class="id">w</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#a1:409"><span class="id" title="variable">a1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#w1:411"><span class="id" title="variable">w1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">a2</span><span class="id" title="notation">:=</span><span class="id" title="notation">w2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:413"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:415"><span class="id" title="variable">w</span></a>)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#a1:409"><span class="id" title="variable">a1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w1:411"><span class="id" title="variable">w1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#a2:410"><span class="id" title="variable">a2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w2:412"><span class="id" title="variable">w2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_delete</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">a2</span> <span class="id" title="var">w2</span>); <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>. 2: <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">delete_insert</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.program_logic.base_logic.html#memMap_resource_0"><span class="id" title="axiom">memMap_resource_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "HH".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 [H2 _ ] ]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "HH" <span class="id" title="keyword">as</span> "[H1 H2]". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="address_neq" class="idref" href="#address_neq"><span class="id" title="lemma">address_neq</span></a> <a id="la1:417" class="idref" href="#la1:417"><span class="id" title="binder">la1</span></a> <a id="la2:418" class="idref" href="#la2:418"><span class="id" title="binder">la2</span></a> <a id="lw1:419" class="idref" href="#lw1:419"><span class="id" title="binder">lw1</span></a> <a id="lw2:420" class="idref" href="#lw2:420"><span class="id" title="binder">lw2</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#la1:417"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:419"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:418"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:420"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:417"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:418"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Ha1 Ha2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="machine_utils.finz_base.html#finz_eq_dec"><span class="id" title="instance">finz_eq_dec</span></a> <span class="id" title="var">la1</span><span class="id" title="notation">.1</span> <span class="id" title="var">la2</span><span class="id" title="notation">.1</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="instance">Nat.eq_dec</span> <span class="id" title="var">la1</span><span class="id" title="notation">.2</span> <span class="id" title="var">la2</span><span class="id" title="notation">.2</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">subst</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="var">iPureIntro</span>; <span class="id" title="tactic">congruence</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExFalso</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">la1</span> <span class="id" title="keyword">with</span> <span class="id" title="var">la2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#addr_dupl_false"><span class="id" title="axiom">addr_dupl_false</span></a> <span class="id" title="notation">with</span> "[$Ha1] [$Ha2]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2ne_apply" class="idref" href="#memMap_resource_2ne_apply"><span class="id" title="lemma">memMap_resource_2ne_apply</span></a> (<a id="la1:421" class="idref" href="#la1:421"><span class="id" title="binder">la1</span></a> <a id="la2:422" class="idref" href="#la2:422"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:423" class="idref" href="#lw1:423"><span class="id" title="binder">lw1</span></a> <a id="lw2:424" class="idref" href="#lw2:424"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#la1:421"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:423"><span class="id" title="variable">lw1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:422"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:424"><span class="id" title="variable">lw2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:425" class="idref" href="#la:425"><span class="id" title="binder"><span id="la:426" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:427" class="idref" href="#lw:427"><span class="id" title="binder"><span id="lw:428" class="id">lw</span></span></a> <span class="id" title="notation">∈</span>  <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:421"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:423"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:425"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:427"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:421"><span class="id" title="variable">la1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:422"><span class="id" title="variable">la2</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hi Hr2a".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#address_neq"><span class="id" title="axiom">address_neq</span></a>  <span class="id" title="notation">with</span> "Hi Hr2a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hne</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iSplitL</span> "Hi"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen" class="idref" href="#memMap_resource_2gen"><span class="id" title="lemma">memMap_resource_2gen</span></a> (<a id="la1:429" class="idref" href="#la1:429"><span class="id" title="binder">la1</span></a> <a id="la2:430" class="idref" href="#la2:430"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:431" class="idref" href="#lw1:431"><span class="id" title="binder">lw1</span></a> <a id="lw2:432" class="idref" href="#lw2:432"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;( <span class="id" title="notation">∃</span> <a id="lmem:433" class="idref" href="#lmem:433"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:434" class="idref" href="#la:434"><span class="id" title="binder"><span id="la:435" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:436" class="idref" href="#lw:436"><span class="id" title="binder"><span id="lw:437" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:433"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:434"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:436"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:430"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:429"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:433"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:429"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:431"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:433"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:429"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:431"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span> <span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:429"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:431"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:430"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:429"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:430"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:432"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Bool.Bool.html#andb_true_iff"><span class="id" title="lemma">andb_true_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span> ; <span class="id" title="tactic">destruct</span> <span class="id" title="var">Heq</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">HeqZ</span> <span class="id" title="var">HeqV</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.BinInt.html#Z.eqb_eq"><span class="id" title="lemma">Z.eqb_eq</span></a>, <a class="idref" href="machine_utils.finz_base.html#finz_to_z_eq"><span class="id" title="lemma">finz_to_z_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqZ</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.Natural.Peano.NPeano.html#Nat.eqb_eq"><span class="id" title="lemma">Nat.eqb_eq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">HeqV</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">la2</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">la1</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#injective_projections"><span class="id" title="lemma">injective_projections</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#memMap_resource_1"><span class="id" title="axiom">memMap_resource_1</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[HH -&gt;]". <span class="id" title="tactic">by</span> <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "[Hmap _]". <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -<a class="idref" href="cap_machine.program_logic.base_logic.html#memMap_resource_2ne"><span class="id" title="axiom">memMap_resource_2ne</span></a>; <span class="id" title="tactic">auto</span> ; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span>) "[HH -&gt;]" ; <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> 1 <span class="id" title="keyword">as</span> "Hmap"; <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d" class="idref" href="#memMap_resource_2gen_d"><span class="id" title="lemma">memMap_resource_2gen_d</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="8dd519b622979b09bfbb79ce09b0842c" class="idref" href="#8dd519b622979b09bfbb79ce09b0842c"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:439" class="idref" href="#la1:439"><span class="id" title="binder">la1</span></a> <a id="la2:440" class="idref" href="#la2:440"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:441" class="idref" href="#lw1:441"><span class="id" title="binder">lw1</span></a> <a id="lw2:442" class="idref" href="#lw2:442"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:443" class="idref" href="#lmem:443"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:444" class="idref" href="#la:444"><span class="id" title="binder"><span id="la:445" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:446" class="idref" href="#lw:446"><span class="id" title="binder"><span id="lw:447" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:443"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#8dd519b622979b09bfbb79ce09b0842c"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:444"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:446"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:440"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:439"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:443"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a>  <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:439"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:441"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:443"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:439"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:441"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#8dd519b622979b09bfbb79ce09b0842c"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:439"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:441"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:440"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:439"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#8dd519b622979b09bfbb79ce09b0842c"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:440"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:442"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">lmem</span>) "[Hmem Hif]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_d_dq" class="idref" href="#memMap_resource_2gen_d_dq"><span class="id" title="lemma">memMap_resource_2gen_d_dq</span></a> (<a id="6e92539227727736a732c40ac3add536" class="idref" href="#6e92539227727736a732c40ac3add536"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la1:449" class="idref" href="#la1:449"><span class="id" title="binder">la1</span></a> <a id="la2:450" class="idref" href="#la2:450"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:451" class="idref" href="#dq1:451"><span class="id" title="binder">dq1</span></a> <a id="dq2:452" class="idref" href="#dq2:452"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:453" class="idref" href="#lw1:453"><span class="id" title="binder">lw1</span></a> <a id="lw2:454" class="idref" href="#lw2:454"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span> <span class="id" title="notation">∃</span> <a id="lmem:455" class="idref" href="#lmem:455"><span class="id" title="binder">lmem</span></a> <a id="dfracs:456" class="idref" href="#dfracs:456"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:457" class="idref" href="#la:457"><span class="id" title="binder"><span id="la:458" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:459" class="idref" href="#dlw:459"><span class="id" title="binder"><span id="dlw:460" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfracs:456"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:455"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#6e92539227727736a732c40ac3add536"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:457"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dlw:459"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dlw:459"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:450"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:455"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:453"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:455"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:453"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:450"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfracs:456"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#dq1:451"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfracs:456"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#dq1:451"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#6e92539227727736a732c40ac3add536"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dq1:451"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:453"><span class="id" title="variable">lw1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:450"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:449"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#6e92539227727736a732c40ac3add536"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:450"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dq2:452"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:454"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> "Hmem" <span class="id" title="keyword">as</span> (<span class="id" title="var">mem</span> <span class="id" title="var">dfracs</span>) "[Hmem [Hif Hif'] ]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> ((<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span>) <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iDestruct</span> "Hif" <span class="id" title="keyword">as</span> %-&gt;. <span class="id" title="var">iDestruct</span> "Hif'" <span class="id" title="keyword">as</span> %-&gt;.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[$ Hmem]". <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Not&nbsp;the&nbsp;world's&nbsp;most&nbsp;beautiful&nbsp;lemma,&nbsp;but&nbsp;it&nbsp;does&nbsp;avoid&nbsp;us&nbsp;having&nbsp;to&nbsp;fiddle&nbsp;around&nbsp;with&nbsp;a&nbsp;later&nbsp;under&nbsp;an&nbsp;if&nbsp;in&nbsp;proofs&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater" class="idref" href="#memMap_resource_2gen_clater"><span class="id" title="lemma">memMap_resource_2gen_clater</span></a> (<a id="la1:461" class="idref" href="#la1:461"><span class="id" title="binder">la1</span></a> <a id="la2:462" class="idref" href="#la2:462"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw1:463" class="idref" href="#lw1:463"><span class="id" title="binder">lw1</span></a> <a id="lw2:464" class="idref" href="#lw2:464"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="dcd4def8edfaf9da6fe03b1c246720c2" class="idref" href="#dcd4def8edfaf9da6fe03b1c246720c2"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dcd4def8edfaf9da6fe03b1c246720c2"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:461"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:463"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:462"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:461"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dcd4def8edfaf9da6fe03b1c246720c2"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:462"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:464"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> (<span class="id" title="notation">∃</span> <a id="lmem:466" class="idref" href="#lmem:466"><span class="id" title="binder">lmem</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:467" class="idref" href="#la:467"><span class="id" title="binder"><span id="la:468" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:469" class="idref" href="#lw:469"><span class="id" title="binder"><span id="lw:470" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:466"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dcd4def8edfaf9da6fe03b1c246720c2"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:467"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:469"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:462"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:461"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:466"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:461"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:463"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:466"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:461"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:463"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>. <span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;general&nbsp;lemmas&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_resource_2gen_clater_dq" class="idref" href="#memMap_resource_2gen_clater_dq"><span class="id" title="lemma">memMap_resource_2gen_clater_dq</span></a> (<a id="la1:471" class="idref" href="#la1:471"><span class="id" title="binder">la1</span></a> <a id="la2:472" class="idref" href="#la2:472"><span class="id" title="binder">la2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="dq1:473" class="idref" href="#dq1:473"><span class="id" title="binder">dq1</span></a> <a id="dq2:474" class="idref" href="#dq2:474"><span class="id" title="binder">dq2</span></a> : <span class="id" title="inductive">dfrac</span>) (<a id="lw1:475" class="idref" href="#lw1:475"><span class="id" title="binder">lw1</span></a> <a id="lw2:476" class="idref" href="#lw2:476"><span class="id" title="binder">lw2</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="3b16640db82535fdd0102a126c651da8" class="idref" href="#3b16640db82535fdd0102a126c651da8"><span class="id" title="binder">Φ</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>)  :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#3b16640db82535fdd0102a126c651da8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dq1:473"><span class="id" title="variable">dq1</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:475"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:472"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <span class="id" title="notation">emp</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <span class="id" title="notation">▷</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#3b16640db82535fdd0102a126c651da8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la2:472"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dq2:474"><span class="id" title="variable">dq2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw2:476"><span class="id" title="variable">lw2</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">∃</span> <a id="lmem:478" class="idref" href="#lmem:478"><span class="id" title="binder">lmem</span></a> <a id="dfracs:479" class="idref" href="#dfracs:479"><span class="id" title="binder">dfracs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:480" class="idref" href="#la:480"><span class="id" title="binder"><span id="la:481" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dlw:482" class="idref" href="#dlw:482"><span class="id" title="binder"><span id="dlw:483" class="id">dlw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfracs:479"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:478"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#3b16640db82535fdd0102a126c651da8"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:480"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dlw:482"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#dlw:482"><span class="id" title="variable">dlw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:472"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:478"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:475"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:478"><span class="id" title="variable">lmem</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw1:475"><span class="id" title="variable">lw1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">if</span></a>  (<a class="idref" href="cap_machine.program_logic.base_logic.html#la2:472"><span class="id" title="variable">la2</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a>)%<span class="id" title="var">la</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">then</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfracs:479"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#dq1:473"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::general_if_scope:'if'_x_'then'_x_'else'_x"><span class="id" title="notation">else</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dfracs:479"><span class="id" title="variable">dfracs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la1:471"><span class="id" title="variable">la1</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#dq1:473"><span class="id" title="variable">dq1</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;)%<span class="id" title="var">I</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hc1 Hc2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">la2</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#2075081701d58abc4fd86ad4dce27d74"><span class="id" title="notation">=?</span></a> <span class="id" title="var">la1</span>)%<span class="id" title="var">la</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Heq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span> <span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iExists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">lw1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">lw2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>),(<span class="id" title="notation">&lt;[</span><span class="id" title="var">la1</span><span class="id" title="notation">:=</span><span class="id" title="var">dq1</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(&lt;[</span><span class="id" title="notation">la2</span><span class="id" title="notation">:=</span><span class="id" title="notation">dq2</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">∅)</span>); <span class="id" title="var">iSplitL</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iNext</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw1</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">lw2</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>);<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">merge_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="var">iFrame</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">lookup_insert_ne</span>;<span class="id" title="tactic">auto</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_neq"><span class="id" title="axiom">laddr_neq</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Heq</span>; <span class="id" title="tactic">congruence</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>;[|<span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>]. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="memMap_delete" class="idref" href="#memMap_delete"><span class="id" title="lemma">memMap_delete</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="la:484" class="idref" href="#la:484"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:485" class="idref" href="#lw:485"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) <a id="lmem:486" class="idref" href="#lmem:486"><span class="id" title="binder">lmem</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:486"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:484"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:485"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:487" class="idref" href="#la:487"><span class="id" title="binder"><span id="la:488" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:489" class="idref" href="#lw:489"><span class="id" title="binder"><span id="lw:490" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:486"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:487"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:489"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la:484"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:485"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:491" class="idref" href="#k:491"><span class="id" title="binder"><span id="k:492" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:493" class="idref" href="#y:493"><span class="id" title="binder"><span id="y:494" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">delete</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:484"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:486"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#k:491"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#y:493"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">lmem</span> <span class="id" title="var">Hmem</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> -(<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>); <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <a id="mem_remove_dq" class="idref" href="#mem_remove_dq"><span class="id" title="lemma">mem_remove_dq</span></a> <a id="lmem:495" class="idref" href="#lmem:495"><span class="id" title="binder">lmem</span></a> <a id="dq:496" class="idref" href="#dq:496"><span class="id" title="binder">dq</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:497" class="idref" href="#la:497"><span class="id" title="binder"><span id="la:498" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:499" class="idref" href="#lw:499"><span class="id" title="binder"><span id="lw:500" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:495"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:497"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#dq:496"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:499"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊣⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:501" class="idref" href="#la:501"><span class="id" title="binder"><span id="la:502" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:503" class="idref" href="#dw:503"><span class="id" title="binder"><span id="dw:504" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> (<a class="idref" href="cap_machine.utils.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:495"><span class="id" title="variable">lmem</span></a>)) <a class="idref" href="cap_machine.program_logic.base_logic.html#dq:496"><span class="id" title="variable">dq</span></a>) <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:495"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:501"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#dw:503"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dw:503"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iInduction</span> (<span class="id" title="var">lmem</span>) <span class="id" title="keyword">as</span> [|<span class="id" title="var">la</span> <span class="id" title="var">k</span> <span class="id" title="var">lmem</span>] "IH" <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_empty</span> <span class="id" title="lemma">dom_empty_L</span> <span class="id" title="lemma">elements_empty</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;/= /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> <span class="id" title="lemma">merge_empty</span> <span class="id" title="lemma">big_sepM_empty</span>. <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">dom_insert_L</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">elements</span> (<span class="id" title="notation">{[</span><span class="id" title="var">la</span><span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>) <span class="id" title="notation">≡ₚ</span> <span class="id" title="var">la</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#::list_scope:x_'::'_x"><span class="id" title="notation">::</span></a> <span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="keyword">as</span> <span class="id" title="var">Hperm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <span class="id" title="lemma">elements_union_singleton</span>. <span class="id" title="tactic">apply</span> <span class="id" title="lemma">not_elem_of_dom</span>. <span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.utils.stdpp_extra.html#create_gmap_default_permutation"><span class="id" title="axiom">create_gmap_default_permutation</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dq</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hperm</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hperm</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_merge"><span class="id" title="definition">prod_merge</span></a> -(<span class="id" title="lemma">insert_merge</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="var">dq</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><span class="id" title="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) //.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.utils.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iIntros</span> "Hmem". <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Ha Hmem]";<span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_merge</span> /<a class="idref" href="cap_machine.utils.stdpp_extra.html#prod_op"><span class="id" title="definition">prod_op</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.utils.stdpp_extra.html#create_gmap_default"><span class="id" title="definition">create_gmap_default</span></a> (<span class="id" title="definition">elements</span> (<span class="id" title="definition">dom</span> <span class="id" title="var">lmem</span>)) <span class="id" title="var">dq</span> <span class="id" title="notation">!!</span> <span class="id" title="var">la</span>);<span class="id" title="tactic">auto</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>;<span class="id" title="tactic">auto</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">big_sepM_insert</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>. <span class="id" title="var">iApply</span> "IH". <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;a&nbsp;more&nbsp;general&nbsp;version&nbsp;of&nbsp;load&nbsp;to&nbsp;work&nbsp;also&nbsp;with&nbsp;any&nbsp;fraction&nbsp;and&nbsp;persistent&nbsp;points&nbsp;tos&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM_general" class="idref" href="#gen_mem_valid_inSepM_general"><span class="id" title="lemma">gen_mem_valid_inSepM_general</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:505" class="idref" href="#lmem:505"><span class="id" title="binder">lmem</span></a> : <span class="id" title="record">gmap</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a> (<span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>)) (<a id="lmem':506" class="idref" href="#lmem':506"><span class="id" title="binder">lmem'</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="la:507" class="idref" href="#la:507"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:508" class="idref" href="#lw:508"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>) (<a id="dq:509" class="idref" href="#dq:509"><span class="id" title="binder">dq</span></a> : <span class="id" title="inductive">dfrac</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:505"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:507"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#dq:509"><span class="id" title="variable">dq</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:508"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':506"><span class="id" title="variable">lmem'</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:510" class="idref" href="#a:510"><span class="id" title="binder"><span id="a:511" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="dqw:512" class="idref" href="#dqw:512"><span class="id" title="binder"><span id="dqw:513" class="id">dqw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:505"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:510"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:512"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.1</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#dqw:512"><span class="id" title="variable">dqw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':506"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:507"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:508"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">dq</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_valid_inSepM" class="idref" href="#gen_mem_valid_inSepM"><span class="id" title="lemma">gen_mem_valid_inSepM</span></a>:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">(</span></a><a id="lmem:514" class="idref" href="#lmem:514"><span class="id" title="binder">lmem</span></a> <a id="lm:515" class="idref" href="#lm:515"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:516" class="idref" href="#la:516"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:517" class="idref" href="#lw:517"><span class="id" title="binder">lw</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:514"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:516"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:517"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lm:515"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:518" class="idref" href="#la:518"><span class="id" title="binder"><span id="la:519" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:520" class="idref" href="#lw:520"><span class="id" title="binder"><span id="lw:521" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:514"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:518"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:520"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lm:515"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:516"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:517"><span class="id" title="variable">lw</span></a><span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hmem_pc</span>) "Hm Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#memMap_delete"><span class="id" title="axiom">memMap_delete</span></a> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hpc_a Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hpc_a"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %?; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="gen_mem_update_inSepM" class="idref" href="#gen_mem_update_inSepM"><span class="id" title="lemma">gen_mem_update_inSepM</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">{</span></a><a id="4074d020c543c895fd44425bf00e5b13" class="idref" href="#4074d020c543c895fd44425bf00e5b13"><span class="id" title="binder">Σ</span></a> : <span class="id" title="record">gFunctors</span>} {<a id="gen_heapG0:523" class="idref" href="#gen_heapG0:523"><span class="id" title="binder">gen_heapG0</span></a> : <span class="id" title="class">gen_heapGS</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a> <a class="idref" href="cap_machine.opsem.machine_base.html#Word"><span class="id" title="inductive">Word</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#4074d020c543c895fd44425bf00e5b13"><span class="id" title="variable">Σ</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="lmem:524" class="idref" href="#lmem:524"><span class="id" title="binder">lmem</span></a> <a id="lmem':525" class="idref" href="#lmem':525"><span class="id" title="binder">lmem'</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) (<a id="la:526" class="idref" href="#la:526"><span class="id" title="binder">la</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="lw:527" class="idref" href="#lw:527"><span class="id" title="binder">lw</span></a> <a id="lw':528" class="idref" href="#lw':528"><span class="id" title="binder">lw'</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">),</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':525"><span class="id" title="variable">lmem'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:526"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw':528"><span class="id" title="variable">lw'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem:524"><span class="id" title="variable">lmem</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">-∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:529" class="idref" href="#la:529"><span class="id" title="binder"><span id="la:530" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="lw:531" class="idref" href="#lw:531"><span class="id" title="binder"><span id="lw:532" class="id">lw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lmem':525"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#la:529"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lw:531"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">==∗</span> <span class="id" title="definition">gen_heap_interp</span> (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la:526"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw:527"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="a:533" class="idref" href="#a:533"><span class="id" title="binder"><span id="a:534" class="id">a</span></span></a><span class="id" title="notation">↦</span><a id="w:535" class="idref" href="#w:535"><span class="id" title="binder"><span id="w:536" class="id">w</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.base_logic.html#la:526"><span class="id" title="variable">la</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.base_logic.html#lw:527"><span class="id" title="variable">lw</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem'</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:533"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:535"><span class="id" title="variable">w</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">big_sepM_delete</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span>);[|<span class="id" title="tactic">eauto</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Hh [Hl Hmap]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><span class="id" title="lemma">gen_heap_update</span> <span class="id" title="notation">with</span> "Hh Hl"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hh Hl]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span> "Hh"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">la</span> <span class="id" title="notation">with</span> "[$Hmap $Hl]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">lookup_delete</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_delete_insert</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;-----------------------------------&nbsp;PURE&nbsp;RULES&nbsp;----------------------------------&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_safe</span> := <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">subst</span>; <span class="id" title="tactic">do</span> 3 <span class="id" title="tactic">eexists</span>; <span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_puredet</span> := <span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">intros</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">inv_head_step</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Local Ltac</span> <span class="id" title="var">solve_exec_pure</span> := <span class="id" title="tactic">intros</span> ?; <span class="id" title="tactic">apply</span> <span class="id" title="lemma">nsteps_once</span>, <span class="id" title="lemma">pure_head_step_pure_step</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">constructor</span>; [<span class="id" title="var">solve_exec_safe</span>|]; <span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="projection">head_step</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion</span> <span class="id" title="var">H</span> <span class="id" title="keyword">end</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_failed" class="idref" href="#pure_seq_failed"><span class="id" title="instance">pure_seq_failed</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.opsem.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>)) (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Failed"><span class="id" title="constructor">Failed</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_halted" class="idref" href="#pure_seq_halted"><span class="id" title="instance">pure_seq_halted</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.opsem.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>)) (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Halted"><span class="id" title="constructor">Halted</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Global Instance</span> <a id="pure_seq_done" class="idref" href="#pure_seq_done"><span class="id" title="instance">pure_seq_done</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="class">PureExec</span> <span class="id" title="notation">True</span> 1 (<a class="idref" href="cap_machine.opsem.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a>)) (<a class="idref" href="cap_machine.opsem.cap_lang.html#Seq"><span class="id" title="constructor">Seq</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>)).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">solve_exec_pure</span>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>

<br/>
<span class="comment">(*&nbsp;Used&nbsp;to&nbsp;close&nbsp;the&nbsp;failing&nbsp;cases&nbsp;of&nbsp;the&nbsp;ftlr.<br/>
&nbsp;&nbsp;-&nbsp;Hcont&nbsp;is&nbsp;the&nbsp;(iris)&nbsp;name&nbsp;of&nbsp;the&nbsp;closing&nbsp;hypothesis&nbsp;(usually&nbsp;"Hφ")<br/>
&nbsp;&nbsp;-&nbsp;fail_case_name&nbsp;is&nbsp;one&nbsp;constructor&nbsp;of&nbsp;the&nbsp;spec_name,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;indicating&nbsp;the&nbsp;appropriate&nbsp;error&nbsp;case<br/>
&nbsp;*)</span><br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">econstructor</span>; <span class="id" title="tactic">eauto</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">fail_case_name</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">iFailWP</span> <span class="id" title="var">Hcont</span> <span class="id" title="var">fail_case_name</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="var">cbn</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iApply</span> <span class="id" title="var">Hcont</span>; <span class="id" title="var">iFrame</span>; <span class="id" title="var">iFailCore</span> <span class="id" title="var">fail_case_name</span>).<br/>

<br/>
<span class="comment">(*&nbsp;-----------------&nbsp;useful&nbsp;definitions&nbsp;to&nbsp;factor&nbsp;out&nbsp;the&nbsp;wp&nbsp;specs&nbsp;----------------&nbsp;*)</span><br/>

<br/>
<span class="comment">(*---&nbsp;register&nbsp;equality&nbsp;---*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="addr_ne_reg_ne" class="idref" href="#addr_ne_reg_ne"><span class="id" title="lemma">addr_ne_reg_ne</span></a> {<a id="regs:537" class="idref" href="#regs:537"><span class="id" title="binder">regs</span></a> : <span class="id" title="abbreviation">leibnizO</span> <a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>} {<a id="r1:538" class="idref" href="#r1:538"><span class="id" title="binder">r1</span></a> <a id="r2:539" class="idref" href="#r2:539"><span class="id" title="binder">r2</span></a> : <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{<a id="p0:540" class="idref" href="#p0:540"><span class="id" title="binder">p0</span></a> <a id="b0:541" class="idref" href="#b0:541"><span class="id" title="binder">b0</span></a> <a id="e0:542" class="idref" href="#e0:542"><span class="id" title="binder">e0</span></a> <a id="a0:543" class="idref" href="#a0:543"><span class="id" title="binder">a0</span></a> <a id="p:544" class="idref" href="#p:544"><span class="id" title="binder">p</span></a> <a id="b:545" class="idref" href="#b:545"><span class="id" title="binder">b</span></a> <a id="e:546" class="idref" href="#e:546"><span class="id" title="binder">e</span></a> <a id="a:547" class="idref" href="#a:547"><span class="id" title="binder">a</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:537"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:538"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p0:540"><span class="id" title="variable">p0</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b0:541"><span class="id" title="variable">b0</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e0:542"><span class="id" title="variable">e0</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a0:543"><span class="id" title="variable">a0</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:537"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:539"><span class="id" title="variable">r2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:544"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:545"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:546"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:547"><span class="id" title="variable">a</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a0:543"><span class="id" title="variable">a0</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:547"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r1:538"><span class="id" title="variable">r1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#eac9b9307401b34847f15ea69bb5957f"><span class="id" title="notation">≠</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r2:539"><span class="id" title="variable">r2</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hr1</span> <span class="id" title="var">Hr2</span> <span class="id" title="var">Hne</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="definition">decide</span> (<span class="id" title="var">r1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="var">r2</span>)); <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;regs_of&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of_argument" class="idref" href="#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> (<a id="arg:548" class="idref" href="#arg:548"><span class="id" title="binder">arg</span></a>: <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e03f39daf98516fa530d3f6f5a1b4d92"><span class="id" title="notation">+</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#arg:548"><span class="id" title="variable">arg</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inl"><span class="id" title="constructor">inl</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#inr"><span class="id" title="constructor">inr</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="regs_of" class="idref" href="#regs_of"><span class="id" title="definition">regs_of</span></a> (<a id="i:550" class="idref" href="#i:550"><span class="id" title="binder">i</span></a>: <a class="idref" href="cap_machine.opsem.machine_base.html#instr"><span class="id" title="inductive">instr</span></a>): <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#i:550"><span class="id" title="variable">i</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Lea"><span class="id" title="constructor">Lea</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#GetP"><span class="id" title="constructor">GetP</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#GetB"><span class="id" title="constructor">GetB</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#GetE"><span class="id" title="constructor">GetE</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#GetA"><span class="id" title="constructor">GetA</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#GetOType"><span class="id" title="constructor">GetOType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#GetWType"><span class="id" title="constructor">GetWType</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Add"><span class="id" title="constructor">Add</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Sub"><span class="id" title="constructor">Sub</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Mod"><span class="id" title="constructor">Mod</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Lt"><span class="id" title="constructor">Lt</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#HashConcat"><span class="id" title="constructor">HashConcat</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Hash"><span class="id" title="constructor">Hash</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Mov"><span class="id" title="constructor">Mov</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Restrict"><span class="id" title="constructor">Restrict</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Subseg"><span class="id" title="constructor">Subseg</span></a> <span class="id" title="var">r</span> <span class="id" title="var">arg1</span> <span class="id" title="var">arg2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg1</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg2</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Load"><span class="id" title="constructor">Load</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Store"><span class="id" title="constructor">Store</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">arg</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span> <span class="id" title="notation">]}</span> <span class="id" title="notation">∪</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <span class="id" title="var">arg</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Jnz"><span class="id" title="constructor">Jnz</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span> <span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#Seal"><span class="id" title="constructor">Seal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#UnSeal"><span class="id" title="constructor">UnSeal</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">r1</span><span class="id" title="notation">;</span> <span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#IsUnique"><span class="id" title="constructor">IsUnique</span></a> <span class="id" title="var">dst</span> <span class="id" title="var">src</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">dst</span><span class="id" title="notation">;</span> <span class="id" title="var">src</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#EInit"><span class="id" title="constructor">EInit</span></a> <span class="id" title="var">r1</span> <span class="id" title="var">r2</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">r1</span><span class="id" title="notation">;</span><span class="id" title="var">r2</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#EDeInit"><span class="id" title="constructor">EDeInit</span></a> <span class="id" title="var">r</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">r</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <a class="idref" href="cap_machine.opsem.machine_base.html#EStoreId"><span class="id" title="constructor">EStoreId</span></a> <span class="id" title="var">rs</span> <span class="id" title="var">rd</span> =&gt; <span class="id" title="notation">{[</span><span class="id" title="var">rs</span><span class="id" title="notation">;</span> <span class="id" title="var">rd</span><span class="id" title="notation">]}</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="notation">∅</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_regs_incl" class="idref" href="#indom_regs_incl"><span class="id" title="lemma">indom_regs_incl</span></a> <a id="D:552" class="idref" href="#D:552"><span class="id" title="binder">D</span></a> (<a id="regs:553" class="idref" href="#regs:553"><span class="id" title="binder">regs</span></a> <a id="regs':554" class="idref" href="#regs':554"><span class="id" title="binder">regs'</span></a>: <a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#D:552"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:553"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:553"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':554"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:555" class="idref" href="#r:555"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:555"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#D:552"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:556" class="idref" href="#w:556"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.opsem.machine_base.html#Word"><span class="id" title="inductive">Word</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#regs:553"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:555"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:556"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#regs':554"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:555"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:556"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="indom_lregs_incl" class="idref" href="#indom_lregs_incl"><span class="id" title="lemma">indom_lregs_incl</span></a> <a id="D:557" class="idref" href="#D:557"><span class="id" title="binder">D</span></a> (<a id="lregs:558" class="idref" href="#lregs:558"><span class="id" title="binder">lregs</span></a> <a id="lregs':559" class="idref" href="#lregs':559"><span class="id" title="binder">lregs'</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#D:557"><span class="id" title="variable">D</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:558"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:558"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#lregs':559"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="r:560" class="idref" href="#r:560"><span class="id" title="binder">r</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:560"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#D:557"><span class="id" title="variable">D</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">(</span></a><a id="w:561" class="idref" href="#w:561"><span class="id" title="binder">w</span></a>:<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:558"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:560"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:561"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#lregs':559"><span class="id" title="variable">lregs'</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#r:560"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:561"><span class="id" title="variable">w</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">HD</span> <span class="id" title="var">Hincl</span> <span class="id" title="var">rr</span> <span class="id" title="var">Hr</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="definition">is_Some</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <span class="id" title="var">rr</span>)) <span class="id" title="keyword">as</span> [<span class="id" title="var">w</span> <span class="id" title="var">Hw</span>].<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">eapply</span> @<span class="id" title="method">elem_of_dom</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">D</span> := <span class="id" title="definition">gset</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>). <span class="id" title="var">typeclasses</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">elem_of_subseteq</span>; <span class="id" title="tactic">eauto</span>. }<br/>
&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">w</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementPC" class="idref" href="#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a id="regs:562" class="idref" href="#regs:562"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:562"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_Some_inv" class="idref" href="#incrementPC_Some_inv"><span class="id" title="lemma">incrementPC_Some_inv</span></a> <a id="regs:563" class="idref" href="#regs:563"><span class="id" title="binder">regs</span></a> <a id="regs':564" class="idref" href="#regs':564"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:563"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':564"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:565" class="idref" href="#p:565"><span class="id" title="binder">p</span></a> <a id="b:566" class="idref" href="#b:566"><span class="id" title="binder">b</span></a> <a id="e:567" class="idref" href="#e:567"><span class="id" title="binder">e</span></a> <a id="a:568" class="idref" href="#a:568"><span class="id" title="binder">a</span></a> <a id="a':569" class="idref" href="#a':569"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:563"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:565"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:566"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:567"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:568"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.base_logic.html#a:568"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':569"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs':564"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:565"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:566"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:567"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':569"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] | ];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>. <span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_None_inv" class="idref" href="#incrementPC_None_inv"><span class="id" title="lemma">incrementPC_None_inv</span></a> <a id="regs:570" class="idref" href="#regs:570"><span class="id" title="binder">regs</span></a> <a id="pg:571" class="idref" href="#pg:571"><span class="id" title="binder">pg</span></a> <a id="b:572" class="idref" href="#b:572"><span class="id" title="binder">b</span></a> <a id="e:573" class="idref" href="#e:573"><span class="id" title="binder">e</span></a> <a id="a:574" class="idref" href="#a:574"><span class="id" title="binder">a</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:570"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:570"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#pg:571"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:572"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:573"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:574"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.base_logic.html#a:574"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> | ] | ] |];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_mono" class="idref" href="#incrementPC_overflow_mono"><span class="id" title="lemma">incrementPC_overflow_mono</span></a> <a id="regs:575" class="idref" href="#regs:575"><span class="id" title="binder">regs</span></a> <a id="regs':576" class="idref" href="#regs':576"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:575"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:575"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:575"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':576"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':576"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">HPC</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">c</span> <span class="id" title="var">HPC</span>].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">HPC'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">HPC</span> <span class="id" title="var">HPC'</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span> |- *. <span class="id" title="tactic">destruct</span> <span class="id" title="var">c</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">aa</span> | ] | ]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">aa</span><a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_overflow_antimono" class="idref" href="#incrementPC_overflow_antimono"><span class="id" title="lemma">incrementPC_overflow_antimono</span></a> <a id="regs:577" class="idref" href="#regs:577"><span class="id" title="binder">regs</span></a> <a id="regs':578" class="idref" href="#regs':578"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:577"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs':578"><span class="id" title="variable">regs'</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:577"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':578"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hi</span> <span class="id" title="var">Hincl</span>. <span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="tactic">in</span> *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs'</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="var">eqn</span>:<span class="id" title="var">HrpPC</span>; <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HrpPC</span> <span class="id" title="var">Hincl</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">Hi</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*&nbsp;todo:&nbsp;instead,&nbsp;define&nbsp;updatePC&nbsp;on&nbsp;top&nbsp;of&nbsp;incrementPC&nbsp;*)</span><br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_fail_updatePC" class="idref" href="#incrementPC_fail_updatePC"><span class="id" title="lemma">incrementPC_fail_updatePC</span></a> <a id="regs:579" class="idref" href="#regs:579"><span class="id" title="binder">regs</span></a> <a id="m:580" class="idref" href="#m:580"><span class="id" title="binder">m</span></a> <a id="etbl:581" class="idref" href="#etbl:581"><span class="id" title="binder">etbl</span></a> <a id="ecur:582" class="idref" href="#ecur:582"><span class="id" title="binder">ecur</span></a>:<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:579"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:579"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m:580"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl:581"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur:582"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span> | ] |]; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">auto</span>. <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementPC_success_updatePC" class="idref" href="#incrementPC_success_updatePC"><span class="id" title="lemma">incrementPC_success_updatePC</span></a> <a id="regs:583" class="idref" href="#regs:583"><span class="id" title="binder">regs</span></a> <a id="m:584" class="idref" href="#m:584"><span class="id" title="binder">m</span></a> <a id="etbl:585" class="idref" href="#etbl:585"><span class="id" title="binder">etbl</span></a> <a id="ecur:586" class="idref" href="#ecur:586"><span class="id" title="binder">ecur</span></a> <a id="regs':587" class="idref" href="#regs':587"><span class="id" title="binder">regs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:583"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':587"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="p:588" class="idref" href="#p:588"><span class="id" title="binder">p</span></a> <a id="b:589" class="idref" href="#b:589"><span class="id" title="binder">b</span></a> <a id="e:590" class="idref" href="#e:590"><span class="id" title="binder">e</span></a> <a id="a:591" class="idref" href="#a:591"><span class="id" title="binder">a</span></a> <a id="a':592" class="idref" href="#a':592"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:583"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:588"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:589"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:590"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:591"><span class="id" title="variable">a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.base_logic.html#a:591"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':592"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:583"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m:584"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl:585"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur:586"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.opsem.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:588"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:589"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:590"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':592"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m:584"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl:585"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur:586"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs':587"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:588"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:589"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:590"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':592"><span class="id" title="variable">a'</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> /<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [<span class="id" title="var">X</span>|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">X</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a'</span>|]|] <span class="id" title="var">eqn</span>:?; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>; [].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a'</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:?; [| <span class="id" title="tactic">congruence</span>]. <span class="id" title="tactic">inversion</span> 1; <span class="id" title="tactic">subst</span> <span class="id" title="var">regs'</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 5 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">split</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_success_incl" class="idref" href="#updatePC_success_incl"><span class="id" title="lemma">updatePC_success_incl</span></a> <a id="m:593" class="idref" href="#m:593"><span class="id" title="binder">m</span></a> <a id="m':594" class="idref" href="#m':594"><span class="id" title="binder">m'</span></a> <a id="regs:595" class="idref" href="#regs:595"><span class="id" title="binder">regs</span></a> <a id="regs':596" class="idref" href="#regs':596"><span class="id" title="binder">regs'</span></a> <a id="etbl:597" class="idref" href="#etbl:597"><span class="id" title="binder">etbl</span></a> <a id="etbl':598" class="idref" href="#etbl':598"><span class="id" title="binder">etbl'</span></a> <a id="ecur:599" class="idref" href="#ecur:599"><span class="id" title="binder">ecur</span></a> <a id="ecur':600" class="idref" href="#ecur':600"><span class="id" title="binder">ecur'</span></a> <a id="w:601" class="idref" href="#w:601"><span class="id" title="binder">w</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:595"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':596"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:595"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m:593"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl:597"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur:599"><span class="id" title="variable">ecur</span></a> |}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.opsem.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:601"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m:593"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl:597"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur:599"><span class="id" title="variable">ecur</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':596"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m':594"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl':598"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur':600"><span class="id" title="variable">ecur'</span></a> |}<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.opsem.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">{|</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#w:601"><span class="id" title="variable">w</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs'</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m':594"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl':598"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur':600"><span class="id" title="variable">ecur'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">|})</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> * <span class="id" title="var">Hincl</span> <span class="id" title="var">Hu</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">regs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ <span class="id" title="var">w1</span> |] <span class="id" title="var">eqn</span>:<span class="id" title="var">Hrr</span>.<br/>
&nbsp;&nbsp;{ <span class="id" title="tactic">pose</span> <span class="id" title="var">proof</span> (<span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hrr</span> <span class="id" title="var">Hincl</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hregs'</span>. <span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hregs'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w1</span> <span class="id" title="keyword">as</span> [|[ ? ? ? <span class="id" title="var">a1</span>|] | ]; <span class="id" title="var">simplify_eq</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="var">eqn</span>:<span class="id" title="var">Ha1</span>; <span class="id" title="var">simplify_eq</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">f_equal</span>. <span class="id" title="tactic">f_equal</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HH</span>: <span class="id" title="notation">forall</span> <span class="id" title="notation">(</span><a id="reg1:602" class="idref" href="#reg1:602"><span class="id" title="binder"><span id="reg1:604" class="id">reg1</span></span></a> <a id="reg2:603" class="idref" href="#reg2:603"><span class="id" title="binder"><span id="reg2:605" class="id">reg2</span></span></a>:<a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#reg1:602"><span class="id" title="variable">reg1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#reg2:603"><span class="id" title="variable">reg2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#reg1:602"><span class="id" title="variable">reg1</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#reg2:603"><span class="id" title="variable">reg2</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> (<span class="id" title="tactic">intros</span> * -&gt;; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hu</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">injection</span> <span class="id" title="var">Hu</span>; <span class="id" title="tactic">intros</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">HH</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">rewrite</span> !<span class="id" title="lemma">lookup_insert</span> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">simplify_eq</span>. }<br/>
&nbsp;&nbsp;{  <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hu</span>. }<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_fail_incl" class="idref" href="#updatePC_fail_incl"><span class="id" title="lemma">updatePC_fail_incl</span></a> <a id="m:606" class="idref" href="#m:606"><span class="id" title="binder">m</span></a> <a id="m':607" class="idref" href="#m':607"><span class="id" title="binder">m'</span></a> <a id="regs:608" class="idref" href="#regs:608"><span class="id" title="binder">regs</span></a> <a id="regs':609" class="idref" href="#regs':609"><span class="id" title="binder">regs'</span></a> <a id="etbl:610" class="idref" href="#etbl:610"><span class="id" title="binder">etbl</span></a> <a id="etbl':611" class="idref" href="#etbl':611"><span class="id" title="binder">etbl'</span></a> <a id="ecur:612" class="idref" href="#ecur:612"><span class="id" title="binder">ecur</span></a> <a id="ecur':613" class="idref" href="#ecur':613"><span class="id" title="binder">ecur'</span></a>  :<br/>
&nbsp;&nbsp;<span class="id" title="definition">is_Some</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:608"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs:608"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':609"><span class="id" title="variable">regs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:608"><span class="id" title="variable">regs</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m:606"><span class="id" title="variable">m</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl:610"><span class="id" title="variable">etbl</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur:612"><span class="id" title="variable">ecur</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#regs':609"><span class="id" title="variable">regs'</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#m':607"><span class="id" title="variable">m'</span></a>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#etbl':611"><span class="id" title="variable">etbl'</span></a> ; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <a class="idref" href="cap_machine.program_logic.base_logic.html#ecur':613"><span class="id" title="variable">ecur'</span></a> |} <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> [<span class="id" title="var">w</span> <span class="id" title="var">HPC</span>] <span class="id" title="var">Hincl</span> <span class="id" title="var">Hfail</span>. <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> /= <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span> |- *.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> !<span class="id" title="var">HPC</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hfail</span>. <span class="id" title="var">have</span> -&gt; := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">HPC</span> <span class="id" title="var">Hincl</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [| [? ? ? <span class="id" title="var">a1</span> | ] |]; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>;[].<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a1</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">simplify_eq</span>; <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC_Some_inv"><span class="id" title="axiom">incrementPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC_None_inv"><span class="id" title="axiom">incrementPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="updatePC_incrementPC" class="idref" href="#updatePC_incrementPC"><span class="id" title="lemma">updatePC_incrementPC</span></a> {<a id="4d5de3e33d1160497bd83a426d43d960" class="idref" href="#4d5de3e33d1160497bd83a426d43d960"><span class="id" title="binder">φ</span></a>} :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#4d5de3e33d1160497bd83a426d43d960"><span class="id" title="variable">φ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a id="r':615" class="idref" href="#r':615"><span class="id" title="binder">r'</span></a> <span class="id" title="notation">←</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#4d5de3e33d1160497bd83a426d43d960"><span class="id" title="variable">φ</span></a>) <span class="id" title="notation">;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.opsem.cap_lang.html#NextI"><span class="id" title="constructor">NextI</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#4d5de3e33d1160497bd83a426d43d960"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#r':615"><span class="id" title="variable">r'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#updatePC"><span class="id" title="definition">updatePC</span></a>, <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a>, <a class="idref" href="cap_machine.opsem.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="comment">(*---&nbsp;incrementLPC&nbsp;---*)</span><br/>

<br/>
<span class="id" title="keyword">Definition</span> <a id="incrementLPC" class="idref" href="#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> (<a id="regs:616" class="idref" href="#regs:616"><span class="id" title="binder">regs</span></a>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#regs:616"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">a</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">a'</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a'</span> <span class="id" title="var">v</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_Some_inv" class="idref" href="#incrementLPC_Some_inv"><span class="id" title="lemma">incrementLPC_Some_inv</span></a> <a id="lregs:617" class="idref" href="#lregs:617"><span class="id" title="binder">lregs</span></a> <a id="lregs':618" class="idref" href="#lregs':618"><span class="id" title="binder">lregs'</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:617"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lregs':618"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="p:619" class="idref" href="#p:619"><span class="id" title="binder">p</span></a> <a id="b:620" class="idref" href="#b:620"><span class="id" title="binder">b</span></a> <a id="e:621" class="idref" href="#e:621"><span class="id" title="binder">e</span></a> <a id="a:622" class="idref" href="#a:622"><span class="id" title="binder">a</span></a> <a id="v:623" class="idref" href="#v:623"><span class="id" title="binder">v</span></a> <a id="a':624" class="idref" href="#a':624"><span class="id" title="binder">a'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:617"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:619"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:620"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:621"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:622"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:623"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.base_logic.html#a:622"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':624"><span class="id" title="variable">a'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#3668992ecc3e95973d304a75a28051a2"><span class="id" title="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lregs':618"><span class="id" title="variable">lregs'</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#p:619"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:620"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:621"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a':624"><span class="id" title="variable">a'</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:623"><span class="id" title="variable">v</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] | ]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span> ? ?. <span class="id" title="tactic">inversion</span> 1.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">do</span> 6 <span class="id" title="tactic">eexists</span>. <span class="id" title="tactic">split</span>; <span class="id" title="tactic">eauto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <a id="incrementLPC_None_inv" class="idref" href="#incrementLPC_None_inv"><span class="id" title="lemma">incrementLPC_None_inv</span></a> <a id="lregs:625" class="idref" href="#lregs:625"><span class="id" title="binder">lregs</span></a> <a id="pg:626" class="idref" href="#pg:626"><span class="id" title="binder">pg</span></a> <a id="b:627" class="idref" href="#b:627"><span class="id" title="binder">b</span></a> <a id="e:628" class="idref" href="#e:628"><span class="id" title="binder">e</span></a> <a id="a:629" class="idref" href="#a:629"><span class="id" title="binder">a</span></a> <a id="v:630" class="idref" href="#v:630"><span class="id" title="binder">v</span></a> :<br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:625"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#lregs:625"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#pg:626"><span class="id" title="variable">pg</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#b:627"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e:628"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#a:629"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#v:630"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.base_logic.html#a:629"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>.<br/>
<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">lregs</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a>) <span class="id" title="keyword">as</span> [ [ | [? ? ? <span class="id" title="var">u</span> ? | ] | ] |]; <span class="id" title="tactic">try</span> <span class="id" title="tactic">congruence</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">case_eq</span> (<span class="id" title="var">u</span><a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a>1)%<span class="id" title="var">a</span>; <span class="id" title="tactic">congruence</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">incrementLPC_inv</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> (?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?&amp;?)<br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "incrementLPC_inv" "as" <span class="id" title="var">simple_intropattern</span>(<span class="id" title="var">pat</span>):=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC_Some_inv"><span class="id" title="axiom">incrementLPC_Some_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span> <span class="id" title="keyword">as</span> <span class="id" title="var">pat</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <span class="id" title="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC_None_inv"><span class="id" title="axiom">incrementLPC_None_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">H</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>; <span class="id" title="var">simplify_eq</span>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
