<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">

<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<link href="coqdoc.css" rel="stylesheet" type="text/css" />
<link href="coqdocjs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="config.js"></script>
<script type="text/javascript" src="coqdocjs.js"></script>
</head>

<body onload="document.getElementById('content').focus()">
  <div id="header">
    <span class="left">
      <span class="modulename"> <script> document.write(document.title) </script> </span>
    </span>

    <span class="button" id="toggle-proofs"></span>

    <span class="right">
      <a href="./">Project Page</a>
      <a href="./indexpage.html"> Index </a>
      <a href="./toc.html"> Table of Contents </a>
    </span>
</div>
    <div id="content" tabindex="-1" onblur="document.getElementById('content').focus()">
    <div id="main">
<h1 class="libtitle">cap_machine.program_logic.rules_base</h1>

<div class="code">
<span class="id" title="keyword">From</span> <span class="id" title="var">Coq</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.micromega.Lia.html#"><span class="id" title="library">Lia</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">machine_utils</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="machine_utils.solve_finz.html#"><span class="id" title="library">solve_finz</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.proofmode</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">proofmode</span> <span class="id" title="library">classes</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.base_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">invariants</span> <span class="id" title="library">gen_heap</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.program_logic</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="library">weakestpre</span> <span class="id" title="library">ectx_lifting</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">frac</span> <span class="id" title="library">auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">iris.algebra.lib</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="library">excl_auth</span>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#"><span class="id" title="library">logical_mapsto</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#"><span class="id" title="library">cap_lang</span></a> <a class="idref" href="cap_machine.utils.iris_extra.html#"><span class="id" title="library">iris_extra</span></a> <a class="idref" href="cap_machine.utils.stdpp_extra.html#"><span class="id" title="library">stdpp_extra</span></a>.<br/>
<span class="id" title="keyword">From</span> <span class="id" title="var">cap_machine</span> <span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#"><span class="id" title="library">wp_opt</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#"><span class="id" title="library">base_logic</span></a>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <a id="cap_lang_rules" class="idref" href="#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="ceriseg:2" class="idref" href="#ceriseg:2"><span class="id" title="binder">ceriseg</span></a>: <a class="idref" href="cap_machine.program_logic.base_logic.html#ceriseG"><span class="id" title="class">ceriseG</span></a> <a id="0101b9beac487b383a5ba2a8f6922788" class="idref" href="#0101b9beac487b383a5ba2a8f6922788"><span class="id" title="binder">Σ</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{ <a id="reservedaddresses:3" class="idref" href="#reservedaddresses:3"><span class="id" title="binder">reservedaddresses</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#ReservedAddresses"><span class="id" title="class">ReservedAddresses</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Context</span> `{<a id="MP:4" class="idref" href="#MP:4"><span class="id" title="binder">MP</span></a>: <a class="idref" href="cap_machine.opsem.machine_parameters.html#MachineParameters"><span class="id" title="class">MachineParameters</span></a>}.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">P</span> <span class="id" title="var">Q</span> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> σ : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">c</span> : <a class="idref" href="cap_machine.opsem.cap_lang.html#expr"><span class="id" title="inductive">cap_lang.expr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">r</span> : <a class="idref" href="cap_machine.opsem.addr_reg.html#RegName"><span class="id" title="inductive">RegName</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">v</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#Version"><span class="id" title="definition">Version</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">la</span>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lw</span>: <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">reg</span> : <a class="idref" href="cap_machine.opsem.machine_base.html#Reg"><span class="id" title="definition">Reg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lregs</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">mem</span> : <a class="idref" href="cap_machine.opsem.machine_base.html#Mem"><span class="id" title="definition">Mem</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">lmem</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_cap_lang" class="idref" href="#wp_cap_lang"><span class="id" title="lemma">wp_cap_lang</span></a> {<a id="s:5" class="idref" href="#s:5"><span class="id" title="binder">s</span></a> <a id="E:6" class="idref" href="#E:6"><span class="id" title="binder">E</span></a>} {<a id="7b04da1024d41fee943ffacd3fa7173a" class="idref" href="#7b04da1024d41fee943ffacd3fa7173a"><span class="id" title="binder">Φ</span></a>} : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">∀</span></a> <a id="e1:8" class="idref" href="#e1:8"><span class="id" title="binder">e1</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#e15f3fa8414cf45e36c73a91b3f5f2c2"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:8"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="d17e606cab562cf96214f669d52553c3" class="idref" href="#d17e606cab562cf96214f669d52553c3"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#d17e606cab562cf96214f669d52553c3"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:6"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><span class="id" title="definition">head_reducible</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:8"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#d17e606cab562cf96214f669d52553c3"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:10" class="idref" href="#e2:10"><span class="id" title="binder">e2</span></a> : <span class="id" title="projection">language.expr</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="b07c46a51830fcca381b53c5b22fd0d6" class="idref" href="#b07c46a51830fcca381b53c5b22fd0d6"><span class="id" title="binder">σ2</span></a> : <span class="id" title="projection">ectx_language.state</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.opsem.cap_lang.html#prim_step"><span class="id" title="inductive">prim_step</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:8"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#d17e606cab562cf96214f669d52553c3"><span class="id" title="variable">σ1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e2:10"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b07c46a51830fcca381b53c5b22fd0d6"><span class="id" title="variable">σ2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#ae9a5e1034e143b218b09d8e454472bd"><span class="id" title="notation">[]</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:6"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b07c46a51830fcca381b53c5b22fd0d6"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#7b04da1024d41fee943ffacd3fa7173a"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#e2:10"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#s:5"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#E:6"><span class="id" title="variable">E</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:8"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#7b04da1024d41fee943ffacd3fa7173a"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (? <span class="id" title="var">Hnoval</span>) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">assumption</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>) "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="notation">with</span> "[$Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[%Hred H]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iIntros</span> (? ? ?) "%Hstep Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#prim_step_no_efs"><span class="id" title="axiom">prim_step_no_efs</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.program_logic.base_logic.html#prim_step_no_kappa"><span class="id" title="axiom">prim_step_no_kappa</span></a> <span class="id" title="var">Hstep</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span> <span class="id" title="notation">with</span> "Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec" class="idref" href="#wp_instr_exec"><span class="id" title="lemma">wp_instr_exec</span></a> {<a id="s:12" class="idref" href="#s:12"><span class="id" title="binder">s</span></a> <a id="E:13" class="idref" href="#E:13"><span class="id" title="binder">E</span></a>} {<a id="3113a0c09db68ed6481f1bb96933c3de" class="idref" href="#3113a0c09db68ed6481f1bb96933c3de"><span class="id" title="binder">Φ</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="936572658a9ed83c5bf72ea9b9ad8d91" class="idref" href="#936572658a9ed83c5bf72ea9b9ad8d91"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#936572658a9ed83c5bf72ea9b9ad8d91"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:13"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="e2:16" class="idref" href="#e2:16"><span class="id" title="binder">e2</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#ConfFlag"><span class="id" title="inductive">ConfFlag</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a id="1d4ed66af5e6ad61f160673a374ce61f" class="idref" href="#1d4ed66af5e6ad61f160673a374ce61f"><span class="id" title="binder">σ2</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.opsem.cap_lang.html#step"><span class="id" title="inductive">step</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.opsem.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#936572658a9ed83c5bf72ea9b9ad8d91"><span class="id" title="variable">σ1</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#e2:16"><span class="id" title="variable">e2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#1d4ed66af5e6ad61f160673a374ce61f"><span class="id" title="variable">σ2</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:13"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#1d4ed66af5e6ad61f160673a374ce61f"><span class="id" title="variable">σ2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#3113a0c09db68ed6481f1bb96933c3de"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e2:16"><span class="id" title="variable">e2</span></a>))<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#s:12"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#E:13"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#3113a0c09db68ed6481f1bb96933c3de"><span class="id" title="variable">Φ</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#wp_cap_lang"><span class="id" title="axiom">wp_cap_lang</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">with</span> "Hσ1"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#normal_always_head_reducible"><span class="id" title="axiom">normal_always_head_reducible</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2) "%Hstep".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#prim_step_exec_inv"><span class="id" title="lemma">prim_step_exec_inv</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hstep</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">_</span> &amp; <span class="id" title="var">_</span> &amp; <span class="id" title="var">c</span> &amp; -&gt; &amp; <span class="id" title="var">Hstep2</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "H".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_lift_atomic_head_step_no_fork_determ" class="idref" href="#wp_lift_atomic_head_step_no_fork_determ"><span class="id" title="lemma">wp_lift_atomic_head_step_no_fork_determ</span></a> {<a id="s:18" class="idref" href="#s:18"><span class="id" title="binder">s</span></a> <a id="E:19" class="idref" href="#E:19"><span class="id" title="binder">E</span></a> <a id="285a825432ce9655d75e70d7f57d697e" class="idref" href="#285a825432ce9655d75e70d7f57d697e"><span class="id" title="binder">Φ</span></a>} <a id="e1:21" class="idref" href="#e1:21"><span class="id" title="binder">e1</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:21"><span class="id" title="variable">e1</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="448d14cc20ee92631a9e19c06c3262b0" class="idref" href="#448d14cc20ee92631a9e19c06c3262b0"><span class="id" title="binder">σ1</span></a>:<a class="idref" href="cap_machine.opsem.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="ns:23" class="idref" href="#ns:23"><span class="id" title="binder">ns</span></a> <a id="4b9f9ac5f1299e7c470f32a6c1ad8c02" class="idref" href="#4b9f9ac5f1299e7c470f32a6c1ad8c02"><span class="id" title="binder">κ</span></a> <a id="4996adadd1b5aff91ef811e216587569" class="idref" href="#4996adadd1b5aff91ef811e216587569"><span class="id" title="binder">κs</span></a> <a id="nt:26" class="idref" href="#nt:26"><span class="id" title="binder">nt</span></a><span class="id" title="notation">,</span> <span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#448d14cc20ee92631a9e19c06c3262b0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ns:23"><span class="id" title="variable">ns</span></a> (<a class="idref" href="cap_machine.program_logic.rules_base.html#4b9f9ac5f1299e7c470f32a6c1ad8c02"><span class="id" title="variable">κ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#bc347c51eaf667706ae54503b26d52c6"><span class="id" title="notation">++</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4996adadd1b5aff91ef811e216587569"><span class="id" title="variable">κs</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#nt:26"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:19"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∃</span> <a id="78da61e7130f1203cd553f9397af5c8d" class="idref" href="#78da61e7130f1203cd553f9397af5c8d"><span class="id" title="binder">κ</span></a> <a id="e2:28" class="idref" href="#e2:28"><span class="id" title="binder">e2</span></a> (<a id="b545308a1e58e795cda786b0668ad140" class="idref" href="#b545308a1e58e795cda786b0668ad140"><span class="id" title="binder">σ2</span></a>:<a class="idref" href="cap_machine.opsem.cap_lang.html#state"><span class="id" title="definition">cap_lang.state</span></a>) <a id="efs:30" class="idref" href="#efs:30"><span class="id" title="binder">efs</span></a><span class="id" title="notation">,</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.opsem.cap_lang.html#prim_step"><span class="id" title="inductive">cap_lang.prim_step</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:21"><span class="id" title="variable">e1</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#448d14cc20ee92631a9e19c06c3262b0"><span class="id" title="variable">σ1</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#78da61e7130f1203cd553f9397af5c8d"><span class="id" title="variable">κ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e2:28"><span class="id" title="variable">e2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b545308a1e58e795cda786b0668ad140"><span class="id" title="variable">σ2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#efs:30"><span class="id" title="variable">efs</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">|==&gt;</span> <span class="id" title="notation">(</span><span class="id" title="method">state_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#b545308a1e58e795cda786b0668ad140"><span class="id" title="variable">σ2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ns:23"><span class="id" title="variable">ns</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#4996adadd1b5aff91ef811e216587569"><span class="id" title="variable">κs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#nt:26"><span class="id" title="variable">nt</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#285a825432ce9655d75e70d7f57d697e"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#to_val"><span class="id" title="definition">to_val</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e2:28"><span class="id" title="variable">e2</span></a>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">WP</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#e1:21"><span class="id" title="variable">e1</span></a> <span class="id" title="notation">@</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#s:18"><span class="id" title="variable">s</span></a><span class="id" title="notation">;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#E:19"><span class="id" title="variable">E</span></a> <span class="id" title="notation">{{</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#285a825432ce9655d75e70d7f57d697e"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">}}</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (?) "H". <span class="id" title="var">iApply</span> <span class="id" title="lemma">wp_lift_atomic_head_step_no_fork</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span>)  "Hσ1 /=".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> σ1 <span class="id" title="var">ns</span> <span class="id" title="var">κ</span> <span class="id" title="var">κs</span> <span class="id" title="var">nt</span> <span class="id" title="notation">with</span> "[Hσ1]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H"; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> (<span class="id" title="var">κ'</span> <span class="id" title="var">e2</span> σ2 <span class="id" title="var">efs</span>) "[H1 H2]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iSplit</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<span class="id" title="definition">head_reducible</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">κ'</span>, <span class="id" title="var">e2</span>, σ2, <span class="id" title="var">efs</span>. <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iNext</span>. <span class="id" title="var">iIntros</span> (? ? ?) "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H1" <span class="id" title="keyword">as</span> %<span class="id" title="var">Hs2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#cap_lang_determ"><span class="id" title="axiom">cap_lang_determ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hs1</span> <span class="id" title="var">Hs2</span>) <span class="id" title="keyword">as</span> [<span class="id" title="var">Heq1</span> [<span class="id" title="var">Heq2</span> [<span class="id" title="var">Heq3</span> <span class="id" title="var">Heq4</span>]]].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">subst</span>. <span class="id" title="var">iMod</span> "H2". <span class="id" title="var">iIntros</span> "_".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>. <span class="id" title="var">inv</span> <span class="id" title="var">Hs1</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp_instr_exec_opt" class="idref" href="#wp_instr_exec_opt"><span class="id" title="lemma">wp_instr_exec_opt</span></a> {<a id="s:31" class="idref" href="#s:31"><span class="id" title="binder">s</span></a> <a id="E:32" class="idref" href="#E:32"><span class="id" title="binder">E</span></a> <a id="3d0db6eb58d9d9f901ac0308b2414dfe" class="idref" href="#3d0db6eb58d9d9f901ac0308b2414dfe"><span class="id" title="binder">Φ</span></a> <a id="pc_a:34" class="idref" href="#pc_a:34"><span class="id" title="binder">pc_a</span></a> <a id="pc_v:35" class="idref" href="#pc_v:35"><span class="id" title="binder">pc_v</span></a> <a id="dq:36" class="idref" href="#dq:36"><span class="id" title="binder">dq</span></a> <a id="regs:37" class="idref" href="#regs:37"><span class="id" title="binder">regs</span></a> <a id="lw:38" class="idref" href="#lw:38"><span class="id" title="binder">lw</span></a> <a id="pc_p:39" class="idref" href="#pc_p:39"><span class="id" title="binder">pc_p</span></a> <a id="pc_b:40" class="idref" href="#pc_b:40"><span class="id" title="binder">pc_b</span></a> <a id="pc_e:41" class="idref" href="#pc_e:41"><span class="id" title="binder">pc_e</span></a> <a id="instr:42" class="idref" href="#instr:42"><span class="id" title="binder">instr</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#isCorrectLPC"><span class="id" title="inductive">isCorrectLPC</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_p:39"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_b:40"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_e:41"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_v:35"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#regs:37"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_p:39"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_b:40"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_e:41"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_v:35"><span class="id" title="variable">pc_v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#decodeInstrWL"><span class="id" title="definition">decodeInstrWL</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:38"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#instr:42"><span class="id" title="variable">instr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of"><span class="id" title="definition">regs_of</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#instr:42"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:37"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">→</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">(</span></a><span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_v:35"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dq:36"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:38"><span class="id" title="variable">lw</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">▷</span> <span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:43" class="idref" href="#k:43"><span class="id" title="binder"><span id="k:44" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:45" class="idref" href="#y:45"><span class="id" title="binder"><span id="y:46" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:37"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:43"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:45"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">▷</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <span class="id" title="notation">(</span><a id="a7f6edaeabb2d16fd2eceb903859a5de" class="idref" href="#a7f6edaeabb2d16fd2eceb903859a5de"><span class="id" title="binder">σ1</span></a> : <span class="id" title="projection">language.state</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#cap_ectx_lang"><span class="id" title="definition">cap_ectx_lang</span></a><span class="id" title="notation">),</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a7f6edaeabb2d16fd2eceb903859a5de"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:48" class="idref" href="#k:48"><span class="id" title="binder"><span id="k:49" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:50" class="idref" href="#y:50"><span class="id" title="binder"><span id="y:51" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:37"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:48"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:50"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_v:35"><span class="id" title="variable">pc_v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dq:36"><span class="id" title="variable">dq</span></a><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:38"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:32"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="wa:52" class="idref" href="#wa:52"><span class="id" title="binder">wa</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a7f6edaeabb2d16fd2eceb903859a5de"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_p:39"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_b:40"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_e:41"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a7f6edaeabb2d16fd2eceb903859a5de"><span class="id" title="variable">σ1</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#wa:52"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.machine_base.html#isCorrectPC"><span class="id" title="inductive">isCorrectPC</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WCap"><span class="id" title="abbreviation">WCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_p:39"><span class="id" title="variable">pc_p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_b:40"><span class="id" title="variable">pc_b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_e:41"><span class="id" title="variable">pc_e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#pc_a:34"><span class="id" title="variable">pc_a</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.machine_parameters.html#decodeInstrW"><span class="id" title="definition">decodeInstrW</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#wa:52"><span class="id" title="variable">wa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#instr:42"><span class="id" title="variable">instr</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">-∗</span> <span class="id" title="notation">£</span> 1 <span class="id" title="notation">={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:32"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt"><span class="id" title="definition">wp_opt</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#instr:42"><span class="id" title="variable">instr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a7f6edaeabb2d16fd2eceb903859a5de"><span class="id" title="variable">σ1</span></a>) (<span class="id" title="notation">|={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:32"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a7f6edaeabb2d16fd2eceb903859a5de"><span class="id" title="variable">σ1</span></a> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#3d0db6eb58d9d9f901ac0308b2414dfe"><span class="id" title="variable">Φ</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#FailedV"><span class="id" title="constructor">FailedV</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> (<a id="c2:53" class="idref" href="#c2:53"><span class="id" title="binder">c2</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#Conf"><span class="id" title="definition">Conf</span></a>) =&gt; <span class="id" title="notation">|={</span><a class="idref" href="cap_machine.program_logic.rules_base.html#E:32"><span class="id" title="variable">E</span></a><span class="id" title="notation">}=&gt;</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c2:53"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.2</span> <span class="id" title="notation">∗</span> <span class="id" title="definition">from_option</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#3d0db6eb58d9d9f901ac0308b2414dfe"><span class="id" title="variable">Φ</span></a> <span class="id" title="notation">False</span> (<span class="id" title="projection">language.to_val</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c2:53"><span class="id" title="variable">c2</span></a><span class="id" title="notation">.1</span>))<span class="id" title="notation">)</span>)<span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="definition">wp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#s:31"><span class="id" title="variable">s</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#E:32"><span class="id" title="variable">E</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#Instr"><span class="id" title="constructor">Instr</span></a> <a class="idref" href="cap_machine.opsem.cap_lang.html#Executable"><span class="id" title="constructor">Executable</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#3d0db6eb58d9d9f901ac0308b2414dfe"><span class="id" title="variable">Φ</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#c41c566ddac4c1298b9e7dd2bae1c794"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcorrpc</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hdecode</span> <span class="id" title="var">Hregs_incl</span>) "(&gt;Hcode &amp; &gt;Hregs &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#isCorrectLPC_isCorrectPC_iff"><span class="id" title="axiom">isCorrectLPC_isCorrectPC_iff</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hcorrpc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#wp_instr_exec"><span class="id" title="axiom">wp_instr_exec</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (σ1) "Hσ1".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> σ1; <span class="id" title="tactic">simpl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ1" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregsincl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">have</span> <span class="id" title="var">Hregs_pc</span> := <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hregspc</span> <span class="id" title="var">Hregsincl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span>@<span class="id" title="lemma">gen_heap_valid</span> <span class="id" title="notation">with</span> "Hm Hcode"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> %<span class="id" title="var">Hlcode</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">e2</span> σ2 <span class="id" title="var">Hstep</span>) "Hcred".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">{|</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> <span class="id" title="notation">|}</span> <span class="id" title="notation">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[Hr Hm Htbl_cur Htbl_prev Htbl_all $HEC $Hregs $Hcode]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iExists</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span>, <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;allow&nbsp;changing&nbsp;cur_map?&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#step_exec_inv"><span class="id" title="axiom">step_exec_inv</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word_cap"><span class="id" title="axiom">state_corresponds_reg_get_word_cap</span></a> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_mem_correct_PC"><span class="id" title="axiom">state_corresponds_mem_correct_PC</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> ; <span class="id" title="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span>"H" <span class="id" title="notation">$!</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <span class="id" title="var">lw</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "[%] Hcred"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">intuition</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">pc_p</span> <span class="id" title="var">pc_b</span> <span class="id" title="var">pc_e</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span>) <span class="id" title="var">HLinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">pc_a</span> <span class="id" title="var">pc_v</span> <span class="id" title="var">lw</span> <span class="id" title="var">HLinv</span> )<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; [ <span class="id" title="tactic">apply</span> <span class="id" title="var">HLinv</span> | | | | <span class="id" title="tactic">apply</span> <span class="id" title="var">Hregs_pc</span> | ]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.opsem.machine_base.html#isCorrectPC_withinBounds"><span class="id" title="axiom">isCorrectPC_withinBounds</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorrpc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">unfold</span> <a class="idref" href="cap_machine.opsem.cap_lang.html#exec"><span class="id" title="definition">exec</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#exec_opt"><span class="id" title="definition">exec_opt</span></a> <span class="id" title="var">instr</span> {| <a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> := <span class="id" title="var">reg</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> := <span class="id" title="var">mem</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#etable"><span class="id" title="projection">etable</span></a> := <span class="id" title="var">etable</span>; <a class="idref" href="cap_machine.opsem.cap_lang.html#enumcur"><span class="id" title="projection">enumcur</span></a> := <span class="id" title="var">enumcur</span> |});<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">inversion</span> <span class="id" title="var">Hstep</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_with_res" class="idref" href="#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> (<a id="dfcc0d5a9bf6f8db0f14cad9a12c5f9d" class="idref" href="#dfcc0d5a9bf6f8db0f14cad9a12c5f9d"><span class="id" title="binder">φ</span></a><a id="dfcc0d5a9bf6f8db0f14cad9a12c5f9d" class="idref" href="#dfcc0d5a9bf6f8db0f14cad9a12c5f9d"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lrt:55" class="idref" href="#lrt:55"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lmt:56" class="idref" href="#lmt:56"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dfcc0d5a9bf6f8db0f14cad9a12c5f9d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dfcc0d5a9bf6f8db0f14cad9a12c5f9d"><span class="id" title="variable">t</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:57" class="idref" href="#k:57"><span class="id" title="binder"><span id="k:58" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:59" class="idref" href="#y:59"><span class="id" title="binder"><span id="y:60" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:55"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:57"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:59"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:61" class="idref" href="#k:61"><span class="id" title="binder"><span id="k:62" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:63" class="idref" href="#y:63"><span class="id" title="binder"><span id="y:64" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:56"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:61"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#y:63"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:63"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="state_interp_transient" class="idref" href="#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> (<a id="e7b86371516ee204368a8545acdaf97b" class="idref" href="#e7b86371516ee204368a8545acdaf97b"><span class="id" title="binder">φ</span></a> <a id="e71d27587b935968f5be7aa7037e6ba7" class="idref" href="#e71d27587b935968f5be7aa7037e6ba7"><span class="id" title="binder">φ</span></a><a id="e71d27587b935968f5be7aa7037e6ba7" class="idref" href="#e71d27587b935968f5be7aa7037e6ba7"><span class="id" title="binder">t</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>) (<a id="lr:67" class="idref" href="#lr:67"><span class="id" title="binder">lr</span></a> <a id="lrt:68" class="idref" href="#lrt:68"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>) (<a id="lm:69" class="idref" href="#lm:69"><span class="id" title="binder">lm</span></a> <a id="lmt:70" class="idref" href="#lmt:70"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>) : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.transiently.html#transiently"><span class="id" title="definition">transiently</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e7b86371516ee204368a8545acdaf97b"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:67"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:69"><span class="id" title="variable">lm</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e71d27587b935968f5be7aa7037e6ba7"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#e71d27587b935968f5be7aa7037e6ba7"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:68"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:70"><span class="id" title="variable">lmt</span></a>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_corr" class="idref" href="#state_interp_corr"><span class="id" title="lemma">state_interp_corr</span></a> {<a id="afad42119ba6a7e5f24c10a4d6fd157f" class="idref" href="#afad42119ba6a7e5f24c10a4d6fd157f"><span class="id" title="binder">σ</span></a> <a id="lregs:72" class="idref" href="#lregs:72"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:73" class="idref" href="#lmem:73"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#afad42119ba6a7e5f24c10a4d6fd157f"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:72"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:73"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="lreg_t:74" class="idref" href="#lreg_t:74"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:75" class="idref" href="#lmem_t:75"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:76" class="idref" href="#cur_map:76"><span class="id" title="binder">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:72"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg_t:74"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:73"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem_t:75"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#afad42119ba6a7e5f24c10a4d6fd157f"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#afad42119ba6a7e5f24c10a4d6fd157f"><span class="id" title="variable">σ</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg_t:74"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem_t:75"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:76"><span class="id" title="variable">cur_map</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iExists</span> <span class="id" title="var">lr</span>, <span class="id" title="var">lm</span>, <span class="id" title="var">vmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro" class="idref" href="#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a> {<a id="1c92da39ae97b46a0c31fd9270fb165d" class="idref" href="#1c92da39ae97b46a0c31fd9270fb165d"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:78" class="idref" href="#lr:78"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:79" class="idref" href="#lm:79"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#1c92da39ae97b46a0c31fd9270fb165d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:78"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:79"><span class="id" title="variable">lm</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#1c92da39ae97b46a0c31fd9270fb165d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#1c92da39ae97b46a0c31fd9270fb165d"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:78"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:78"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:79"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:79"><span class="id" title="variable">lm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>. <span class="id" title="var">iIntros</span>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.transiently.html#transiently_intro"><span class="id" title="lemma">transiently_intro</span></a>. <span class="id" title="keyword">Qed</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO:&nbsp;split&nbsp;off&nbsp;lemma&nbsp;about&nbsp;big_sepM_fmap?&nbsp;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_intro_nodfracs" class="idref" href="#state_interp_transient_intro_nodfracs"><span class="id" title="lemma">state_interp_transient_intro_nodfracs</span></a> {<a id="c5a33b2e045bd912ada7440325d4d6c3" class="idref" href="#c5a33b2e045bd912ada7440325d4d6c3"><span class="id" title="binder">φ</span></a> : <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:81" class="idref" href="#lr:81"><span class="id" title="binder">lr</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:82" class="idref" href="#lm:82"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c5a33b2e045bd912ada7440325d4d6c3"><span class="id" title="variable">φ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:83" class="idref" href="#k:83"><span class="id" title="binder"><span id="k:84" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:85" class="idref" href="#y:85"><span class="id" title="binder"><span id="y:86" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:81"><span class="id" title="variable">lr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:83"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:85"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:87" class="idref" href="#k:87"><span class="id" title="binder"><span id="k:88" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:89" class="idref" href="#y:89"><span class="id" title="binder"><span id="y:90" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:82"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:87"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:89"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c5a33b2e045bd912ada7440325d4d6c3"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c5a33b2e045bd912ada7440325d4d6c3"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:81"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:81"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">(</span><span class="id" title="keyword">fun</span> <a id="y:91" class="idref" href="#y:91"><span class="id" title="binder">y</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:91"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:82"><span class="id" title="variable">lm</span></a>) (<span class="id" title="notation">(</span><span class="id" title="keyword">fun</span> <a id="y:92" class="idref" href="#y:92"><span class="id" title="binder">y</span></a> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1 <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:92"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:82"><span class="id" title="variable">lm</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "H".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient_intro"><span class="id" title="lemma">state_interp_transient_intro</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "H" <span class="id" title="keyword">as</span> "($ &amp; $ &amp; Hm)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">big_sepM_fmap</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_abort" class="idref" href="#state_interp_transient_elim_abort"><span class="id" title="lemma">state_interp_transient_elim_abort</span></a> {<a id="f67c606130aab04d7ca05d33ea60caf2" class="idref" href="#f67c606130aab04d7ca05d33ea60caf2"><span class="id" title="binder">φ</span></a> <a id="bb41ab323747e8d289e2bbd7547a07ec" class="idref" href="#bb41ab323747e8d289e2bbd7547a07ec"><span class="id" title="binder">φ</span></a><a id="bb41ab323747e8d289e2bbd7547a07ec" class="idref" href="#bb41ab323747e8d289e2bbd7547a07ec"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:95" class="idref" href="#lr:95"><span class="id" title="binder">lr</span></a> <a id="lrt:96" class="idref" href="#lrt:96"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:97" class="idref" href="#lm:97"><span class="id" title="binder">lm</span></a> <a id="lmt:98" class="idref" href="#lmt:98"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#f67c606130aab04d7ca05d33ea60caf2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bb41ab323747e8d289e2bbd7547a07ec"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#bb41ab323747e8d289e2bbd7547a07ec"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:95"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:96"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:97"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:98"><span class="id" title="variable">lmt</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#f67c606130aab04d7ca05d33ea60caf2"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:95"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:97"><span class="id" title="variable">lm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iIntros</span> "(H &amp; _)".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_elim_commit" class="idref" href="#state_interp_transient_elim_commit"><span class="id" title="lemma">state_interp_transient_elim_commit</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="54d008a98fe9ec21d88bf6f9daacaf8f" class="idref" href="#54d008a98fe9ec21d88bf6f9daacaf8f"><span class="id" title="binder">φ</span></a> <a id="3924c543db17feb5b466a3255dbf536c" class="idref" href="#3924c543db17feb5b466a3255dbf536c"><span class="id" title="binder">φ</span></a><a id="3924c543db17feb5b466a3255dbf536c" class="idref" href="#3924c543db17feb5b466a3255dbf536c"><span class="id" title="binder">t</span></a>: <a class="idref" href="cap_machine.opsem.cap_lang.html#ExecConf"><span class="id" title="record">ExecConf</span></a>} {<a id="lr:101" class="idref" href="#lr:101"><span class="id" title="binder">lr</span></a> <a id="lrt:102" class="idref" href="#lrt:102"><span class="id" title="binder">lrt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LReg"><span class="id" title="definition">LReg</span></a>} {<a id="lm:103" class="idref" href="#lm:103"><span class="id" title="binder">lm</span></a> <a id="lmt:104" class="idref" href="#lmt:104"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#54d008a98fe9ec21d88bf6f9daacaf8f"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3924c543db17feb5b466a3255dbf536c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#3924c543db17feb5b466a3255dbf536c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:101"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:102"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:103"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:104"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3924c543db17feb5b466a3255dbf536c"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#3924c543db17feb5b466a3255dbf536c"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:102"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:104"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.transiently.html#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_corr" class="idref" href="#state_interp_transient_corr"><span class="id" title="lemma">state_interp_transient_corr</span></a> {<a id="59f70cc763b06eb4e149147e3063b5cf" class="idref" href="#59f70cc763b06eb4e149147e3063b5cf"><span class="id" title="binder">φ</span></a> <a id="55d3d2fc76ad3a53f93518473861ade1" class="idref" href="#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="binder">φ</span></a><a id="55d3d2fc76ad3a53f93518473861ade1" class="idref" href="#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="binder">t</span></a> <a id="lr:107" class="idref" href="#lr:107"><span class="id" title="binder">lr</span></a> <a id="lrt:108" class="idref" href="#lrt:108"><span class="id" title="binder">lrt</span></a> <a id="lm:109" class="idref" href="#lm:109"><span class="id" title="binder">lm</span></a> <a id="lmt:110" class="idref" href="#lmt:110"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#59f70cc763b06eb4e149147e3063b5cf"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:107"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:108"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:109"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:110"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">∃</span></a> <a id="lreg_t:111" class="idref" href="#lreg_t:111"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:112" class="idref" href="#lmem_t:112"><span class="id" title="binder">lmem_t</span></a> <a id="cur_map:113" class="idref" href="#cur_map:113"><span class="id" title="binder">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#94e052c6337a815c52cda44eea9df276"><span class="id" title="notation">,</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:108"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg_t:111"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:110"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem_t:112"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#ba2b0e492d2b4675a0acf3ea92aabadd"><span class="id" title="notation">/\</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#55d3d2fc76ad3a53f93518473861ade1"><span class="id" title="variable">t</span></a>.(<a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg_t:111"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem_t:112"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:113"><span class="id" title="variable">cur_map</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "Htr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.transiently.html#transiently_commit"><span class="id" title="lemma">transiently_commit</span></a> <span class="id" title="notation">with</span> "Htr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hσrt".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "Hσrt"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcor".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lreg_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlreg_t</span> &amp; <span class="id" title="var">Hlmem_t</span> &amp; <span class="id" title="var">Hsplc</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iExists</span> <span class="id" title="var">lreg_t</span>, <span class="id" title="var">lmem_t</span>, <span class="id" title="var">cur_map</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup5" class="idref" href="#wp2_reg_lookup5"><span class="id" title="lemma">wp2_reg_lookup5</span></a> {<a id="lrt:114" class="idref" href="#lrt:114"><span class="id" title="binder">lrt</span></a> <a id="lreg_t:115" class="idref" href="#lreg_t:115"><span class="id" title="binder">lreg_t</span></a> <a id="lmem_t:116" class="idref" href="#lmem_t:116"><span class="id" title="binder">lmem_t</span></a> <a id="r:117" class="idref" href="#r:117"><span class="id" title="binder">r</span></a> <a id="6bd58d5efbb286d39e975855911ad242" class="idref" href="#6bd58d5efbb286d39e975855911ad242"><span class="id" title="binder">σ</span></a><a id="6bd58d5efbb286d39e975855911ad242" class="idref" href="#6bd58d5efbb286d39e975855911ad242"><span class="id" title="binder">r</span></a> <a id="947c7a5f6c9d3696de46b17505338079" class="idref" href="#947c7a5f6c9d3696de46b17505338079"><span class="id" title="binder">σ</span></a><a id="947c7a5f6c9d3696de46b17505338079" class="idref" href="#947c7a5f6c9d3696de46b17505338079"><span class="id" title="binder">m</span></a> <a id="vmap:120" class="idref" href="#vmap:120"><span class="id" title="binder">vmap</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#r:117"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:114"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:114"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg_t:115"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#6bd58d5efbb286d39e975855911ad242"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#6bd58d5efbb286d39e975855911ad242"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#947c7a5f6c9d3696de46b17505338079"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#947c7a5f6c9d3696de46b17505338079"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg_t:115"><span class="id" title="variable">lreg_t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem_t:116"><span class="id" title="variable">lmem_t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#vmap:120"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:114"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:117"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.program_logic.rules_base.html#6bd58d5efbb286d39e975855911ad242"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#6bd58d5efbb286d39e975855911ad242"><span class="id" title="variable">r</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:117"><span class="id" title="variable">r</span></a>) (<span class="id" title="notation">False</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>) (<span class="id" title="keyword">fun</span> <a id="lrw:121" class="idref" href="#lrw:121"><span class="id" title="binder">lrw</span></a> <a id="rw:122" class="idref" href="#rw:122"><span class="id" title="binder">rw</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#rw:122"><span class="id" title="variable">rw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrw:121"><span class="id" title="variable">lrw</span></a> <span class="id" title="notation">⌝</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hregs_incl</span> <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup4" class="idref" href="#wp2_reg_lookup4"><span class="id" title="lemma">wp2_reg_lookup4</span></a> {<a id="lrt:123" class="idref" href="#lrt:123"><span class="id" title="binder">lrt</span></a> <a id="lmt:124" class="idref" href="#lmt:124"><span class="id" title="binder">lmt</span></a> <a id="r:125" class="idref" href="#r:125"><span class="id" title="binder">r</span></a> <a id="4e2931d9fdb968ffbd38e5cf02a14d76" class="idref" href="#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="binder">φ</span></a><a id="4e2931d9fdb968ffbd38e5cf02a14d76" class="idref" href="#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="binder">t</span></a> <a id="7cab9e62a28934cbeaf0ff08bf3fe8fb" class="idref" href="#7cab9e62a28934cbeaf0ff08bf3fe8fb"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#r:125"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:123"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:123"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:124"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:123"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:125"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:125"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#7cab9e62a28934cbeaf0ff08bf3fe8fb"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="lrw:128" class="idref" href="#lrw:128"><span class="id" title="binder">lrw</span></a> <a id="rw:129" class="idref" href="#rw:129"><span class="id" title="binder">rw</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#rw:129"><span class="id" title="variable">rw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrw:128"><span class="id" title="variable">lrw</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4e2931d9fdb968ffbd38e5cf02a14d76"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:123"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:124"><span class="id" title="variable">lmt</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "Hσ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_corr"><span class="id" title="axiom">state_interp_corr</span></a> <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup3" class="idref" href="#wp2_reg_lookup3"><span class="id" title="lemma">wp2_reg_lookup3</span></a> {<a id="lrt:130" class="idref" href="#lrt:130"><span class="id" title="binder">lrt</span></a> <a id="lmt:131" class="idref" href="#lmt:131"><span class="id" title="binder">lmt</span></a> <a id="r:132" class="idref" href="#r:132"><span class="id" title="binder">r</span></a> <a id="652cc908fd6158d55b09029624e592d0" class="idref" href="#652cc908fd6158d55b09029624e592d0"><span class="id" title="binder">φ</span></a><a id="652cc908fd6158d55b09029624e592d0" class="idref" href="#652cc908fd6158d55b09029624e592d0"><span class="id" title="binder">t</span></a> <a id="7122704db72a05f53c98ff62d0f87fd1" class="idref" href="#7122704db72a05f53c98ff62d0f87fd1"><span class="id" title="binder">Φs</span></a> <a id="18513639cf572d6992384d74c7538a78" class="idref" href="#18513639cf572d6992384d74c7538a78"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#r:132"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:130"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#652cc908fd6158d55b09029624e592d0"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#652cc908fd6158d55b09029624e592d0"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:130"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:131"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:136" class="idref" href="#lwr:136"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_with_res"><span class="id" title="definition">state_interp_with_res</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#652cc908fd6158d55b09029624e592d0"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#652cc908fd6158d55b09029624e592d0"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:130"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:131"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#7122704db72a05f53c98ff62d0f87fd1"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwr:136"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwr:136"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:130"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:132"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#652cc908fd6158d55b09029624e592d0"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#652cc908fd6158d55b09029624e592d0"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:132"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#18513639cf572d6992384d74c7538a78"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#7122704db72a05f53c98ff62d0f87fd1"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup4"><span class="id" title="axiom">wp2_reg_lookup4</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_mono"><span class="id" title="axiom">wp_opt2_mono</span></a> <span class="id" title="notation">with</span> "[Hk $Hwp]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span> <span class="id" title="var">wr</span>) "(-&gt; &amp; Hσ)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">with</span> "Hσ"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup2" class="idref" href="#wp2_reg_lookup2"><span class="id" title="lemma">wp2_reg_lookup2</span></a> {<a id="lrt:137" class="idref" href="#lrt:137"><span class="id" title="binder">lrt</span></a> <a id="lmt:138" class="idref" href="#lmt:138"><span class="id" title="binder">lmt</span></a> <a id="r:139" class="idref" href="#r:139"><span class="id" title="binder">r</span></a> <a id="c612fad6b902207a0f4f3a5cf20e562f" class="idref" href="#c612fad6b902207a0f4f3a5cf20e562f"><span class="id" title="binder">φ</span></a> <a id="0cc9b26e8dfe4a94262efd086b1e9172" class="idref" href="#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="binder">φ</span></a><a id="0cc9b26e8dfe4a94262efd086b1e9172" class="idref" href="#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="binder">t</span></a> <a id="lr:142" class="idref" href="#lr:142"><span class="id" title="binder">lr</span></a> <a id="lm:143" class="idref" href="#lm:143"><span class="id" title="binder">lm</span></a> <a id="5f937caab952a7059d4ca1bebda33f8f" class="idref" href="#5f937caab952a7059d4ca1bebda33f8f"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#r:139"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:137"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c612fad6b902207a0f4f3a5cf20e562f"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:142"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:137"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:143"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:138"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:137"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:139"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:139"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#5f937caab952a7059d4ca1bebda33f8f"><span class="id" title="variable">Φf</span></a> (<span class="id" title="keyword">fun</span> <a id="lrw:145" class="idref" href="#lrw:145"><span class="id" title="binder">lrw</span></a> <a id="rw:146" class="idref" href="#rw:146"><span class="id" title="binder">rw</span></a> =&gt; <span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#rw:146"><span class="id" title="variable">rw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrw:145"><span class="id" title="variable">lrw</span></a> <span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c612fad6b902207a0f4f3a5cf20e562f"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#0cc9b26e8dfe4a94262efd086b1e9172"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:142"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:137"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:143"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:138"><span class="id" title="variable">lmt</span></a>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "Htr".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Htr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%HInv".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HInv</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lregs_t</span> &amp; <span class="id" title="var">lmem_t</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hregs_incl</span> &amp; <span class="id" title="var">Hmem_incl</span> &amp; <span class="id" title="var">HInv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> (<span class="id" title="method">elem_of_dom</span> <span class="id" title="var">lrt</span> <span class="id" title="var">r</span>) <span class="id" title="var">Hdom</span>) <span class="id" title="keyword">as</span> (<span class="id" title="var">lrw</span> &amp; <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlrt</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">map_subseteq_spec</span> <span class="id" title="tactic">in</span>  <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">specialize</span> (<span class="id" title="var">Hregs_incl</span> <span class="id" title="var">r</span> <span class="id" title="var">lrw</span> <span class="id" title="var">Hlrt</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hregs_incl</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">erewrite</span> <span class="id" title="var">Hregs_incl</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_reg_lookup" class="idref" href="#wp2_reg_lookup"><span class="id" title="lemma">wp2_reg_lookup</span></a> {<a id="lrt:147" class="idref" href="#lrt:147"><span class="id" title="binder">lrt</span></a> <a id="lmt:148" class="idref" href="#lmt:148"><span class="id" title="binder">lmt</span></a> <a id="r:149" class="idref" href="#r:149"><span class="id" title="binder">r</span></a> <a id="f12a53451a12e43a66c82b8a09116652" class="idref" href="#f12a53451a12e43a66c82b8a09116652"><span class="id" title="binder">φ</span></a> <a id="bae30efddeab3ceb9b8d339049b214b1" class="idref" href="#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="binder">φ</span></a><a id="bae30efddeab3ceb9b8d339049b214b1" class="idref" href="#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="binder">t</span></a> <a id="lr:152" class="idref" href="#lr:152"><span class="id" title="binder">lr</span></a> <a id="lm:153" class="idref" href="#lm:153"><span class="id" title="binder">lm</span></a> <a id="4d940591904f894590771c38059b1e28" class="idref" href="#4d940591904f894590771c38059b1e28"><span class="id" title="binder">Φs</span></a> <a id="016d8dc65893be76c5f59f19c661d2ab" class="idref" href="#016d8dc65893be76c5f59f19c661d2ab"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#r:149"><span class="id" title="variable">r</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:147"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#f12a53451a12e43a66c82b8a09116652"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:152"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:147"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:153"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:148"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lwr:156" class="idref" href="#lwr:156"><span class="id" title="binder">lwr</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#f12a53451a12e43a66c82b8a09116652"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:152"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:147"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:153"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:148"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#4d940591904f894590771c38059b1e28"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwr:156"><span class="id" title="variable">lwr</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwr:156"><span class="id" title="variable">lwr</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:147"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:149"><span class="id" title="variable">r</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#bae30efddeab3ceb9b8d339049b214b1"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:149"><span class="id" title="variable">r</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#016d8dc65893be76c5f59f19c661d2ab"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4d940591904f894590771c38059b1e28"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "[Htr Hk]".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup2"><span class="id" title="axiom">wp2_reg_lookup2</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="notation">with</span> "Htr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hwp".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_mono"><span class="id" title="axiom">wp_opt2_mono</span></a> <span class="id" title="notation">with</span> "[$Hwp Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span> <span class="id" title="var">wr</span>) "(-&gt; &amp; H)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_of_argument" class="idref" href="#wp2_word_of_argument"><span class="id" title="lemma">wp2_word_of_argument</span></a> {<a id="src:157" class="idref" href="#src:157"><span class="id" title="binder">src</span></a> <a id="lw:158" class="idref" href="#lw:158"><span class="id" title="binder">lw</span></a> <a id="bd15a9287b40770664d7c974aeaa5991" class="idref" href="#bd15a9287b40770664d7c974aeaa5991"><span class="id" title="binder">Φf</span></a> <a id="4c56088cf2263663ea505e950b91c0ab" class="idref" href="#4c56088cf2263663ea505e950b91c0ab"><span class="id" title="binder">Φs</span></a> <a id="3aeabcdef85378301bd7dac2876ce8f8" class="idref" href="#3aeabcdef85378301bd7dac2876ce8f8"><span class="id" title="binder">φ</span></a> <a id="c323a979e3de73a422aab62a2216f056" class="idref" href="#c323a979e3de73a422aab62a2216f056"><span class="id" title="binder">φ</span></a><a id="c323a979e3de73a422aab62a2216f056" class="idref" href="#c323a979e3de73a422aab62a2216f056"><span class="id" title="binder">t</span></a> <a id="lr:163" class="idref" href="#lr:163"><span class="id" title="binder">lr</span></a> <a id="lrt:164" class="idref" href="#lrt:164"><span class="id" title="binder">lrt</span></a> <a id="lm:165" class="idref" href="#lm:165"><span class="id" title="binder">lm</span></a> <a id="lmt:166" class="idref" href="#lmt:166"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:157"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:164"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3aeabcdef85378301bd7dac2876ce8f8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c323a979e3de73a422aab62a2216f056"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#c323a979e3de73a422aab62a2216f056"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:163"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:164"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:165"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:166"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lw:167" class="idref" href="#lw:167"><span class="id" title="binder">lw</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3aeabcdef85378301bd7dac2876ce8f8"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c323a979e3de73a422aab62a2216f056"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#c323a979e3de73a422aab62a2216f056"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:163"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:164"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:165"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:166"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#4c56088cf2263663ea505e950b91c0ab"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:167"><span class="id" title="variable">lw</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:167"><span class="id" title="variable">lw</span></a>)<span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#word_of_argumentL"><span class="id" title="definition">word_of_argumentL</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:164"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:157"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#word_of_argument"><span class="id" title="definition">word_of_argument</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c323a979e3de73a422aab62a2216f056"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#c323a979e3de73a422aab62a2216f056"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#src:157"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#bd15a9287b40770664d7c974aeaa5991"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4c56088cf2263663ea505e950b91c0ab"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hσr &amp; HΦs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span>|<span class="id" title="var">r</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"HΦs" <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> (<span class="id" title="var">r</span> := <span class="id" title="var">r</span>) <span class="id" title="notation">with</span> "[$Hσr $HΦs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">set_solver</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_addr_of_argument" class="idref" href="#wp2_addr_of_argument"><span class="id" title="lemma">wp2_addr_of_argument</span></a> {<a id="src:168" class="idref" href="#src:168"><span class="id" title="binder">src</span></a> <a id="6c2321d6cabfd78e7249b94f450fed58" class="idref" href="#6c2321d6cabfd78e7249b94f450fed58"><span class="id" title="binder">Φf</span></a> <a id="269f9014518e781aa34310dbff574309" class="idref" href="#269f9014518e781aa34310dbff574309"><span class="id" title="binder">Φs</span></a> <a id="8b756fe623c19dc44efd428ee7d46e5c" class="idref" href="#8b756fe623c19dc44efd428ee7d46e5c"><span class="id" title="binder">φ</span></a> <a id="ee2bcba3510a4e2b3d3d5c419ffec750" class="idref" href="#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="binder">φ</span></a><a id="ee2bcba3510a4e2b3d3d5c419ffec750" class="idref" href="#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="binder">t</span></a> <a id="lr:173" class="idref" href="#lr:173"><span class="id" title="binder">lr</span></a> <a id="lrt:174" class="idref" href="#lrt:174"><span class="id" title="binder">lrt</span></a> <a id="lm:175" class="idref" href="#lm:175"><span class="id" title="binder">lm</span></a> <a id="lmt:176" class="idref" href="#lmt:176"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:168"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:174"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#8b756fe623c19dc44efd428ee7d46e5c"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:173"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:174"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:175"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:176"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#8b756fe623c19dc44efd428ee7d46e5c"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:173"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:174"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:175"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:176"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#6c2321d6cabfd78e7249b94f450fed58"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:177" class="idref" href="#z:177"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#8b756fe623c19dc44efd428ee7d46e5c"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:173"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:174"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:175"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:176"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#269f9014518e781aa34310dbff574309"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:177"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:177"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#addr_of_argumentL"><span class="id" title="definition">addr_of_argumentL</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:174"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:168"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#addr_of_argument"><span class="id" title="definition">addr_of_argument</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ee2bcba3510a4e2b3d3d5c419ffec750"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#src:168"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#6c2321d6cabfd78e7249b94f450fed58"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#269f9014518e781aa34310dbff574309"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <span class="id" title="var">z</span>); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:182" class="idref" href="#y:182"><span class="id" title="binder"><span id="y:188" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:182"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:181" class="idref" href="#n:181"><span class="id" title="binder"><span id="n:187" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#n:181"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:179" class="idref" href="#y:179"><span class="id" title="binder"><span id="y:185" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:179"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.opsem.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:178" class="idref" href="#n:178"><span class="id" title="binder"><span id="n:184" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#n:178"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span> ; [<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_addr"><span class="id" title="abbreviation">z_to_addr</span></a> <span class="id" title="var">z</span>)| |] ; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_otype_of_argument" class="idref" href="#wp2_otype_of_argument"><span class="id" title="lemma">wp2_otype_of_argument</span></a> {<a id="src:190" class="idref" href="#src:190"><span class="id" title="binder">src</span></a> <a id="e9cc0765d4007d96a2b9cc7f4d4be0df" class="idref" href="#e9cc0765d4007d96a2b9cc7f4d4be0df"><span class="id" title="binder">Φf</span></a> <a id="6e295f08553bea001f9be4842a221eee" class="idref" href="#6e295f08553bea001f9be4842a221eee"><span class="id" title="binder">Φs</span></a> <a id="eb7268b0da21ab7daacc576665020d5f" class="idref" href="#eb7268b0da21ab7daacc576665020d5f"><span class="id" title="binder">φ</span></a> <a id="552c9a352c05cac067a8b25ef8c8babf" class="idref" href="#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="binder">φ</span></a><a id="552c9a352c05cac067a8b25ef8c8babf" class="idref" href="#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="binder">t</span></a> <a id="lr:195" class="idref" href="#lr:195"><span class="id" title="binder">lr</span></a> <a id="lrt:196" class="idref" href="#lrt:196"><span class="id" title="binder">lrt</span></a> <a id="lm:197" class="idref" href="#lm:197"><span class="id" title="binder">lm</span></a> <a id="lmt:198" class="idref" href="#lmt:198"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:190"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:196"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#eb7268b0da21ab7daacc576665020d5f"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:195"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:196"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:197"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:198"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#eb7268b0da21ab7daacc576665020d5f"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:195"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:196"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:197"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:198"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#e9cc0765d4007d96a2b9cc7f4d4be0df"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:199" class="idref" href="#z:199"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#eb7268b0da21ab7daacc576665020d5f"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:195"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:196"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:197"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:198"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#6e295f08553bea001f9be4842a221eee"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:199"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:199"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#otype_of_argumentL"><span class="id" title="definition">otype_of_argumentL</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:196"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:190"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#otype_of_argument"><span class="id" title="definition">otype_of_argument</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#552c9a352c05cac067a8b25ef8c8babf"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#src:190"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#e9cc0765d4007d96a2b9cc7f4d4be0df"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#6e295f08553bea001f9be4842a221eee"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <span class="id" title="var">z</span>); <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:204" class="idref" href="#y:204"><span class="id" title="binder"><span id="y:210" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:204"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:203" class="idref" href="#n:203"><span class="id" title="binder"><span id="n:209" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#n:203"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">(</span><a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:201" class="idref" href="#y:201"><span class="id" title="binder"><span id="y:207" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:201"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.opsem.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">≫=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="n:200" class="idref" href="#n:200"><span class="id" title="binder"><span id="n:206" class="id">n</span></span></a> : <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Numbers.BinNums.html#Z"><span class="id" title="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#n:200"><span class="id" title="variable">n</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;- <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span> ; [<span class="id" title="tactic">destruct</span> (<a class="idref" href="cap_machine.opsem.addr_reg.html#z_to_otype"><span class="id" title="abbreviation">z_to_otype</span></a> <span class="id" title="var">z</span>)| |] ; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_word_get_cap" class="idref" href="#wp2_word_get_cap"><span class="id" title="lemma">wp2_word_get_cap</span></a> {<a id="w:212" class="idref" href="#w:212"><span class="id" title="binder">w</span></a> <a id="e43fa5be1dd9ea9d814ebb56e4d2f6ea" class="idref" href="#e43fa5be1dd9ea9d814ebb56e4d2f6ea"><span class="id" title="binder">Φf</span></a> <a id="91248781663263441190b8b6ce4dd594" class="idref" href="#91248781663263441190b8b6ce4dd594"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#e43fa5be1dd9ea9d814ebb56e4d2f6ea"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="p:215" class="idref" href="#p:215"><span class="id" title="binder">p</span></a> <a id="b:216" class="idref" href="#b:216"><span class="id" title="binder">b</span></a> <a id="e:217" class="idref" href="#e:217"><span class="id" title="binder">e</span></a> <a id="a:218" class="idref" href="#a:218"><span class="id" title="binder">a</span></a> <a id="v:219" class="idref" href="#v:219"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#91248781663263441190b8b6ce4dd594"><span class="id" title="variable">Φs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#p:215"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:216"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:217"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:218"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:219"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#p:215"><span class="id" title="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:216"><span class="id" title="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:217"><span class="id" title="variable">e</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:218"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> @<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_cap"><span class="id" title="definition">lword_get_cap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#w:212"><span class="id" title="variable">w</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#get_wcap"><span class="id" title="definition">get_wcap</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#w:212"><span class="id" title="variable">w</span></a>)) <a class="idref" href="cap_machine.program_logic.rules_base.html#e43fa5be1dd9ea9d814ebb56e4d2f6ea"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#91248781663263441190b8b6ce4dd594"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">z</span> | [<span class="id" title="var">p</span> <span class="id" title="var">b</span> <span class="id" title="var">e</span> <span class="id" title="var">a</span> <span class="id" title="var">v</span> | <span class="id" title="var">x</span>] | <span class="id" title="var">w</span>]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_mem_lookup" class="idref" href="#wp2_mem_lookup"><span class="id" title="lemma">wp2_mem_lookup</span></a> {<a id="lrt:220" class="idref" href="#lrt:220"><span class="id" title="binder">lrt</span></a> <a id="lmt:221" class="idref" href="#lmt:221"><span class="id" title="binder">lmt</span></a> <a id="8b9cfde4740719c5cf7ecbc9a5ab35eb" class="idref" href="#8b9cfde4740719c5cf7ecbc9a5ab35eb"><span class="id" title="binder">φ</span></a> <a id="ef91b38a97431e23793206246cc1aa2b" class="idref" href="#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="binder">φ</span></a><a id="ef91b38a97431e23793206246cc1aa2b" class="idref" href="#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="binder">t</span></a> <a id="lr:224" class="idref" href="#lr:224"><span class="id" title="binder">lr</span></a> <a id="lm:225" class="idref" href="#lm:225"><span class="id" title="binder">lm</span></a> <a id="fe9869726af714864764caa492bc8d12" class="idref" href="#fe9869726af714864764caa492bc8d12"><span class="id" title="binder">Φs</span></a> <a id="a8f1940f64e17c5d669c7892ab91ef4e" class="idref" href="#a8f1940f64e17c5d669c7892ab91ef4e"><span class="id" title="binder">Φf</span></a> <a id="r:228" class="idref" href="#r:228"><span class="id" title="binder">r</span></a> <a id="p:229" class="idref" href="#p:229"><span class="id" title="binder">p</span></a> <a id="b:230" class="idref" href="#b:230"><span class="id" title="binder">b</span></a> <a id="e:231" class="idref" href="#e:231"><span class="id" title="binder">e</span></a> <a id="a:232" class="idref" href="#a:232"><span class="id" title="binder">a</span></a> <a id="v:233" class="idref" href="#v:233"><span class="id" title="binder">v</span></a> <a id="lwa:234" class="idref" href="#lwa:234"><span class="id" title="binder">lwa</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:230"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:231"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:232"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:220"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:228"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#p:229"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:230"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:231"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:232"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:233"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:221"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#a:232"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#v:233"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwa:234"><span class="id" title="variable">lwa</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#8b9cfde4740719c5cf7ecbc9a5ab35eb"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:224"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:220"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:225"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:221"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#8b9cfde4740719c5cf7ecbc9a5ab35eb"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:224"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:220"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:225"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:221"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#fe9869726af714864764caa492bc8d12"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwa:234"><span class="id" title="variable">lwa</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwa:234"><span class="id" title="variable">lwa</span></a>)<span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:221"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#a:232"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#v:233"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#ef91b38a97431e23793206246cc1aa2b"><span class="id" title="variable">t</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:232"><span class="id" title="variable">a</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#a8f1940f64e17c5d669c7892ab91ef4e"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#fe9869726af714864764caa492bc8d12"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hin_bounds</span> <span class="id" title="var">Hlrt_r</span> <span class="id" title="var">Hlmt_a</span>) "(Hσr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient_corr"><span class="id" title="axiom">state_interp_transient_corr</span></a> <span class="id" title="notation">with</span> "Hσr"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hcor".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcor</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lr'</span> &amp; <span class="id" title="var">lm'</span> &amp; <span class="id" title="var">cur_map</span> &amp; <span class="id" title="var">Hlrt_incl</span> &amp; <span class="id" title="var">Hlmt_incl</span> &amp; <span class="id" title="var">Hinv</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>, <span class="id" title="var">Hlrt_r</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_mem_get_word"><span class="id" title="axiom">state_corresponds_mem_get_word</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>; <span class="id" title="tactic">eauto</span>; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: { <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a>; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="var">Hlmt_a</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp2_val"><span class="id" title="axiom">wp2_val</span></a>. <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_z_of_argument" class="idref" href="#wp2_z_of_argument"><span class="id" title="lemma">wp2_z_of_argument</span></a> {<a id="src:235" class="idref" href="#src:235"><span class="id" title="binder">src</span></a> <a id="7a80dd148189096bc7a07cf82b822d52" class="idref" href="#7a80dd148189096bc7a07cf82b822d52"><span class="id" title="binder">Φf</span></a> <a id="8db272b4cab9fb728d46ddd4a1f31f8f" class="idref" href="#8db272b4cab9fb728d46ddd4a1f31f8f"><span class="id" title="binder">Φs</span></a> <a id="e4b879635974eb718fc2acdfdec8d46a" class="idref" href="#e4b879635974eb718fc2acdfdec8d46a"><span class="id" title="binder">φ</span></a> <a id="4bf7fefd33ca1b1ffcf3d9d85b65267d" class="idref" href="#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="binder">φ</span></a><a id="4bf7fefd33ca1b1ffcf3d9d85b65267d" class="idref" href="#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="binder">t</span></a> <a id="lr:240" class="idref" href="#lr:240"><span class="id" title="binder">lr</span></a> <a id="lrt:241" class="idref" href="#lrt:241"><span class="id" title="binder">lrt</span></a> <a id="lm:242" class="idref" href="#lm:242"><span class="id" title="binder">lm</span></a> <a id="lmt:243" class="idref" href="#lmt:243"><span class="id" title="binder">lmt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#regs_of_argument"><span class="id" title="definition">regs_of_argument</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:235"><span class="id" title="variable">src</span></a> <span class="id" title="notation">⊆</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:241"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e4b879635974eb718fc2acdfdec8d46a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:240"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:241"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:242"><span class="id" title="variable">lm</span></a>  <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:243"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e4b879635974eb718fc2acdfdec8d46a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:240"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:241"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:242"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:243"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#7a80dd148189096bc7a07cf82b822d52"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">((</span><span class="id" title="notation">∀</span> <a id="z:244" class="idref" href="#z:244"><span class="id" title="binder">z</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e4b879635974eb718fc2acdfdec8d46a"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:240"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:241"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:242"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:243"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#8db272b4cab9fb728d46ddd4a1f31f8f"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:244"><span class="id" title="variable">z</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:244"><span class="id" title="variable">z</span></a><span class="id" title="notation">))</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#z_of_argumentL"><span class="id" title="definition">z_of_argumentL</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:241"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:235"><span class="id" title="variable">src</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#z_of_argument"><span class="id" title="definition">z_of_argument</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#4bf7fefd33ca1b1ffcf3d9d85b65267d"><span class="id" title="variable">t</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#src:235"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#7a80dd148189096bc7a07cf82b822d52"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#8db272b4cab9fb728d46ddd4a1f31f8f"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hregs</span>) "(Hφ &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">src</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">change</span> (<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<span class="id" title="var">lrt</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:247" class="idref" href="#y:247"><span class="id" title="binder"><span id="y:251" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:247"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LInt"><span class="id" title="abbreviation">LInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> φ<span class="id" title="var">t</span> <span class="id" title="notation">!!</span> <span class="id" title="var">r</span> <span class="id" title="notation">≫=</span> <span class="id" title="keyword">fun</span> <a id="y:245" class="idref" href="#y:245"><span class="id" title="binder"><span id="y:249" class="id">y</span></span></a> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:245"><span class="id" title="variable">y</span></a> <span class="id" title="keyword">with</span> | <a class="idref" href="cap_machine.opsem.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <span class="id" title="var">z</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">z</span> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> <span class="id" title="keyword">end</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Φf</span> <span class="id" title="var">Φs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-<a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφ Hk]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">set_solver</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>. <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> "Hk".<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;More&nbsp;expressive&nbsp;version&nbsp;of&nbsp;update_state_interp_from_reg_nomod.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;This&nbsp;is&nbsp;needed&nbsp;for&nbsp;operations&nbsp;that&nbsp;edit&nbsp;a&nbsp;current&nbsp;(in&nbsp;terms&nbsp;of&nbsp;version)&nbsp;word,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;requiring&nbsp;us&nbsp;to&nbsp;re-prove&nbsp;"currentness"&nbsp;of&nbsp;the&nbsp;edited&nbsp;word.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Think&nbsp;e.g.&nbsp;shrinking&nbsp;the&nbsp;bounds&nbsp;of&nbsp;a&nbsp;capability&nbsp;read&nbsp;from&nbsp;a&nbsp;register.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_regs_mod" class="idref" href="#update_state_interp_from_regs_mod"><span class="id" title="lemma">update_state_interp_from_regs_mod</span></a> {<a id="fc9d52a9f5e62ee670869b76f35c8cd9" class="idref" href="#fc9d52a9f5e62ee670869b76f35c8cd9"><span class="id" title="binder">σ</span></a> <a id="dst:254" class="idref" href="#dst:254"><span class="id" title="binder">dst</span></a> <a id="lw2:255" class="idref" href="#lw2:255"><span class="id" title="binder">lw2</span></a> <a id="lregs:256" class="idref" href="#lregs:256"><span class="id" title="binder">lregs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:254"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:256"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:257" class="idref" href="#cur_map:257"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:256"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:257"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:255"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:257"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#fc9d52a9f5e62ee670869b76f35c8cd9"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:258" class="idref" href="#k:258"><span class="id" title="binder"><span id="k:259" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:260" class="idref" href="#y:260"><span class="id" title="binder"><span id="y:261" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:256"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:258"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:260"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#fc9d52a9f5e62ee670869b76f35c8cd9"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:254"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:255"><span class="id" title="variable">lw2</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:262" class="idref" href="#k:262"><span class="id" title="binder"><span id="k:263" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:264" class="idref" href="#y:264"><span class="id" title="binder"><span id="y:265" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:254"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:255"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:262"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:264"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hcur</span>) "(Hσ &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hcur</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hregs_incl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">eapply</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj2"><span class="id" title="lemma">proj2</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#proj1"><span class="id" title="lemma">proj1</span></a> <span class="id" title="var">HLinv</span>)).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Updates the transient state with a register update to dst that writes
      a word lw2 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_regs_mod" class="idref" href="#update_state_interp_transient_from_regs_mod"><span class="id" title="lemma">update_state_interp_transient_from_regs_mod</span></a> {<a id="0585ac5ef4e5889326edf8d635ab2fe6" class="idref" href="#0585ac5ef4e5889326edf8d635ab2fe6"><span class="id" title="binder">σ</span></a> <a id="047826b9770c0d2f7677210b47da13c8" class="idref" href="#047826b9770c0d2f7677210b47da13c8"><span class="id" title="binder">σ</span></a><a id="047826b9770c0d2f7677210b47da13c8" class="idref" href="#047826b9770c0d2f7677210b47da13c8"><span class="id" title="binder">t</span></a> <a id="lr:268" class="idref" href="#lr:268"><span class="id" title="binder">lr</span></a> <a id="lrt:269" class="idref" href="#lrt:269"><span class="id" title="binder">lrt</span></a> <a id="lm:270" class="idref" href="#lm:270"><span class="id" title="binder">lm</span></a> <a id="lmt:271" class="idref" href="#lmt:271"><span class="id" title="binder">lmt</span></a> <a id="dst:272" class="idref" href="#dst:272"><span class="id" title="binder">dst</span></a> <a id="lw2:273" class="idref" href="#lw2:273"><span class="id" title="binder">lw2</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:272"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:269"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:274" class="idref" href="#cur_map:274"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:269"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:274"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:273"><span class="id" title="variable">lw2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:274"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#0585ac5ef4e5889326edf8d635ab2fe6"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#047826b9770c0d2f7677210b47da13c8"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#047826b9770c0d2f7677210b47da13c8"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:268"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:269"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:270"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:271"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#0585ac5ef4e5889326edf8d635ab2fe6"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#047826b9770c0d2f7677210b47da13c8"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#047826b9770c0d2f7677210b47da13c8"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:272"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:273"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lr:268"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:272"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:273"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:270"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:271"><span class="id" title="variable">lmt</span></a> .<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span>) "&gt;(Hσ &amp; Hregs &amp; $)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hcur</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;This&nbsp;lemma&nbsp;updates&nbsp;the&nbsp;state&nbsp;for&nbsp;operations&nbsp;where&nbsp;a&nbsp;current&nbsp;word&nbsp;is<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;immediately&nbsp;moved&nbsp;(to&nbsp;another&nbsp;register).&nbsp;Since&nbsp;the&nbsp;word&nbsp;was&nbsp;not&nbsp;edited,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;and&nbsp;it&nbsp;was&nbsp;read&nbsp;from&nbsp;a&nbsp;register,&nbsp;it&nbsp;is&nbsp;obviously&nbsp;already&nbsp;"current"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_reg_nomod" class="idref" href="#update_state_interp_from_reg_nomod"><span class="id" title="lemma">update_state_interp_from_reg_nomod</span></a> {<a id="4f03a8ae0f30a91dff1e5cc72943429f" class="idref" href="#4f03a8ae0f30a91dff1e5cc72943429f"><span class="id" title="binder">σ</span></a> <a id="src:276" class="idref" href="#src:276"><span class="id" title="binder">src</span></a> <a id="dst:277" class="idref" href="#dst:277"><span class="id" title="binder">dst</span></a> <a id="lw:278" class="idref" href="#lw:278"><span class="id" title="binder">lw</span></a> <a id="regs:279" class="idref" href="#regs:279"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:277"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:279"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#regs:279"><span class="id" title="variable">regs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:276"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:278"><span class="id" title="variable">lw</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4f03a8ae0f30a91dff1e5cc72943429f"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:280" class="idref" href="#k:280"><span class="id" title="binder"><span id="k:281" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:282" class="idref" href="#y:282"><span class="id" title="binder"><span id="y:283" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:279"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:280"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:282"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#4f03a8ae0f30a91dff1e5cc72943429f"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:277"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:278"><span class="id" title="variable">lw</span></a>)) <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:284" class="idref" href="#k:284"><span class="id" title="binder"><span id="k:285" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:286" class="idref" href="#y:286"><span class="id" title="binder"><span id="y:287" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:277"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:278"><span class="id" title="variable">lw</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:284"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:286"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span> <span class="id" title="var">Hsrc</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a>; <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_int" class="idref" href="#update_state_interp_int"><span class="id" title="lemma">update_state_interp_int</span></a> {<a id="c76b9d331be540c2f234d10ab37a2059" class="idref" href="#c76b9d331be540c2f234d10ab37a2059"><span class="id" title="binder">σ</span></a> <a id="dst:289" class="idref" href="#dst:289"><span class="id" title="binder">dst</span></a> <a id="z:290" class="idref" href="#z:290"><span class="id" title="binder">z</span></a> <a id="regs:291" class="idref" href="#regs:291"><span class="id" title="binder">regs</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:289"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:291"><span class="id" title="variable">regs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c76b9d331be540c2f234d10ab37a2059"><span class="id" title="variable">σ</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:292" class="idref" href="#k:292"><span class="id" title="binder"><span id="k:293" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:294" class="idref" href="#y:294"><span class="id" title="binder"><span id="y:295" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#regs:291"><span class="id" title="variable">regs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:292"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:294"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">|==&gt;</span> <a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c76b9d331be540c2f234d10ab37a2059"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:289"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:290"><span class="id" title="variable">z</span></a>)) <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:296" class="idref" href="#k:296"><span class="id" title="binder"><span id="k:297" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:298" class="idref" href="#y:298"><span class="id" title="binder"><span id="y:299" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:289"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:290"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">regs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:296"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:298"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_from_regs_mod"><span class="id" title="axiom">update_state_interp_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>)); <span class="id" title="var">now</span> <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Updates the transient state with a register update to dst that writes
      an int z 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_int" class="idref" href="#update_state_interp_transient_int"><span class="id" title="lemma">update_state_interp_transient_int</span></a> {<a id="2d2d4480dd3a38fad0b94980c4a98680" class="idref" href="#2d2d4480dd3a38fad0b94980c4a98680"><span class="id" title="binder">σ</span></a> <a id="88293744c84ccad1f363268719e58630" class="idref" href="#88293744c84ccad1f363268719e58630"><span class="id" title="binder">σ</span></a><a id="88293744c84ccad1f363268719e58630" class="idref" href="#88293744c84ccad1f363268719e58630"><span class="id" title="binder">t</span></a> <a id="lr:302" class="idref" href="#lr:302"><span class="id" title="binder">lr</span></a> <a id="lrt:303" class="idref" href="#lrt:303"><span class="id" title="binder">lrt</span></a> <a id="lm:304" class="idref" href="#lm:304"><span class="id" title="binder">lm</span></a> <a id="lmt:305" class="idref" href="#lmt:305"><span class="id" title="binder">lmt</span></a> <a id="dst:306" class="idref" href="#dst:306"><span class="id" title="binder">dst</span></a> <a id="z:307" class="idref" href="#z:307"><span class="id" title="binder">z</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:306"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:303"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#2d2d4480dd3a38fad0b94980c4a98680"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#88293744c84ccad1f363268719e58630"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#88293744c84ccad1f363268719e58630"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:302"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:303"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:304"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:305"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#2d2d4480dd3a38fad0b94980c4a98680"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#88293744c84ccad1f363268719e58630"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#88293744c84ccad1f363268719e58630"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:306"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.opsem.machine_base.html#WInt"><span class="id" title="constructor">WInt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:307"><span class="id" title="variable">z</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lr:302"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:306"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#z:307"><span class="id" title="variable">z</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:304"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:305"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">Hdom</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWInt"><span class="id" title="constructor">LWInt</span></a> <span class="id" title="var">z</span>) <span class="id" title="var">Hdom</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_cap_mod" class="idref" href="#update_state_interp_from_cap_mod"><span class="id" title="lemma">update_state_interp_from_cap_mod</span></a> {<a id="bf539eddcb1cb802410af5309cc464fa" class="idref" href="#bf539eddcb1cb802410af5309cc464fa"><span class="id" title="binder">σ</span></a> <a id="dst:309" class="idref" href="#dst:309"><span class="id" title="binder">dst</span></a> <a id="lw2:310" class="idref" href="#lw2:310"><span class="id" title="binder">lw2</span></a> <a id="lregs:311" class="idref" href="#lregs:311"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:312" class="idref" href="#lmem:312"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>} {<a id="p:313" class="idref" href="#p:313"><span class="id" title="binder">p</span></a> <a id="b:314" class="idref" href="#b:314"><span class="id" title="binder">b</span></a> <a id="e:315" class="idref" href="#e:315"><span class="id" title="binder">e</span></a> <a id="a:316" class="idref" href="#a:316"><span class="id" title="binder">a</span></a> <a id="v:317" class="idref" href="#v:317"><span class="id" title="binder">v</span></a> <a id="r:318" class="idref" href="#r:318"><span class="id" title="binder">r</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:309"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:311"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:311"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:318"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#p:313"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:314"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:315"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:316"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:317"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:314"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:315"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:316"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:312"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#a:316"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:317"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:310"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bf539eddcb1cb802410af5309cc464fa"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:319" class="idref" href="#k:319"><span class="id" title="binder"><span id="k:320" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:321" class="idref" href="#y:321"><span class="id" title="binder"><span id="y:322" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:311"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:319"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:321"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:323" class="idref" href="#la:323"><span class="id" title="binder"><span id="la:324" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:325" class="idref" href="#dw:325"><span class="id" title="binder"><span id="dw:326" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:312"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:323"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dw:325"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dw:325"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bf539eddcb1cb802410af5309cc464fa"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:309"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:310"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:327" class="idref" href="#k:327"><span class="id" title="binder"><span id="k:328" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:329" class="idref" href="#y:329"><span class="id" title="binder"><span id="y:330" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:309"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:310"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:327"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:329"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:331" class="idref" href="#la:331"><span class="id" title="binder"><span id="la:332" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:333" class="idref" href="#dw:333"><span class="id" title="binder"><span id="dw:334" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:312"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:331"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dw:333"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dw:333"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdst</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">dst</span> <span class="id" title="var">lw2</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <span class="id" title="method">elem_of_dom</span>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Ha</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [<span class="id" title="var">Hinv_reg</span> <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lmem_corresponds_read_iscur"><span class="id" title="axiom">lmem_corresponds_read_iscur</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hr</span> ; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_cap_cur_word"><span class="id" title="axiom">state_corresponds_cap_cur_word</span></a> ; <span class="id" title="tactic">eauto</span>; <span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Updates the transient state with a register update to dst that writes
      a value lw retrieved from memory using the capability in r 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_cap_mod" class="idref" href="#update_state_interp_transient_from_cap_mod"><span class="id" title="lemma">update_state_interp_transient_from_cap_mod</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="fe8e75f1a91e1fd954cdea3011ae730a" class="idref" href="#fe8e75f1a91e1fd954cdea3011ae730a"><span class="id" title="binder">σ</span></a> <a id="cb97c0c434b9394b26f7c487215935f2" class="idref" href="#cb97c0c434b9394b26f7c487215935f2"><span class="id" title="binder">σ</span></a><a id="cb97c0c434b9394b26f7c487215935f2" class="idref" href="#cb97c0c434b9394b26f7c487215935f2"><span class="id" title="binder">t</span></a> <a id="lr:337" class="idref" href="#lr:337"><span class="id" title="binder">lr</span></a> <a id="lrt:338" class="idref" href="#lrt:338"><span class="id" title="binder">lrt</span></a> <a id="lm:339" class="idref" href="#lm:339"><span class="id" title="binder">lm</span></a> <a id="lmt:340" class="idref" href="#lmt:340"><span class="id" title="binder">lmt</span></a> <a id="dst:341" class="idref" href="#dst:341"><span class="id" title="binder">dst</span></a> <a id="lw2:342" class="idref" href="#lw2:342"><span class="id" title="binder">lw2</span></a> <a id="r:343" class="idref" href="#r:343"><span class="id" title="binder">r</span></a> <a id="p:344" class="idref" href="#p:344"><span class="id" title="binder">p</span></a> <a id="b:345" class="idref" href="#b:345"><span class="id" title="binder">b</span></a> <a id="e:346" class="idref" href="#e:346"><span class="id" title="binder">e</span></a> <a id="a:347" class="idref" href="#a:347"><span class="id" title="binder">a</span></a> <a id="v:348" class="idref" href="#v:348"><span class="id" title="binder">v</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#dst:341"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:338"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:338"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#r:343"><span class="id" title="variable">r</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#p:344"><span class="id" title="variable">p</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:345"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:346"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:347"><span class="id" title="variable">a</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:348"><span class="id" title="variable">v</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.machine_base.html#withinBounds"><span class="id" title="definition">withinBounds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:345"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:346"><span class="id" title="variable">e</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:347"><span class="id" title="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:340"><span class="id" title="variable">lmt</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">!!</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#a:347"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:348"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:342"><span class="id" title="variable">lw2</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#fe8e75f1a91e1fd954cdea3011ae730a"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cb97c0c434b9394b26f7c487215935f2"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#cb97c0c434b9394b26f7c487215935f2"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:337"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:338"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:339"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:340"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#fe8e75f1a91e1fd954cdea3011ae730a"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_reg"><span class="id" title="definition">update_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cb97c0c434b9394b26f7c487215935f2"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#cb97c0c434b9394b26f7c487215935f2"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:341"><span class="id" title="variable">dst</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:342"><span class="id" title="variable">lw2</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lr:337"><span class="id" title="variable">lr</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dst:341"><span class="id" title="variable">dst</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw2:342"><span class="id" title="variable">lw2</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lrt</span>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:339"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:340"><span class="id" title="variable">lmt</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span>) "&gt;(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_from_cap_mod"><span class="id" title="axiom">update_state_interp_from_cap_mod</span></a> <span class="id" title="var">Hdom</span> <span class="id" title="var">Hr</span> <span class="id" title="var">Hinbounds</span> <span class="id" title="var">Ha</span> <span class="id" title="notation">with</span> "[$Hσ $Hregs $Hmem]"<span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_from_mem_mod" class="idref" href="#update_state_interp_from_mem_mod"><span class="id" title="lemma">update_state_interp_from_mem_mod</span></a> {<a id="bd99825b106d19af92a6386298daa833" class="idref" href="#bd99825b106d19af92a6386298daa833"><span class="id" title="binder">σ</span></a> <a id="lregs:350" class="idref" href="#lregs:350"><span class="id" title="binder">lregs</span></a>} {<a id="lmem:351" class="idref" href="#lmem:351"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>} <a id="laddr:352" class="idref" href="#laddr:352"><span class="id" title="binder">laddr</span></a> <a id="lwold:353" class="idref" href="#lwold:353"><span class="id" title="binder">lwold</span></a> <a id="lwnew:354" class="idref" href="#lwnew:354"><span class="id" title="binder">lwnew</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:355" class="idref" href="#cur_map:355"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:350"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:355"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwnew:354"><span class="id" title="variable">lwnew</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:355"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:356" class="idref" href="#cur_map:356"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:350"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:356"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#laddr:352"><span class="id" title="variable">laddr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:356"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:351"><span class="id" title="variable">lmem</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#laddr:352"><span class="id" title="variable">laddr</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwold:353"><span class="id" title="variable">lwold</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bd99825b106d19af92a6386298daa833"><span class="id" title="variable">σ</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:357" class="idref" href="#k:357"><span class="id" title="binder"><span id="k:358" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:359" class="idref" href="#y:359"><span class="id" title="binder"><span id="y:360" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:350"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:357"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:359"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:361" class="idref" href="#la:361"><span class="id" title="binder"><span id="la:362" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:363" class="idref" href="#dw:363"><span class="id" title="binder"><span id="dw:364" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:351"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:361"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dw:363"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dw:363"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.base_logic.html#state_interp_logical"><span class="id" title="definition">state_interp_logical</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#bd99825b106d19af92a6386298daa833"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#laddr:352"><span class="id" title="variable">laddr</span></a>) (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwnew:354"><span class="id" title="variable">lwnew</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:365" class="idref" href="#k:365"><span class="id" title="binder"><span id="k:366" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:367" class="idref" href="#y:367"><span class="id" title="binder"><span id="y:368" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:350"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:365"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:367"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:369" class="idref" href="#la:369"><span class="id" title="binder"><span id="la:370" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:371" class="idref" href="#dw:371"><span class="id" title="binder"><span id="dw:372" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.rules_base.html#laddr:352"><span class="id" title="variable">laddr</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwnew:354"><span class="id" title="variable">lwnew</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmem</span><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:369"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dw:371"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dw:371"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hladdr</span>) "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">tbl_cur</span> <span class="id" title="var">tbl_prev</span> <span class="id" title="var">tbl_all</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hr &amp; Hm
         &amp; -&gt; &amp; Htbl_cur &amp; Htbl_prev &amp; Htbl_all
         &amp; HEC
         &amp; %Hdom_tbl1 &amp; %Hdom_tbl2 &amp; %Hdom_tbl3 &amp; %Hdom_tbl4
         &amp; %HLinv)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>, <span class="id" title="var">Hdom_tbl1</span>, <span class="id" title="var">Hdom_tbl2</span>, <span class="id" title="var">Hdom_tbl3</span>, <span class="id" title="var">Hdom_tbl4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPoseProof</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM_general"><span class="id" title="axiom">gen_heap_valid_inclSepM_general</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_update_inSepM_general"><span class="id" title="axiom">gen_heap_update_inSepM_general</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">laddr</span> <span class="id" title="var">lwnew</span><span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hm Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">vmap</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>,<span class="id" title="var">_</span>; <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span> ; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">HLinv</span> <span class="id" title="keyword">as</span> [[? <span class="id" title="var">Hregscur</span>] <span class="id" title="var">Hinv_mem</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds_update_mem"><span class="id" title="axiom">state_phys_log_corresponds_update_mem</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1: <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcura</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;2: <span class="id" title="tactic">apply</span> <span class="id" title="var">Hcurw</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">apply</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hlregs_incl</span>); <span class="id" title="tactic">auto</span>.<br/>
<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
</div>

<div class="doc">
Updates the transient state with a memory update to address la, writing
      a word lw 
</div>
<div class="code">
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_transient_from_mem_mod" class="idref" href="#update_state_interp_transient_from_mem_mod"><span class="id" title="lemma">update_state_interp_transient_from_mem_mod</span></a> {<a id="775df39bee58f1ad5d4501a7268a7eb1" class="idref" href="#775df39bee58f1ad5d4501a7268a7eb1"><span class="id" title="binder">σ</span></a> <a id="05faebcfc23934576d28587a8f361957" class="idref" href="#05faebcfc23934576d28587a8f361957"><span class="id" title="binder">σ</span></a><a id="05faebcfc23934576d28587a8f361957" class="idref" href="#05faebcfc23934576d28587a8f361957"><span class="id" title="binder">t</span></a> <a id="lr:375" class="idref" href="#lr:375"><span class="id" title="binder">lr</span></a> <a id="lrt:376" class="idref" href="#lrt:376"><span class="id" title="binder">lrt</span></a>} {<a id="lm:377" class="idref" href="#lm:377"><span class="id" title="binder">lm</span></a> <a id="lmt:378" class="idref" href="#lmt:378"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>} <a id="la:379" class="idref" href="#la:379"><span class="id" title="binder">la</span></a> <a id="lw:380" class="idref" href="#lw:380"><span class="id" title="binder">lw</span></a> <a id="lw':381" class="idref" href="#lw':381"><span class="id" title="binder">lw'</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:382" class="idref" href="#cur_map:382"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:376"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:382"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_word"><span class="id" title="definition">is_cur_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:380"><span class="id" title="variable">lw</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:382"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">(</span></a><span class="id" title="notation">forall</span> <a id="cur_map:383" class="idref" href="#cur_map:383"><span class="id" title="binder">cur_map</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs"><span class="id" title="definition">is_cur_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:376"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:383"><span class="id" title="variable">cur_map</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_addr"><span class="id" title="definition">is_cur_addr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:379"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#cur_map:383"><span class="id" title="variable">cur_map</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:378"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:379"><span class="id" title="variable">la</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw':381"><span class="id" title="variable">lw'</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#775df39bee58f1ad5d4501a7268a7eb1"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#05faebcfc23934576d28587a8f361957"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#05faebcfc23934576d28587a8f361957"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:375"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:376"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:377"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:378"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#775df39bee58f1ad5d4501a7268a7eb1"><span class="id" title="variable">σ</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_mem"><span class="id" title="definition">update_mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#05faebcfc23934576d28587a8f361957"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#05faebcfc23934576d28587a8f361957"><span class="id" title="variable">t</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#laddr_get_addr"><span class="id" title="definition">laddr_get_addr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:379"><span class="id" title="variable">la</span></a>) (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:380"><span class="id" title="variable">lw</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lr:375"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:376"><span class="id" title="variable">lrt</span></a> <span class="comment">(*&nbsp;registers&nbsp;remain&nbsp;unchanged&nbsp;*)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lm:377"><span class="id" title="variable">lm</span></a> (<span class="id" title="notation">&lt;[</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:379"><span class="id" title="variable">la</span></a> <span class="id" title="notation">:=</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lw:380"><span class="id" title="variable">lw</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lmt</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hla</span>) "&gt;Hσ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="var">iApply</span> (<a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_from_mem_mod"><span class="id" title="axiom">update_state_interp_from_mem_mod</span></a> <span class="id" title="var">la</span> <span class="id" title="var">lw'</span> <span class="id" title="var">lw</span> <span class="id" title="var">Hcurw</span> <span class="id" title="var">Hcura</span> <span class="id" title="var">Hla</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC2" class="idref" href="#wp2_opt_incrementPC2"><span class="id" title="lemma">wp2_opt_incrementPC2</span></a> {<a id="lregs:384" class="idref" href="#lregs:384"><span class="id" title="binder">lregs</span></a> <a id="67593d611a336f1a899f3663f90428c6" class="idref" href="#67593d611a336f1a899f3663f90428c6"><span class="id" title="binder">σ</span></a><a id="67593d611a336f1a899f3663f90428c6" class="idref" href="#67593d611a336f1a899f3663f90428c6"><span class="id" title="binder">r</span></a> <a id="29e4fb337beb71f664d9f68c64a28e7c" class="idref" href="#29e4fb337beb71f664d9f68c64a28e7c"><span class="id" title="binder">σ</span></a><a id="29e4fb337beb71f664d9f68c64a28e7c" class="idref" href="#29e4fb337beb71f664d9f68c64a28e7c"><span class="id" title="binder">m</span></a> <a id="lmem:387" class="idref" href="#lmem:387"><span class="id" title="binder">lmem</span></a> <a id="vmap:388" class="idref" href="#vmap:388"><span class="id" title="binder">vmap</span></a> <a id="lrt:389" class="idref" href="#lrt:389"><span class="id" title="binder">lrt</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:389"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:389"><span class="id" title="variable">lrt</span></a> <span class="id" title="notation">⊆</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:384"><span class="id" title="variable">lregs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#67593d611a336f1a899f3663f90428c6"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#67593d611a336f1a899f3663f90428c6"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#29e4fb337beb71f664d9f68c64a28e7c"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#29e4fb337beb71f664d9f68c64a28e7c"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:384"><span class="id" title="variable">lregs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:387"><span class="id" title="variable">lmem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#vmap:388"><span class="id" title="variable">vmap</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:384"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:390" class="idref" href="#k:390"><span class="id" title="binder"><span id="k:391" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:392" class="idref" href="#y:392"><span class="id" title="binder"><span id="y:393" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:389"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:390"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:392"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:389"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#67593d611a336f1a899f3663f90428c6"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#67593d611a336f1a899f3663f90428c6"><span class="id" title="variable">r</span></a>) (<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:384"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:401" class="idref" href="#k:401"><span class="id" title="binder"><span id="k:402" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:403" class="idref" href="#y:403"><span class="id" title="binder"><span id="y:404" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:389"><span class="id" title="variable">lrt</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:401"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:403"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <a id="lrt2:394" class="idref" href="#lrt2:394"><span class="id" title="binder">lrt2</span></a> <a id="rs2:395" class="idref" href="#rs2:395"><span class="id" title="binder">rs2</span></a> =&gt; <span class="id" title="notation">∃</span> <a id="lregs2:396" class="idref" href="#lregs2:396"><span class="id" title="binder">lregs2</span></a><span class="id" title="notation">,</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs2:396"><span class="id" title="variable">lregs2</span></a> <span class="id" title="notation">∗</span> <span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#rs2:395"><span class="id" title="variable">rs2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#29e4fb337beb71f664d9f68c64a28e7c"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#29e4fb337beb71f664d9f68c64a28e7c"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs2:396"><span class="id" title="variable">lregs2</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:387"><span class="id" title="variable">lmem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#vmap:388"><span class="id" title="variable">vmap</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:397" class="idref" href="#k:397"><span class="id" title="binder"><span id="k:398" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:399" class="idref" href="#y:399"><span class="id" title="binder"><span id="y:400" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt2:394"><span class="id" title="variable">lrt2</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:397"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:399"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span> <span class="id" title="var">Hlrt</span> <span class="id" title="var">Hcorr</span>) "(Hσr &amp; Hregs)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>; <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_eqn_both"><span class="id" title="axiom">wp_opt2_eqn_both</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_mono2"><span class="id" title="axiom">wp_opt2_mono2</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitL</span>; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup5"><span class="id" title="axiom">wp2_reg_lookup5</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="tactic">first</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iIntros</span> "%f".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lw</span> <span class="id" title="var">w</span>) "-&gt; %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lw</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>; <span class="id" title="tactic">try</span> <span class="id" title="tactic">by</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>)<span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hσr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iExists</span> <span class="id" title="var">_</span>. <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds_update_reg"><span class="id" title="axiom">state_phys_log_corresponds_update_reg</span></a>; <span class="id" title="tactic">try</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_lword_lea"><span class="id" title="axiom">is_cur_lword_lea</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">lw</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> <span class="id" title="var">v</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.opsem.machine_base.html#isWithin_refl"><span class="id" title="axiom">isWithin_refl</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">refine</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_regs_mono"><span class="id" title="axiom">is_cur_regs_mono</span></a> <span class="id" title="var">Hlrt</span> <span class="id" title="var">_</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span>); <span class="id" title="var">last</span> <span class="id" title="var">easy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">now</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcorr</span> <span class="id" title="keyword">as</span> [[<span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>] <span class="id" title="var">_</span>].<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_opt_incrementPC" class="idref" href="#wp2_opt_incrementPC"><span class="id" title="lemma">wp2_opt_incrementPC</span></a> {<a id="c420cbda58931866e1fa444f22a529a4" class="idref" href="#c420cbda58931866e1fa444f22a529a4"><span class="id" title="binder">φ</span></a> <a id="74c0a195c0bcc13a312a4dd6ecd8a98d" class="idref" href="#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="binder">φ</span></a><a id="74c0a195c0bcc13a312a4dd6ecd8a98d" class="idref" href="#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="binder">t</span></a> <a id="lr:407" class="idref" href="#lr:407"><span class="id" title="binder">lr</span></a> <a id="lrt:408" class="idref" href="#lrt:408"><span class="id" title="binder">lrt</span></a> <a id="lm:409" class="idref" href="#lm:409"><span class="id" title="binder">lm</span></a> <a id="lmt:410" class="idref" href="#lmt:410"><span class="id" title="binder">lmt</span></a> <a id="73f9e8f30927ccb67e247b117c605c4f" class="idref" href="#73f9e8f30927ccb67e247b117c605c4f"><span class="id" title="binder">Φs</span></a> <a id="5c85c38ffd5c2ce161f2307ea112f573" class="idref" href="#5c85c38ffd5c2ce161f2307ea112f573"><span class="id" title="binder">Φf</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">∈</span> <span class="id" title="definition">dom</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:408"><span class="id" title="variable">lrt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c420cbda58931866e1fa444f22a529a4"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:407"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:408"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:409"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:410"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c420cbda58931866e1fa444f22a529a4"><span class="id" title="variable">φ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:407"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:408"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:409"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:410"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#5c85c38ffd5c2ce161f2307ea112f573"><span class="id" title="variable">Φf</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∧</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="lrt':413" class="idref" href="#lrt':413"><span class="id" title="binder">lrt'</span></a> <a id="rs':414" class="idref" href="#rs':414"><span class="id" title="binder">rs'</span></a><span class="id" title="notation">,</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#c420cbda58931866e1fa444f22a529a4"><span class="id" title="variable">φ</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#update_regs"><span class="id" title="definition">update_regs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#rs':414"><span class="id" title="variable">rs'</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:407"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt':413"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:409"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:410"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">-∗</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#73f9e8f30927ccb67e247b117c605c4f"><span class="id" title="variable">Φs</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt':413"><span class="id" title="variable">lrt'</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#rs':414"><span class="id" title="variable">rs'</span></a><span class="id" title="notation">)</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementLPC"><span class="id" title="definition">incrementLPC</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:408"><span class="id" title="variable">lrt</span></a>) (<a class="idref" href="cap_machine.program_logic.base_logic.html#incrementPC"><span class="id" title="definition">incrementPC</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">φ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#74c0a195c0bcc13a312a4dd6ecd8a98d"><span class="id" title="variable">t</span></a>)) <a class="idref" href="cap_machine.program_logic.rules_base.html#5c85c38ffd5c2ce161f2307ea112f573"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#73f9e8f30927ccb67e247b117c605c4f"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hdom</span>) "(Hφr &amp; Hk)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_bind"><span class="id" title="axiom">wp_opt2_bind</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2_eqn"><span class="id" title="axiom">wp_opt2_eqn</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#wp2_reg_lookup"><span class="id" title="axiom">wp2_reg_lookup</span></a> <span class="id" title="notation">with</span> "[$Hφr Hk]"<span class="id" title="notation">)</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">lwr</span>) "Hφr %Heq1 %Heq2".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">lwr</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">sb</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">f1</span> <a class="idref" href="cap_machine.opsem.addr_reg.html#83f9bcf2054d3d441d475f25e3e951c6"><span class="id" title="notation">+</span></a> 1)%<span class="id" title="var">a</span>; <span class="id" title="var">cbn</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>; <span class="id" title="var">now</span> <span class="id" title="var">iApply</span> "Hk").<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span>"Hk" <span class="id" title="notation">$!</span> <span class="id" title="var">_</span> <span class="id" title="notation">(</span><span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.opsem.addr_reg.html#PC"><span class="id" title="constructor">PC</span></a> <span class="id" title="notation">:=</span> <span class="id" title="var">_</span> <span class="id" title="notation">]&gt;</span> <span class="id" title="notation">(</span><span class="id" title="notation">reg</span> <span class="id" title="notation">φ</span><span class="id" title="notation">t</span><span class="id" title="notation">)</span><span class="id" title="notation">))</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iApply</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#update_state_interp_transient_from_regs_mod"><span class="id" title="axiom">update_state_interp_transient_from_regs_mod</span></a> <span class="id" title="var">Hdom</span> (<span class="id" title="var">lw2</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f2</span> <span class="id" title="var">v</span>) <span class="id" title="notation">with</span> "Hφr"<span class="id" title="notation">)</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">cur_map</span> <span class="id" title="var">Hcurregs</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_cur_lword_lea"><span class="id" title="axiom">is_cur_lword_lea</span></a> <span class="id" title="keyword">with</span> (<span class="id" title="var">lw</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LCap"><span class="id" title="abbreviation">LCap</span></a> <span class="id" title="var">p</span> <span class="id" title="var">f</span> <span class="id" title="var">f0</span> <span class="id" title="var">f1</span> <span class="id" title="var">v</span>); <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.opsem.machine_base.html#isWithin_refl"><span class="id" title="axiom">isWithin_refl</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">eapply</span> (<span class="id" title="lemma">map_Forall_lookup_1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcurregs</span>).<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="wp2_get_wcap_scap" class="idref" href="#wp2_get_wcap_scap"><span class="id" title="lemma">wp2_get_wcap_scap</span></a> {<a id="ee931784ec7ecd85197c3a2c736be975" class="idref" href="#ee931784ec7ecd85197c3a2c736be975"><span class="id" title="binder">Φf</span></a> : <span class="id" title="abbreviation">iProp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#c83beb9a67378c40938d18b1e249d990"><span class="id" title="variable">Σ</span></a>} {<a id="w:416" class="idref" href="#w:416"><span class="id" title="binder">w</span></a> <a id="dadda8e000850d9e7694177368043ed0" class="idref" href="#dadda8e000850d9e7694177368043ed0"><span class="id" title="binder">Φs</span></a>} :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#ee931784ec7ecd85197c3a2c736be975"><span class="id" title="variable">Φf</span></a> <span class="id" title="notation">∧</span> <span class="id" title="notation">(</span><span class="id" title="notation">∀</span> <a id="p:418" class="idref" href="#p:418"><span class="id" title="binder">p</span></a> <a id="b:419" class="idref" href="#b:419"><span class="id" title="binder">b</span></a> <a id="e:420" class="idref" href="#e:420"><span class="id" title="binder">e</span></a> <a id="a:421" class="idref" href="#a:421"><span class="id" title="binder">a</span></a> <a id="v:422" class="idref" href="#v:422"><span class="id" title="binder">v</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#dadda8e000850d9e7694177368043ed0"><span class="id" title="variable">Φs</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#p:418"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:419"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:420"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:421"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:422"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#p:418"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:419"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:420"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:421"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <a class="idref" href="cap_machine.program_logic.wp_opt.html#wp_opt2"><span class="id" title="definition">wp_opt2</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#get_wlcap_slcap"><span class="id" title="definition">get_wlcap_slcap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#w:416"><span class="id" title="variable">w</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#get_wcap_scap"><span class="id" title="definition">get_wcap_scap</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#w:416"><span class="id" title="variable">w</span></a>)) <a class="idref" href="cap_machine.program_logic.rules_base.html#ee931784ec7ecd85197c3a2c736be975"><span class="id" title="variable">Φf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dadda8e000850d9e7694177368043ed0"><span class="id" title="variable">Φs</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> "HΦ".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">w</span> <span class="id" title="keyword">as</span> [ | [ | ] | [] [ | ] ]; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_l</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">all</span>: <span class="id" title="tactic">try</span> <span class="id" title="var">now</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">bi.and_elim_r</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="state_interp_transient_unique_in_lregs" class="idref" href="#state_interp_transient_unique_in_lregs"><span class="id" title="lemma">state_interp_transient_unique_in_lregs</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="3b00f42b2dc8f0989971027a6b62f2ea" class="idref" href="#3b00f42b2dc8f0989971027a6b62f2ea"><span class="id" title="binder">σ</span></a> <a id="3db989934d85fdcfc5d54ba584f55fe6" class="idref" href="#3db989934d85fdcfc5d54ba584f55fe6"><span class="id" title="binder">σ</span></a><a id="3db989934d85fdcfc5d54ba584f55fe6" class="idref" href="#3db989934d85fdcfc5d54ba584f55fe6"><span class="id" title="binder">t</span></a> <a id="lreg:425" class="idref" href="#lreg:425"><span class="id" title="binder">lreg</span></a> <a id="lrt:426" class="idref" href="#lrt:426"><span class="id" title="binder">lrt</span></a> <a id="lmemf:427" class="idref" href="#lmemf:427"><span class="id" title="binder">lmemf</span></a> <a id="lmt:428" class="idref" href="#lmt:428"><span class="id" title="binder">lmt</span></a> <a id="src:429" class="idref" href="#src:429"><span class="id" title="binder">src</span></a> <a id="lwsrc:430" class="idref" href="#lwsrc:430"><span class="id" title="binder">lwsrc</span></a>}:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#sweep_reg"><span class="id" title="definition">sweep_reg</span></a> (<a class="idref" href="cap_machine.opsem.cap_lang.html#mem"><span class="id" title="projection">mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3b00f42b2dc8f0989971027a6b62f2ea"><span class="id" title="variable">σ</span></a>) (<a class="idref" href="cap_machine.opsem.cap_lang.html#reg"><span class="id" title="projection">reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3b00f42b2dc8f0989971027a6b62f2ea"><span class="id" title="variable">σ</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#src:429"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lreg:425"><span class="id" title="variable">lreg</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:429"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwsrc:430"><span class="id" title="variable">lwsrc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#state_interp_transient"><span class="id" title="definition">state_interp_transient</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3b00f42b2dc8f0989971027a6b62f2ea"><span class="id" title="variable">σ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#3db989934d85fdcfc5d54ba584f55fe6"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#3db989934d85fdcfc5d54ba584f55fe6"><span class="id" title="variable">t</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg:425"><span class="id" title="variable">lreg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lrt:426"><span class="id" title="variable">lrt</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmemf:427"><span class="id" title="variable">lmemf</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:428"><span class="id" title="variable">lmt</span></a> <span class="id" title="notation">⊢</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#unique_in_registersL"><span class="id" title="definition">unique_in_registersL</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lreg:425"><span class="id" title="variable">lreg</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:429"><span class="id" title="variable">src</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#lwsrc:430"><span class="id" title="variable">lwsrc</span></a> <span class="id" title="notation">⌝</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">Hsweep</span> <span class="id" title="var">Hsrc</span>) "Hσrm".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.transiently.html#transiently_abort"><span class="id" title="lemma">transiently_abort</span></a> <span class="id" title="notation">with</span> "Hσrm"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "(Hσ &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> "Hσ" <span class="id" title="keyword">as</span> (<span class="id" title="var">lr</span> <span class="id" title="var">lm</span> <span class="id" title="var">vmap</span> <span class="id" title="var">cur_tb</span> <span class="id" title="var">prev_tb</span> <span class="id" title="var">all_tb</span>) "(Hr &amp; Hm &amp; %Hcurtbeq &amp; Hcurtb &amp; Hprevtb &amp; Halltb &amp; Hecauth &amp; %Hcurprevdisj &amp; %Hcompl &amp; %Hcurprevdisj2 &amp; %Hcompl2 &amp; %HLinv)"; <span class="id" title="tactic">simpl</span> <span class="id" title="tactic">in</span> <span class="id" title="var">HLinv</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#unique_in_registersL_mono"><span class="id" title="axiom">unique_in_registersL_mono</span></a>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsrc</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_unique_in_registers"><span class="id" title="axiom">state_corresponds_unique_in_registers</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> (<a class="idref" href="cap_machine.opsem.cap_lang.html#sweep_reg_spec"><span class="id" title="axiom">sweep_reg_spec</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hsweep</span>) ; <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;state_interp_derive&nbsp;(E&nbsp;:&nbsp;coPset)&nbsp;(s&nbsp;:&nbsp;stuckness)&nbsp;(R&nbsp;P&nbsp;:&nbsp;iProp&nbsp;Σ)&nbsp;(HPers&nbsp;:&nbsp;Persistent&nbsp;P)&nbsp;Φ&nbsp;e&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;to_val&nbsp;e&nbsp;=&nbsp;None&nbsp;-&gt;&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(∀&nbsp;σ,&nbsp;R&nbsp;∗&nbsp;state_interp_logical&nbsp;σ&nbsp;-∗&nbsp;P)&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(R&nbsp;∗&nbsp;P&nbsp;-∗&nbsp;(wp&nbsp;s&nbsp;E&nbsp;e&nbsp;Φ))&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(R&nbsp;-∗&nbsp;(wp&nbsp;s&nbsp;E&nbsp;e&nbsp;Φ)).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(He)&nbsp;"HRP&nbsp;Hwp&nbsp;HR".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;!wp_unfold&nbsp;/wp_pre&nbsp;/=.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;He.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(σ&nbsp;ns&nbsp;κ&nbsp;κs&nbsp;nt)&nbsp;"Hσ&nbsp;/=".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;("HRP"&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">HR</span></span> <span class="inlinecode">$<span class="id" title="var">H</span>σ</span>")&nbsp;as&nbsp;"HP". *)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;("Hwp"&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">HR</span></span> <span class="inlinecode">$<span class="id" title="var">HP</span></span>")&nbsp;as&nbsp;"Hwp".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iSpecialize&nbsp;("Hwp"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iMod&nbsp;("Hwp")&nbsp;as&nbsp;"<span class="inlinecode">%<span class="id" title="var">Hred</span></span> <span class="inlinecode"><span class="id" title="var">H</span></span>".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iModIntro.&nbsp;iSplitR;&nbsp;first&nbsp;by&nbsp;iPureIntro.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(?&nbsp;?&nbsp;?)&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iMod&nbsp;("H"&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;done.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;ec_bounds_etable&nbsp;σ&nbsp;`{ReservedAddresses}&nbsp;`{!ceriseG&nbsp;Σ}&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_logical&nbsp;σ&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;⌜forall&nbsp;i,&nbsp;i&nbsp;∈&nbsp;dom&nbsp;σ.(etable)&nbsp;→&nbsp;i&nbsp;&lt;&nbsp;σ.(enumcur)⌝.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"σ".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;"σ"&nbsp;as&nbsp;(lr&nbsp;lm&nbsp;vm&nbsp;cur_tb&nbsp;prev_tb&nbsp;all_tb)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hlr&nbsp;&amp;&nbsp;Hlm&nbsp;&amp;&nbsp;Hdomcurtb&nbsp;&amp;&nbsp;Htbdisj&nbsp;&amp;&nbsp;Hcorr0)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iPureIntro.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;intros&nbsp;i&nbsp;Hdom.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;-Hetable&nbsp;in&nbsp;Hdom.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;apply&nbsp;(elem_of_weaken&nbsp;i&nbsp;(dom&nbsp;cur_tb)&nbsp;(dom&nbsp;(cur_tb&nbsp;∪&nbsp;prev_tb)))&nbsp;in&nbsp;Hdom.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;list_to_set_seq&nbsp;in&nbsp;Hdomtbcompl.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;set_solver.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;set_solver.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;state_interp_derive_instr_exec&nbsp;(E&nbsp;:&nbsp;coPset)&nbsp;(s&nbsp;:&nbsp;stuckness)&nbsp;(R&nbsp;P&nbsp;:&nbsp;iProp&nbsp;Σ)&nbsp;(HPers&nbsp;:&nbsp;Persistent&nbsp;P)&nbsp;Φ&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(∀&nbsp;σ,&nbsp;R&nbsp;∗&nbsp;state_interp_logical&nbsp;σ&nbsp;-∗&nbsp;P)&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(R&nbsp;∗&nbsp;P&nbsp;-∗&nbsp;(wp&nbsp;s&nbsp;E&nbsp;(Instr&nbsp;Executable)&nbsp;Φ))&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(R&nbsp;-∗&nbsp;wp&nbsp;s&nbsp;E&nbsp;(Instr&nbsp;Executable)&nbsp;Φ).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"HRP&nbsp;Hwp&nbsp;HR".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;iApply&nbsp;(state_interp_derive&nbsp;with&nbsp;"<span class="inlinecode">$<span class="id" title="var">HRP</span></span>&nbsp;<span class="inlinecode">$<span class="id" title="var">Hwp</span></span>&nbsp;<span class="inlinecode">$<span class="id" title="var">HR</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;state_interp_max_tidx&nbsp;σ&nbsp;ecn&nbsp;tidx&nbsp;I&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;state_interp_logical&nbsp;σ&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;EC⤇&nbsp;ecn&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;enclave_all&nbsp;tidx&nbsp;I&nbsp;-∗&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;⌜&nbsp;tidx&nbsp;&lt;&nbsp;ecn&nbsp;⌝.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"Hinterp&nbsp;HEC&nbsp;Henclave".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;(ec_bounds_etable&nbsp;with&nbsp;"Hinterp")&nbsp;as&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;"Hinterp"&nbsp;as&nbsp;(lr&nbsp;lm&nbsp;vm&nbsp;cur_tb&nbsp;prev_tb&nbsp;all_tb)&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"(Hlr&nbsp;&amp;&nbsp;Hlm&nbsp;&amp;&nbsp;Hdomcurtb&nbsp;&amp;&nbsp;Htbdisj&nbsp;&amp;&nbsp;Hcorr0)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iCombine&nbsp;"Hecauth&nbsp;HEC"&nbsp;as&nbsp;"Henumcur".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;(own_valid&nbsp;with&nbsp;"Henumcur")&nbsp;as&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;apply&nbsp;excl_auth_agree_L&nbsp;in&nbsp;Hvalid_ec.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;-Hvalid_ec.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iAssert&nbsp;(⌜tidx&nbsp;∈&nbsp;dom&nbsp;all_tb⌝Hin".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iCombine&nbsp;"Hall_tb"&nbsp;"Henclave"&nbsp;as&nbsp;"Hall".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iDestruct&nbsp;(own_valid&nbsp;with&nbsp;"Hall")&nbsp;as&nbsp;"*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;apply&nbsp;auth_both_valid_discrete&nbsp;in&nbsp;Hvalid_all&nbsp;as&nbsp;<span class="inlinecode"><span class="id" title="var">Hlt_all</span></span> <span class="inlinecode"><span class="id" title="var">Hvalid_all</span></span>.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;apply&nbsp;gmap.dom_included&nbsp;in&nbsp;Hlt_all.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;by&nbsp;rewrite&nbsp;dom_singleton&nbsp;dom_fmap&nbsp;singleton_subseteq_l&nbsp;in&nbsp;Hlt_all.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;-Htbcompl&nbsp;in&nbsp;Hin.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iPureIntro.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;Hdomtbcompl&nbsp;in&nbsp;Hin.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;rewrite&nbsp;list_to_set_seq&nbsp;in&nbsp;Hin.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;set_solver&nbsp;+Hin.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Lemma&nbsp;valid_enclave_ec&nbsp;ecn&nbsp;tidx&nbsp;I&nbsp;s&nbsp;E&nbsp;Φ&nbsp;:&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(&nbsp;(&nbsp;EC⤇&nbsp;ecn&nbsp;∗&nbsp;enclave_all&nbsp;tidx&nbsp;I)&nbsp;∗&nbsp;⌜&nbsp;tidx&nbsp;&lt;&nbsp;ecn&nbsp;⌝&nbsp;-∗&nbsp;(wp&nbsp;s&nbsp;E&nbsp;(Instr&nbsp;Executable)&nbsp;Φ))&nbsp;⊢&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;(&nbsp;(&nbsp;EC⤇&nbsp;ecn&nbsp;∗&nbsp;enclave_all&nbsp;tidx&nbsp;I)&nbsp;-∗&nbsp;wp&nbsp;s&nbsp;E&nbsp;(Instr&nbsp;Executable)&nbsp;Φ).&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Proof.&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;"Hwp&nbsp;HR".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(state_interp_derive_instr_exec&nbsp;with&nbsp;"<span class="inlinecode"></span>&nbsp;<span class="inlinecode">$<span class="id" title="var">Hwp</span></span>&nbsp;<span class="inlinecode">$<span class="id" title="var">HR</span></span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iIntros&nbsp;(σ)&nbsp;"(&nbsp;(HEC&nbsp;&amp;&nbsp;Henclave)&nbsp;&amp;&nbsp;Hσ)".&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;&nbsp;&nbsp;iApply&nbsp;(state_interp_max_tidx&nbsp;with&nbsp;"<span class="inlinecode">$</span>&nbsp;<span class="inlinecode">$</span>&nbsp;<span class="inlinecode">$</span>").&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;Qed.&nbsp;*)</span><br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <a id="full_own_mem" class="idref" href="#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> (<a id="lmem:431" class="idref" href="#lmem:431"><span class="id" title="binder">lmem</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a> := <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="y:432" class="idref" href="#y:432"><span class="id" title="binder">y</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><span class="id" title="constructor">DfracOwn</span> 1<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:432"><span class="id" title="variable">y</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">&lt;$&gt;</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:431"><span class="id" title="variable">lmem</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;generalise&nbsp;and&nbsp;move&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="fmap_forall_inv" class="idref" href="#fmap_forall_inv"><span class="id" title="lemma">fmap_forall_inv</span></a> (<a id="lmt:433" class="idref" href="#lmt:433"><span class="id" title="binder">lmt</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMemF"><span class="id" title="definition">LMemF</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">map_Forall</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">(</span></a><span class="id" title="var">_</span> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LAddr"><span class="id" title="definition">LAddr</span></a>) (<a id="a:434" class="idref" href="#a:434"><span class="id" title="binder">a</span></a> : <span class="id" title="inductive">dfrac</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#11c698c8685bb8ab1cf725545c085ac4"><span class="id" title="notation">*</span></a> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LWord"><span class="id" title="inductive">LWord</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">),</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:434"><span class="id" title="variable">a</span></a><span class="id" title="notation">.1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">DfracOwn</span> 1) <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:433"><span class="id" title="variable">lmt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">exists</span></a> <a id="lm:435" class="idref" href="#lm:435"><span class="id" title="binder">lm</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#a883bdd010993579f99d60b3775bcf54"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmt:433"><span class="id" title="variable">lmt</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:435"><span class="id" title="variable">lm</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">lmt</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">exists</span> <span class="id" title="notation">∅</span>. <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <span class="id" title="lemma">fmap_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">assert</span> (<span class="id" title="var">x</span><span class="id" title="notation">.1</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <span class="id" title="constructor">DfracOwn</span> 1) <span class="id" title="keyword">as</span> <span class="id" title="var">Hx</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <span class="id" title="lemma">map_Forall_insert_1_1</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hall</span>; <span class="id" title="tactic">auto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="lemma">map_Forall_insert_1_2</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hall</span>; <span class="id" title="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">IHlmt</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hall</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">Hall</span> <span class="id" title="keyword">as</span> (<span class="id" title="var">lm'</span> &amp; <span class="id" title="var">Hall</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> (<span class="id" title="notation">&lt;[</span><span class="id" title="var">i</span> <span class="id" title="notation">:=</span> <span class="id" title="notation">(</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="var">x</span><span class="id" title="notation">)]&gt;</span> <span class="id" title="notation">lm'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <span class="id" title="lemma">fmap_insert</span> /=.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">x</span> ; <span class="id" title="var">cbn</span> <span class="id" title="tactic">in</span> * ; <span class="id" title="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="comment">(*&nbsp;TODO&nbsp;generalise&nbsp;to&nbsp;not&nbsp;just&nbsp;LMem&nbsp;+&nbsp;find&nbsp;better&nbsp;name&nbsp;+&nbsp;move&nbsp;iris_extra&nbsp;*)</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="map_full_own" class="idref" href="#map_full_own"><span class="id" title="lemma">map_full_own</span></a> (<a id="lm:436" class="idref" href="#lm:436"><span class="id" title="binder">lm</span></a> : <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#LMem"><span class="id" title="definition">LMem</span></a>) :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:437" class="idref" href="#k:437"><span class="id" title="binder"><span id="k:438" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:439" class="idref" href="#y:439"><span class="id" title="binder"><span id="y:440" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:436"><span class="id" title="variable">lm</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:437"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#e389c97555835874498bb08a394266c6"><span class="id" title="notation">↦ₐ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:439"><span class="id" title="variable">y</span></a>)%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊣⊢</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="la:441" class="idref" href="#la:441"><span class="id" title="binder"><span id="la:442" class="id">la</span></span></a><span class="id" title="notation">↦</span><a id="dw:443" class="idref" href="#dw:443"><span class="id" title="binder"><span id="dw:444" class="id">dw</span></span></a> <span class="id" title="notation">∈</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:436"><span class="id" title="variable">lm</span></a><span class="id" title="notation">),</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:441"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#dw:443"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#dw:443"><span class="id" title="variable">dw</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">induction</span> <span class="id" title="var">lm</span> <span class="id" title="keyword">using</span> <span class="id" title="lemma">map_ind</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <span class="id" title="lemma">fmap_empty</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;- <span class="id" title="tactic">rewrite</span> /<a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <span class="id" title="lemma">fmap_insert</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplit</span>; <span class="id" title="var">iIntros</span> "Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hi Hmem]"; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="var">IHlm</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[Hi Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hmem"; <span class="id" title="tactic">try</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="lemma">fmap_None</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hi Hmem]"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;; <span class="id" title="tactic">first</span> (<span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <span class="id" title="method">lookup_fmap</span> <span class="id" title="lemma">fmap_None</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="var">IHlm</span> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">cbn</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><span class="id" title="lemma">big_sepM_insert</span> <span class="id" title="notation">with</span> "[Hi Hmem]"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hmem"; <span class="id" title="tactic">try</span> <span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <a id="update_state_interp_next_version" class="idref" href="#update_state_interp_next_version"><span class="id" title="lemma">update_state_interp_next_version</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<a id="b11ce04aa0cc2915d707d8c19996ac2a" class="idref" href="#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="binder">σ</span></a><a id="b11ce04aa0cc2915d707d8c19996ac2a" class="idref" href="#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="binder">r</span></a> <a id="e611c62ebdc621124b135e2e394db88b" class="idref" href="#e611c62ebdc621124b135e2e394db88b"><span class="id" title="binder">σ</span></a><a id="e611c62ebdc621124b135e2e394db88b" class="idref" href="#e611c62ebdc621124b135e2e394db88b"><span class="id" title="binder">m</span></a> <a id="lr:447" class="idref" href="#lr:447"><span class="id" title="binder">lr</span></a> <a id="lm:448" class="idref" href="#lm:448"><span class="id" title="binder">lm</span></a> <a id="vmap:449" class="idref" href="#vmap:449"><span class="id" title="binder">vmap</span></a> <a id="lregs:450" class="idref" href="#lregs:450"><span class="id" title="binder">lregs</span></a> <a id="lmem:451" class="idref" href="#lmem:451"><span class="id" title="binder">lmem</span></a> <a id="src:452" class="idref" href="#src:452"><span class="id" title="binder">src</span></a> <a id="lwsrc:453" class="idref" href="#lwsrc:453"><span class="id" title="binder">lwsrc</span></a> <a id="p:454" class="idref" href="#p:454"><span class="id" title="binder">p</span></a> <a id="b:455" class="idref" href="#b:455"><span class="id" title="binder">b</span></a> <a id="e:456" class="idref" href="#e:456"><span class="id" title="binder">e</span></a> <a id="a:457" class="idref" href="#a:457"><span class="id" title="binder">a</span></a> <a id="v:458" class="idref" href="#v:458"><span class="id" title="binder">v</span></a>} :<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="la:459" class="idref" href="#la:459"><span class="id" title="binder">la</span></a> := <a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:455"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:456"><span class="id" title="variable">e</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#la:459"><span class="id" title="variable">la</span></a> <span class="id" title="notation">##</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#reserved_addresses"><span class="id" title="method">reserved_addresses</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.opsem.cap_lang.html#sweep_reg"><span class="id" title="definition">sweep_reg</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e611c62ebdc621124b135e2e394db88b"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#e611c62ebdc621124b135e2e394db88b"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:452"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:450"><span class="id" title="variable">lregs</span></a> <span class="id" title="notation">!!</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#src:452"><span class="id" title="variable">src</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwsrc:453"><span class="id" title="variable">lwsrc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#get_wlcap_slcap"><span class="id" title="definition">get_wlcap_slcap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwsrc:453"><span class="id" title="variable">lwsrc</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">(</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#p:454"><span class="id" title="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:455"><span class="id" title="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:456"><span class="id" title="variable">e</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a:457"><span class="id" title="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:458"><span class="id" title="variable">v</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#e6756e10c36f149b18b4a8741ed83079"><span class="id" title="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#::type_scope:x_'-&gt;'_x"><span class="id" title="notation">-&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:447"><span class="id" title="variable">lr</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:448"><span class="id" title="variable">lm</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e611c62ebdc621124b135e2e394db88b"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#e611c62ebdc621124b135e2e394db88b"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr:447"><span class="id" title="variable">lr</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:448"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#vmap:449"><span class="id" title="variable">vmap</span></a><span class="id" title="notation">⌝</span>%<span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:460" class="idref" href="#k:460"><span class="id" title="binder"><span id="k:461" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:462" class="idref" href="#y:462"><span class="id" title="binder"><span id="y:463" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs:450"><span class="id" title="variable">lregs</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:460"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:462"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:464" class="idref" href="#k:464"><span class="id" title="binder"><span id="k:465" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:466" class="idref" href="#y:466"><span class="id" title="binder"><span id="y:467" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:451"><span class="id" title="variable">lmem</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:464"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#y:466"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:466"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⊢</span> <span class="id" title="notation">|==&gt;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lmem':468" class="idref" href="#lmem':468"><span class="id" title="binder">lmem'</span></a> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:448"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:459"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:458"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:451"><span class="id" title="variable">lmem</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lm':469" class="idref" href="#lm':469"><span class="id" title="binder">lm'</span></a> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:448"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:459"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:458"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:448"><span class="id" title="variable">lm</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lregs':470" class="idref" href="#lregs':470"><span class="id" title="binder">lregs'</span></a> := (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.rules_base.html#src:452"><span class="id" title="variable">src</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#next_version_lword"><span class="id" title="definition">next_version_lword</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwsrc:453"><span class="id" title="variable">lwsrc</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="lr':471" class="idref" href="#lr':471"><span class="id" title="binder">lr'</span></a> := (<span class="id" title="notation">&lt;[</span><a class="idref" href="cap_machine.program_logic.rules_base.html#src:452"><span class="id" title="variable">src</span></a><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#next_version_lword"><span class="id" title="definition">next_version_lword</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lwsrc:453"><span class="id" title="variable">lwsrc</span></a><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <a id="vmap':472" class="idref" href="#vmap':472"><span class="id" title="binder">vmap'</span></a> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_vmap"><span class="id" title="definition">update_version_region_vmap</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#la:459"><span class="id" title="variable">la</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#v:458"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#vmap:449"><span class="id" title="variable">vmap</span></a> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_valid_updated_lmemory"><span class="id" title="definition">is_valid_updated_lmemory</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm:448"><span class="id" title="variable">lm</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem:451"><span class="id" title="variable">lmem</span></a> (<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b:455"><span class="id" title="variable">b</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e:456"><span class="id" title="variable">e</span></a>) <a class="idref" href="cap_machine.program_logic.rules_base.html#v:458"><span class="id" title="variable">v</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem':468"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">⌝</span> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr':471"><span class="id" title="variable">lr'</span></a> <span class="id" title="notation">∗</span> <span class="id" title="definition">gen_heap_interp</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm':469"><span class="id" title="variable">lm'</span></a> <span class="id" title="notation">∗</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">⌜</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_phys_log_corresponds"><span class="id" title="definition">state_phys_log_corresponds</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#b11ce04aa0cc2915d707d8c19996ac2a"><span class="id" title="variable">r</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#e611c62ebdc621124b135e2e394db88b"><span class="id" title="variable">σ</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#e611c62ebdc621124b135e2e394db88b"><span class="id" title="variable">m</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lr':471"><span class="id" title="variable">lr'</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lm':469"><span class="id" title="variable">lm'</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#vmap':472"><span class="id" title="variable">vmap'</span></a> <span class="id" title="notation">⌝</span>%<span class="id" title="var">I</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:473" class="idref" href="#k:473"><span class="id" title="binder"><span id="k:474" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:475" class="idref" href="#y:475"><span class="id" title="binder"><span id="y:476" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#lregs':470"><span class="id" title="variable">lregs'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:473"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#db884c99aed36a9ddaddcd7edc424755"><span class="id" title="notation">↦ᵣ</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:475"><span class="id" title="variable">y</span></a><span class="id" title="notation">)</span> <span class="id" title="notation">∗</span> <span class="id" title="notation">(</span><span class="id" title="notation">[∗</span> <span class="id" title="notation">map</span><span class="id" title="notation">]</span> <a id="k:477" class="idref" href="#k:477"><span class="id" title="binder"><span id="k:478" class="id">k</span></span></a><span class="id" title="notation">↦</span><a id="y:479" class="idref" href="#y:479"><span class="id" title="binder"><span id="y:480" class="id">y</span></span></a> <span class="id" title="notation">∈</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#full_own_mem"><span class="id" title="definition">full_own_mem</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#lmem':468"><span class="id" title="variable">lmem'</span></a><span class="id" title="notation">,</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#k:477"><span class="id" title="variable">k</span></a> <a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">↦ₐ{</span></a><a class="idref" href="cap_machine.program_logic.rules_base.html#y:479"><span class="id" title="variable">y</span></a><span class="id" title="notation">.1</span><a class="idref" href="cap_machine.program_logic.base_logic.html#1f356528680e66e063184d2852c70086"><span class="id" title="notation">}</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#y:479"><span class="id" title="variable">y</span></a><span class="id" title="notation">.2</span><span class="id" title="notation">)</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Proof</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iIntros</span> (<span class="id" title="var">la</span> <span class="id" title="var">Hnotres'</span> <span class="id" title="var">Hsweep</span> <span class="id" title="var">Hlsrc</span> <span class="id" title="var">Hlcap_wsrc</span>) "(Hr &amp; Hm &amp; %Hcorr &amp; Hregs &amp; Hmem)".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Lists.List.html#Forall"><span class="id" title="inductive">Forall</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">λ</span></a> <a id="a0:481" class="idref" href="#a0:481"><span class="id" title="binder"><span id="a0:482" class="id">a0</span></span></a> : <a class="idref" href="cap_machine.opsem.addr_reg.html#Addr"><span class="id" title="abbreviation">Addr</span></a><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Unicode.Utf8_core.html#bc1ad27deabe143d39d35abe6be2c1a4"><span class="id" title="notation">,</span></a> <a class="idref" href="cap_machine.program_logic.rules_base.html#a0:481"><span class="id" title="variable">a0</span></a> <span class="id" title="notation">∉</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#reserved_addresses"><span class="id" title="method">reserved_addresses</span></a>) <span class="id" title="var">la</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Notres</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">Forall_forall</span> ; <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">Hx</span> <span class="id" title="var">Hx'</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <span class="id" title="var">Hnotres'</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;}<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlregs_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.rules_base.html#map_full_own"><span class="id" title="axiom">map_full_own</span></a> <span class="id" title="notation">with</span> "Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "Hmem".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iDestruct</span> <span class="id" title="notation">(</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_valid_inclSepM"><span class="id" title="axiom">gen_heap_valid_inclSepM</span></a> <span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "%Hlmem_incl".<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_update_inSepM"><span class="id" title="axiom">gen_heap_update_inSepM</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">src</span> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#next_version_lword"><span class="id" title="definition">next_version_lword</span></a> <span class="id" title="var">lwsrc</span>)<span class="id" title="notation">)</span> <span class="id" title="notation">with</span> "Hr Hregs"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"[Hr Hregs]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lr</span> <span class="id" title="notation">!!</span> <span class="id" title="var">src</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">lwsrc</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsrc</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span> <span class="id" title="tactic">in</span> <span class="id" title="var">Hlsrc</span> ; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">HNoDup</span> : <span class="id" title="inductive">NoDup</span> (<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <span class="id" title="var">b</span> <span class="id" title="var">e</span>)) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">apply</span> <a class="idref" href="machine_utils.finz_interval.html#finz_seq_between_NoDup"><span class="id" title="lemma">finz_seq_between_NoDup</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">opose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_cap_all_current"><span class="id" title="axiom">state_corresponds_cap_all_current</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorr</span> <span class="id" title="var">_</span> <span class="id" title="var">Hsrc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">HcurMap</span> ; <span class="id" title="tactic">first</span> (<span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">opose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_last_version_lword_region"><span class="id" title="axiom">state_corresponds_last_version_lword_region</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>  <span class="id" title="var">Hcorr</span> <span class="id" title="var">_</span> <span class="id" title="var">Hsrc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">HmemMap_maxv</span>; <span class="id" title="tactic">first</span> (<span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">opose</span> <span class="id" title="var">proof</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_access_lword_region"><span class="id" title="axiom">state_corresponds_access_lword_region</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">Hcorr</span> <span class="id" title="var">_</span> <span class="id" title="var">Hsrc</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">as</span> <span class="id" title="var">HmemMap</span>; <span class="id" title="tactic">first</span> (<span class="id" title="tactic">by</span> <span class="id" title="var">cbn</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lmem'</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">lmem</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lm'</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region"><span class="id" title="definition">update_version_region</span></a> <span class="id" title="var">lm</span> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">lm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lregs'</span> := <span class="id" title="notation">&lt;[</span><span class="id" title="var">src</span><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#next_version_lword"><span class="id" title="definition">next_version_lword</span></a> <span class="id" title="var">lwsrc</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lregs</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lr'</span> := <span class="id" title="notation">&lt;[</span><span class="id" title="var">src</span><span class="id" title="notation">:=</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#next_version_lword"><span class="id" title="definition">next_version_lword</span></a> <span class="id" title="var">lwsrc</span><span class="id" title="notation">]&gt;</span> <span class="id" title="notation">lr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">vmap'</span> := <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_vmap"><span class="id" title="definition">update_version_region_vmap</span></a> <span class="id" title="var">la</span> <span class="id" title="var">v</span> <span class="id" title="var">vmap</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iMod</span> <span class="id" title="notation">((</span><a class="idref" href="cap_machine.program_logic.base_logic.html#gen_heap_lmem_version_update"><span class="id" title="axiom">gen_heap_lmem_version_update</span></a> <span class="id" title="var">lm</span> <span class="id" title="var">lmem</span> <span class="id" title="var">lm</span> <span class="id" title="var">lmem'</span> <span class="id" title="var">_</span> <span class="id" title="var">vmap</span> <span class="id" title="var">_</span> (<a class="idref" href="machine_utils.finz_interval.html#finz.seq_between"><span class="id" title="definition">finz.seq_between</span></a> <span class="id" title="var">b</span> <span class="id" title="var">e</span>) <span class="id" title="var">v</span><span class="id" title="notation">)</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="notation">with</span> "Hm Hmem"<span class="id" title="notation">)</span> <span class="id" title="keyword">as</span> "[Hm Hmem]"; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iModIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;{ <span class="id" title="var">iPureIntro</span>. <span class="id" title="var">now</span> <span class="id" title="tactic">apply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#is_valid_updated_lmemory_update_version_region"><span class="id" title="axiom">is_valid_updated_lmemory_update_version_region</span></a>. }<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iFrame</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iSplitR</span> "Hmem"; <span class="id" title="var">last</span> <span class="id" title="tactic">by</span> <span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#map_full_own"><span class="id" title="axiom">map_full_own</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">iPureIntro</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">lr</span> <span class="id" title="notation">!!</span> <span class="id" title="var">src</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">lwsrc</span>) <span class="id" title="keyword">as</span> <span class="id" title="var">Hsrc'</span> <span class="id" title="tactic">by</span> (<span class="id" title="tactic">eapply</span> <span class="id" title="lemma">lookup_weaken</span>; <span class="id" title="tactic">eauto</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#sweep_true_specL"><span class="id" title="axiom">sweep_true_specL</span></a> <span class="id" title="tactic">in</span> <span class="id" title="var">Hsweep</span>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">rewrite</span> (<span class="id" title="var">_</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.ssr.ssreflect.html#::core_scope:x_':'_x"><span class="id" title="notation">:</span></a> σ<span class="id" title="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">(</span></a><span class="id" title="notation">&lt;[</span><span class="id" title="var">src</span><span class="id" title="notation">:=(</span><a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word"><span class="id" title="definition">lword_get_word</span></a> (<a class="idref" href="cap_machine.program_logic.logical_mapsto.html#next_version_lword"><span class="id" title="definition">next_version_lword</span></a> <span class="id" title="var">lwsrc</span>)<span class="id" title="notation">)]&gt;</span> <span class="id" title="notation">σ</span><span class="id" title="notation">r</span><a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Logic.html#6cd0f7b28b6092304087c7049437bb1a"><span class="id" title="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_lreg_corresponds_src"><span class="id" title="axiom">update_version_region_lreg_corresponds_src</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_word_region_update_lword"><span class="id" title="axiom">update_version_word_region_update_lword</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lreg_corresponds_read_iscur"><span class="id" title="axiom">lreg_corresponds_read_iscur</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">by</span> <span class="id" title="tactic">destruct</span> <span class="id" title="var">Hcorr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;* <span class="id" title="tactic">rewrite</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lword_get_word_next_version"><span class="id" title="axiom">lword_get_word_next_version</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> <span class="id" title="lemma">insert_id</span>; <span class="id" title="tactic">first</span> <span class="id" title="var">done</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#state_corresponds_reg_get_word"><span class="id" title="axiom">state_corresponds_reg_get_word</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;+ <span class="id" title="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/V8.18.0/stdlib//Coq.Init.Datatypes.html#id"><span class="id" title="definition">id</span></a> <span class="id" title="var">Hcorr</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#update_version_region_preserves_mem_corresponds"><span class="id" title="axiom">update_version_region_preserves_mem_corresponds</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (<span class="id" title="var">Hsweep</span> <span class="id" title="var">Hsrc'</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#unique_in_machine_no_accessL"><span class="id" title="axiom">unique_in_machine_no_accessL</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">eapply</span> <a class="idref" href="cap_machine.program_logic.logical_mapsto.html#lreg_corresponds_read_iscur"><span class="id" title="axiom">lreg_corresponds_read_iscur</span></a>; <span class="id" title="tactic">eauto</span>.<br/>
&nbsp;&nbsp;<span class="id" title="var">Unshelve</span>. <span class="id" title="var">Fail</span> <span class="id" title="tactic">idtac</span>. <span class="id" title="var">Admitted</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="cap_machine.program_logic.rules_base.html#cap_lang_rules"><span class="id" title="section">cap_lang_rules</span></a>.<br/>
</div>
</div>
<div id="footer">
  Generated by <a href="http://coq.inria.fr/">coqdoc</a> and improved with <a href="https://github.com/tebbi/coqdocjs">CoqdocJS</a>
</div>
</div>
</body>

</html>
